(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{3805:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/url",function(){return __webpack_require__(2744)}])},2744:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return Home}});var jsx_runtime=__webpack_require__(5893),react=__webpack_require__(7294),dist=__webpack_require__(9734),url_module=__webpack_require__(8855),url_module_default=__webpack_require__.n(url_module);let NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY="AKfycbwxIM4qrgIzqEMvvDYmk5NFdIcOR-E2kpXRANPXyx9cSp0codFTysCwe2ZUej7Yla-zMQ",swrGetData=async key=>{let sourceList={sheetNo:1,method:"GET",type:"getPrivateData",menberId:key[1]},postparam={method:"POST",body:JSON.stringify(sourceList)},returnStr=[];return await fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(res=>Promise.any([res.json()]).then(data=>{returnStr=data})),returnStr},getItemIdRequest=async()=>{let result;let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"getItemId"})};return await fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(res=>Promise.any([res.json()]).then(data=>{result=data[0]})),result};function Home(){let NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY="AKfycbwxIM4qrgIzqEMvvDYmk5NFdIcOR-E2kpXRANPXyx9cSp0codFTysCwe2ZUej7Yla-zMQ",[userAllProduct,setUserAllProduct]=(0,react.useState)([]),[AllProduct,setAllProduct]=(0,react.useState)([]),[lodging,setLoding]=(0,react.useState)(!0),[getInput,setInput]=(0,react.useState)(""),[flag,setFlag]=(0,react.useState)(!0),[getItemId,setItemId]=(0,react.useState)();(0,react.useEffect)(()=>{},[]);let Delete=(menberId,itemId)=>{setFlag(!1);let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"deleteData",menberId:menberId,itemId:itemId})};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>response.json()).then(data=>{setLoding(!0)}).catch(err=>{})},Update=(menberId,itemId)=>{setFlag(!1);let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"UpDate",menberId:menberId,itemId:itemId,url:"https://sakura-checker.jp/search/B0BP3SHG5Z/"})};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>response.json()).then(data=>{setLoding(!0)}).catch(err=>{})},addData=async url=>{if(setFlag(!1),setItemId(await getItemIdRequest()),getItemId){let sourceList={sheetNo:1,method:"POST",data:[{menberId:"1",itemId:"".concat(getItemId.itemId),parts:"",URL:"".concat(url),productName:"=if(D".concat(getItemId.rowNumber,'="","",SUBSTITUTE(SUBSTITUTE(IMPORTXML(D').concat(getItemId.rowNumber,',"//title"),"【サクラチェッカー】",""),"のやらせ評価/口コミをチェック","")) '),price:"=if(D".concat(getItemId.rowNumber,'="","",IMPORTXML(D').concat(getItemId.rowNumber,",\"//*[@id='itemprice']\")) ")}]},postparam={method:"POST",body:JSON.stringify(sourceList)};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>response.json()).then(data=>{setLoding(!0)}).catch(err=>{})}},click=()=>{if(getInput&&-1!==getInput.indexOf("https://www.amazon.co.jp/")){let itemUrl=getInput.split("/");addData("https://sakura-checker.jp/search/".concat(itemUrl[5]));return}if(getInput&&-1!==getInput.indexOf("https://sakura-checker.jp/")){addData(getInput);return}},[sumPrice,setSumPrice]=(0,react.useState)([]),sum=0;(0,react.useEffect)(()=>{sumPrice.forEach((item,index)=>{sum+=Number(item.price)})},[sumPrice]);let{data:getData,error:GetDataerror,mutate:GetDataMutate}=(0,dist.ZP)(["GetData",1],swrGetData);return(0,react.useEffect)(()=>{getData&&setUserAllProduct(getData),(!flag||lodging)&&(GetDataMutate(),setLoding(!1),setFlag(!0),setInput(""))},[getData,lodging]),(0,react.useEffect)(()=>{let menberId=localStorage.getItem("meberId");menberId||localStorage.setItem("meberId","1")},[]),(0,jsx_runtime.jsxs)("div",{className:url_module_default().main,children:[(0,jsx_runtime.jsx)("h1",{children:"桜チェッカーのURLから値段と商品名を抜き出す"}),(0,jsx_runtime.jsx)("div",{className:url_module_default().inputBox,children:(0,jsx_runtime.jsxs)("div",{className:url_module_default().inputs,children:[(0,jsx_runtime.jsx)("input",{type:"text",onChange:e=>setInput(e.target.value),value:getInput,className:url_module_default().inputs}),(0,jsx_runtime.jsx)("button",{onClick:()=>click(),disabled:!flag,children:"送信"})]})}),(0,jsx_runtime.jsx)("button",{onClick:()=>Update("2","5"),children:"Update demo"}),(0,jsx_runtime.jsxs)("section",{className:url_module_default().container,children:[(0,jsx_runtime.jsxs)("div",{className:url_module_default().box,children:[(0,jsx_runtime.jsx)("h2",{children:"商品一覧"}),userAllProduct.sort((x,y)=>Number(x.itemId)-Number(y.itemId)).map((item,index)=>(0,jsx_runtime.jsxs)("div",{className:url_module_default().itemBox,children:[(0,jsx_runtime.jsxs)("div",{className:url_module_default().itemName,children:["商品名：",item.productName]}),(0,jsx_runtime.jsxs)("div",{children:["値段：",item.price]}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("a",{href:item.URL,target:"_blank",rel:"noopener noreferrer",children:"リンク"})}),(0,jsx_runtime.jsx)("button",{onClick:()=>Delete(item.menberId,item.itemId),disabled:!flag,children:"削除"})]},"".concat(index)))]}),(0,jsx_runtime.jsxs)("div",{className:url_module_default().box,children:[(0,jsx_runtime.jsx)("h2",{children:"合計"}),sumPrice.map((item,index)=>(0,jsx_runtime.jsxs)("div",{className:url_module_default().itemBox,children:[(0,jsx_runtime.jsxs)("div",{className:url_module_default().item,children:["商品名：",item.productName]}),(0,jsx_runtime.jsxs)("div",{children:["値段：",item.price]})]})),(0,jsx_runtime.jsxs)("div",{children:["合計金額：",sum]})]})]})]})}},8855:function(module){module.exports={main:"url_main___tK9F",inputBox:"url_inputBox__SDjrp",inputs:"url_inputs__reh3u",input:"url_input__2CU6Q",button:"url_button__NGhAU",container:"url_container__wiuvT",box:"url_box__Ug8IJ",itemBox:"url_itemBox__px_nq",itemName:"url_itemName__kyFjM"}}},function(__webpack_require__){__webpack_require__.O(0,[734,774,888,179],function(){return __webpack_require__(__webpack_require__.s=3805)}),_N_E=__webpack_require__.O()}]);