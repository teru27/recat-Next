(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{3805:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/url",function(){return __webpack_require__(183)}])},183:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return Home}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7294),_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8855),_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2__);function Home(){let NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY="AKfycbzQ9d96olh9DNVR3PqdUzVBdpHY_tHPxdrI1n_epzskMUCgIntYFR_0MJl96hP6bvFAPQ",[userAllProduct,setUserAllProduct]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[AllProduct,setAllProduct]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[loding,setLoding]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0),[setInput,getInput]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(),[flag,setFlag]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0),CsvDic=props=>{let[header,...rows]=props;return rows.map(row=>row.reduce((acc,cell,i)=>({...acc,[header[i]]:cell}),{}))};(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{loding&&(fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat("1pPaTwWntCrt4dzijy6dcuxA6jzLT2jqwYyEXXu6d56g","/values/sheet1?key=").concat("AIzaSyAY5ELh7nvibnjKlN9EuEjA_cEpDp3pZcU")).then(res=>res.json()).then(datas=>{setAllProduct(CsvDic(datas.values))}),getData()),setLoding(!1),setFlag(!0)},[loding]);let getData=()=>{let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"getPrivateData",menberId:1})};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>(console.log(response),response.json())).then(data=>{console.log(data),setUserAllProduct(data)}).catch(err=>{console.log(err)})},Delete=(menberId,itemId)=>{setFlag(!1);let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"deleteData",menberId:menberId,itemId:itemId})};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>(console.log(response),response.json())).then(data=>{setLoding(!0)}).catch(err=>{console.log(err)})},Update=(menberId,itemId)=>{let postparam={method:"POST",body:JSON.stringify({sheetNo:1,method:"GET",type:"UpDate",menberId:menberId,itemId:itemId,url:"https://sakura-checker.jp/search/B0BP3SHG5Z/"})};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>(console.log(response),response.json())).then(data=>{setLoding(!0),setFlag(!0)}).catch(err=>{console.log(err)})},addData=url=>{let sellNumber=AllProduct.length+2,sourceList={sheetNo:1,method:"POST",data:[{menberId:"1",itemId:"".concat(sellNumber),parts:"",URL:"".concat(url),productName:"=if(D".concat(sellNumber,'="","",SUBSTITUTE(SUBSTITUTE(IMPORTXML(D').concat(sellNumber,',"//title"),"【サクラチェッカー】",""),"のやらせ評価/口コミをチェック","")) '),price:"=if(D".concat(sellNumber,'="","",IMPORTXML(D').concat(sellNumber,",\"//*[@id='itemprice']\")) ")}]},postparam={method:"POST",body:JSON.stringify(sourceList)};fetch("https://script.google.com/macros/s/".concat(NEXT_PUBLIC_GOOGLE_SHEETS_POST_KEY,"/exec"),postparam).then(response=>(console.log(response.status),response.json())).then(data=>{console.log(data.result),setLoding(!0)}).catch(err=>{console.log("Error!")})},click=()=>{if(setInput&&-1!==setInput.indexOf("https://www.amazon.co.jp/")){let itemUrl=setInput.split("/");addData("https://sakura-checker.jp/search/".concat(itemUrl[5]));return}if(setInput&&-1!==setInput.indexOf("https://sakura-checker.jp/")){addData(setInput);return}},[sumPrice,setSumPrice]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),sum=0;return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{sumPrice.forEach((item,index)=>{sum+=Number(item.price)})},[sumPrice]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let menberId=sessionStorage.getItem("meberId");console.log(menberId),menberId||sessionStorage.setItem("menberId","1")},[]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{},[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().main,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{children:"桜チェッカーのURLから値段と商品名を抜き出す"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().inputBox,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().inputs,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{type:"text",onChange:e=>getInput(e.target.value),className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().inputs}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>click(),children:"送信"})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>Update("2","5"),children:"Update demo"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("section",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().container,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().box,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{children:"商品一覧"}),userAllProduct.sort((x,y)=>Number(x.itemId)-Number(y.itemId)).map((item,index)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().itemBox,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().itemName,children:["商品名：",item.productName]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:["値段：",item.price]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>Delete(item.menberId,item.itemId),disabled:!flag,children:"削除"})]},"".concat(index)))]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().box,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{children:"合計"}),sumPrice.map((item,index)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().itemBox,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_url_url_module_scss__WEBPACK_IMPORTED_MODULE_2___default().item,children:["商品名：",item.productName]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:["値段：",item.price]})]})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:["合計金額：",sum]})]})]})]})}},8855:function(module){module.exports={main:"url_main___tK9F",inputBox:"url_inputBox__SDjrp",inputs:"url_inputs__reh3u",input:"url_input__2CU6Q",button:"url_button__NGhAU",container:"url_container__wiuvT",box:"url_box__Ug8IJ",itemBox:"url_itemBox__px_nq",itemName:"url_itemName__kyFjM"}}},function(__webpack_require__){__webpack_require__.O(0,[774,888,179],function(){return __webpack_require__(__webpack_require__.s=3805)}),_N_E=__webpack_require__.O()}]);