(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[832],{8363:function(__unused_webpack_module,exports){"use strict";exports.__esModule=!0,exports.default=function(file,acceptedFiles){if(file&&acceptedFiles){var acceptedFilesArray=Array.isArray(acceptedFiles)?acceptedFiles:acceptedFiles.split(",");if(0===acceptedFilesArray.length)return!0;var fileName=file.name||"",mimeType=(file.type||"").toLowerCase(),baseMimeType=mimeType.replace(/\/.*$/,"");return acceptedFilesArray.some(function(type){var validType=type.trim().toLowerCase();return"."===validType.charAt(0)?fileName.toLowerCase().endsWith(validType):validType.endsWith("/*")?baseMimeType===validType.replace(/\/.*$/,""):mimeType===validType})}return!0}},7060:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{IOBuffer}=__webpack_require__(4495),constants=__webpack_require__(5578),tableLeft=[];for(let i=0;i<=8;i++)tableLeft.push(255<<i);class BMPEncoder extends IOBuffer{constructor(data){if(1!==data.bitDepth)throw Error("Only bitDepth of 1 is supported");if(!data.height||!data.width)throw Error("ImageData width and height are required");super(data.data),this.width=data.width,this.height=data.height,this.bitDepth=data.bitDepth,this.channels=data.channels,this.components=data.components}encode(){this.encoded=new IOBuffer,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();let offset=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(offset),this.encoded.toArray()}writePixelArray(){let byteA,byteB,io=this.encoded,rowSize=4*Math.floor((this.bitDepth*this.width+31)/32),dataRowSize=Math.ceil(this.bitDepth*this.width/8),skipSize=rowSize-dataRowSize,bitOverflow=this.bitDepth*this.width%8,bitSkip=0===bitOverflow?0:8-bitOverflow,totalBytes=rowSize*this.height,offset=0,relOffset=0,iOffset=8;io.mark(),byteB=this.readUint8();for(let i=this.height-1;i>=0;i--){let lastRow=0===i;io.reset(),io.skip(i*rowSize);for(let j=0;j<dataRowSize;j++){let lastCol=j===dataRowSize-1;relOffset<=bitSkip&&lastCol?(io.writeByte(byteB<<relOffset),0!==bitSkip&&bitSkip!==relOffset||lastRow||(byteA=byteB,byteB=this.readByte())):0===relOffset?(byteA=byteB,byteB=this.readUint8(),io.writeByte(byteA)):(byteA=byteB,byteB=this.readUint8(),io.writeByte(byteA<<relOffset&tableLeft[relOffset]|byteB>>iOffset)),lastCol&&(offset+=bitOverflow||0,io.skip(skipSize),iOffset=8-(relOffset=offset%8))}}rowSize>dataRowSize&&(io.reset(),io.skip(totalBytes-1),io.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(imageOffset){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(imageOffset)}writeBitmapV5Header(){let rowSize=4*Math.floor((this.bitDepth*this.width+31)/32),totalBytes=rowSize*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(constants.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(totalBytes).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(constants.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(constants.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}module.exports=BMPEncoder},5578:function(module){"use strict";module.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},4665:function(__unused_webpack_module,exports,__webpack_require__){"use strict";let Encoder=__webpack_require__(7060);exports.c=function(data){let encoder=new Encoder(data);return encoder.encode()}},7909:function(module){"use strict";let defaultByteLength=8192,charArray=[];class IOBuffer{constructor(data,options){options=options||{},void 0===data&&(data=defaultByteLength),"number"==typeof data&&(data=new ArrayBuffer(data));let length=data.byteLength,offset=options.offset?options.offset>>>0:0;data.buffer&&(length=data.byteLength-offset,data=data.byteLength!==data.buffer.byteLength?data.buffer.slice(data.byteOffset+offset,data.byteOffset+data.byteLength):offset?data.buffer.slice(offset):data.buffer),this.buffer=data,this.length=length,this.byteLength=length,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=length||defaultByteLength,this._mark=0}available(byteLength){return void 0===byteLength&&(byteLength=1),this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(n){void 0===n&&(n=1),this.offset+=n}seek(offset){this.offset=offset}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(byteLength){if(void 0===byteLength&&(byteLength=1),!this.available(byteLength)){let newIncrement=this._increment+this._increment;this._increment=newIncrement;let newLength=this.length+newIncrement,newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=newLength,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n){void 0===n&&(n=1);for(var bytes=new Uint8Array(n),i=0;i<n;i++)bytes[i]=this.readByte();return bytes}readInt16(){var value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){var value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){var value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){var value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){var value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){var value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n){void 0===n&&(n=1),charArray.length=n;for(var i=0;i<n;i++)charArray[i]=this.readChar();return charArray.join("")}writeBoolean(bool){this.writeUint8(bool?255:0)}writeInt8(value){this.ensureAvailable(1),this._data.setInt8(this.offset++,value)}writeUint8(value){this.ensureAvailable(1),this._data.setUint8(this.offset++,value)}writeByte(value){this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(var i=0;i<bytes.length;i++)this._data.setUint8(this.offset++,bytes[i])}writeInt16(value){this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2}writeUint16(value){this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2}writeInt32(value){this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4}writeUint32(value){this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4}writeFloat32(value){this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4}writeFloat64(value){this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8}writeChar(str){this.writeUint8(str.charCodeAt(0))}writeChars(str){for(var i=0;i<str.length;i++)this.writeUint8(str.charCodeAt(i))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}module.exports=IOBuffer},3311:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let TIFFDecoder=__webpack_require__(6752);module.exports=function(data,options){let decoder=new TIFFDecoder(data,options);return decoder.decode(options)}},8029:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let tags={standard:__webpack_require__(4263),exif:__webpack_require__(9640),gps:__webpack_require__(5367)};class IFD{constructor(kind){if(!kind)throw Error("missing kind");this.data=null,this.fields=new Map,this.kind=kind,this._map=null}get(tag){if("number"==typeof tag)return this.fields.get(tag);if("string"==typeof tag)return this.fields.get(tags[this.kind].tagsByName[tag]);throw Error("expected a number or string")}get map(){if(!this._map){this._map={};let taglist=tags[this.kind].tagsById;for(var key of this.fields.keys())taglist[key]&&(this._map[taglist[key]]=this.fields.get(key))}return this._map}}module.exports=IFD},6486:function(__unused_webpack_module,exports){"use strict";var types=new Map([[1,[1,readByte]],[2,[1,readASCII]],[3,[2,readShort]],[4,[4,readLong]],[5,[8,readRational]],[6,[1,readSByte]],[7,[1,readByte]],[8,[2,readSShort]],[9,[4,readSLong]],[10,[8,readSRational]],[11,[4,readFloat]],[12,[8,readDouble]]]);function readByte(decoder,count){if(1===count)return decoder.readUint8();for(var array=new Uint8Array(count),i=0;i<count;i++)array[i]=decoder.readUint8();return array}function readASCII(decoder,count){for(var strings=[],currentString="",i=0;i<count;i++){var char=String.fromCharCode(decoder.readUint8());"\0"===char?(strings.push(currentString),currentString=""):currentString+=char}return 1===strings.length?strings[0]:strings}function readShort(decoder,count){if(1===count)return decoder.readUint16();for(var array=new Uint16Array(count),i=0;i<count;i++)array[i]=decoder.readUint16();return array}function readLong(decoder,count){if(1===count)return decoder.readUint32();for(var array=new Uint32Array(count),i=0;i<count;i++)array[i]=decoder.readUint32();return array}function readRational(decoder,count){if(1===count)return decoder.readUint32()/decoder.readUint32();for(var rationals=Array(count),i=0;i<count;i++)rationals[i]=decoder.readUint32()/decoder.readUint32();return rationals}function readSByte(decoder,count){if(1===count)return decoder.readInt8();for(var array=new Int8Array(count),i=0;i<count;i++)array[i]=decoder.readInt8();return array}function readSShort(decoder,count){if(1===count)return decoder.readInt16();for(var array=new Int16Array(count),i=0;i<count;i++)array[i]=decoder.readInt16();return array}function readSLong(decoder,count){if(1===count)return decoder.readInt32();for(var array=new Int32Array(count),i=0;i<count;i++)array[i]=decoder.readInt32();return array}function readSRational(decoder,count){if(1===count)return decoder.readInt32()/decoder.readInt32();for(var rationals=Array(count),i=0;i<count;i++)rationals[i]=decoder.readInt32()/decoder.readInt32();return rationals}function readFloat(decoder,count){if(1===count)return decoder.readFloat32();for(var array=new Float32Array(count),i=0;i<count;i++)array[i]=decoder.readFloat32();return array}function readDouble(decoder,count){if(1===count)return decoder.readFloat64();for(var array=new Float64Array(count),i=0;i<count;i++)array[i]=decoder.readFloat64();return array}exports.getByteLength=function(type,count){return types.get(type)[0]*count},exports.readData=function(decoder,type,count){return types.get(type)[1](decoder,count)}},9469:function(__unused_webpack_module,exports,__webpack_require__){"use strict";exports.decode=__webpack_require__(3311)},9640:function(module){"use strict";let tagsById={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName={};for(var i in tagsById)tagsByName[tagsById[i]]=i;module.exports={tagsById,tagsByName}},5367:function(module){"use strict";let tagsById={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName={};for(var i in tagsById)tagsByName[tagsById[i]]=i;module.exports={tagsById,tagsByName}},4263:function(module){"use strict";let tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName={};for(var i in tagsById)tagsByName[tagsById[i]]=i;module.exports={tagsById,tagsByName}},6752:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let IOBuffer=__webpack_require__(7909),IFD=__webpack_require__(8029),TiffIFD=__webpack_require__(8353),IFDValue=__webpack_require__(6486),defaultOptions={ignoreImageData:!1,onlyFirst:!1};class TIFFDecoder extends IOBuffer{constructor(data,options){super(data,options),this._nextIFD=0}decode(options){options=Object.assign({},defaultOptions,options);let result=[];for(this.decodeHeader();this._nextIFD;)if(result.push(this.decodeIFD(options)),options.onlyFirst)return result[0];return result}decodeHeader(){let value=this.readUint16();if(18761===value)this.setLittleEndian();else if(19789===value)this.setBigEndian();else throw Error("invalid byte order: 0x"+value.toString(16));if(42!==(value=this.readUint16()))throw Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(options){this.seek(this._nextIFD),ifd=options.kind?new IFD(options.kind):new TiffIFD;let numEntries=this.readUint16();for(var ifd,i=0;i<numEntries;i++)this.decodeIFDEntry(ifd);return options.ignoreImageData||this.decodeImageData(ifd),this._nextIFD=this.readUint32(),ifd}decodeIFDEntry(ifd){let offset=this.offset,tag=this.readUint16(),type=this.readUint16(),numValues=this.readUint32();if(type<1||type>12){this.skip(4);return}let valueByteLength=IFDValue.getByteLength(type,numValues);valueByteLength>4&&this.seek(this.readUint32());let value=IFDValue.readData(this,type,numValues);if(ifd.fields.set(tag,value),34665===tag||34853===tag){let kind,currentOffset=this.offset;34665===tag?kind="exif":34853===tag&&(kind="gps"),this._nextIFD=value,ifd[kind]=this.decodeIFD({kind,ignoreImageData:!0}),this.offset=currentOffset}this.seek(offset),this.skip(12)}decodeImageData(ifd){let orientation=ifd.orientation;switch(orientation&&1!==orientation&&unsupported("orientation",orientation),ifd.type){case 1:case 2:this.readStripData(ifd);break;default:unsupported("image type",ifd.type)}}readStripData(ifd){let width=ifd.width,height=ifd.height,bitDepth=validateBitDepth(ifd.bitsPerSample),sampleFormat=ifd.sampleFormat,size=width*height,data=getDataArray(size,1,bitDepth,sampleFormat),compression=ifd.compression,rowsPerStrip=ifd.rowsPerStrip,maxPixels=rowsPerStrip*width,stripOffsets=ifd.stripOffsets,stripByteCounts=ifd.stripByteCounts;for(var pixel=0,i=0;i<stripOffsets.length;i++){var stripData=this.getStripData(compression,stripOffsets[i],stripByteCounts[i]),length=size>maxPixels?maxPixels:size;size-=length,8===bitDepth?pixel=fill8bit(data,stripData,pixel,length):16===bitDepth?pixel=fill16bit(data,stripData,pixel,length,this.isLittleEndian()):32===bitDepth&&3===sampleFormat?pixel=fillFloat32(data,stripData,pixel,length,this.isLittleEndian()):unsupported("bitDepth",bitDepth)}ifd.data=data}getStripData(compression,offset,byteCounts){switch(compression){case 1:return new DataView(this.buffer,offset,byteCounts);case 2:case 32773:return unsupported("Compression",compression);default:throw Error("invalid compression: "+compression)}}}function getDataArray(size,channels,bitDepth,sampleFormat){return 8===bitDepth?new Uint8Array(size*channels):16===bitDepth?new Uint16Array(size*channels):32===bitDepth&&3===sampleFormat?new Float32Array(size*channels):unsupported("bit depth / sample format",bitDepth+" / "+sampleFormat)}function fill8bit(dataTo,dataFrom,index,length){for(var i=0;i<length;i++)dataTo[index++]=dataFrom.getUint8(i);return index}function fill16bit(dataTo,dataFrom,index,length,littleEndian){for(var i=0;i<2*length;i+=2)dataTo[index++]=dataFrom.getUint16(i,littleEndian);return index}function fillFloat32(dataTo,dataFrom,index,length,littleEndian){for(var i=0;i<4*length;i+=4)dataTo[index++]=dataFrom.getFloat32(i,littleEndian);return index}function unsupported(type,value){throw Error("Unsupported "+type+": "+value)}function validateBitDepth(bitDepth){if(bitDepth.length){let bitDepthArray=bitDepth;bitDepth=bitDepthArray[0];for(var i=0;i<bitDepthArray.length;i++)bitDepthArray[i]!==bitDepth&&unsupported("bit depth",bitDepthArray)}return bitDepth}module.exports=TIFFDecoder},8353:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let Ifd=__webpack_require__(8029),dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends Ifd{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var date=new Date,result=dateTimeRegex.exec(this.dateTime);return date.setFullYear(result[1],result[2]-1,result[3]),date.setHours(result[4],result[5],result[6]),date}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return alwaysArray(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return alwaysArray(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function alwaysArray(value){return"number"==typeof value?[value]:value}module.exports=TiffIfd},9698:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let IOBuffer=__webpack_require__(7909),tiff=__webpack_require__(9469);function decode(data){let buffer=new IOBuffer(data),result={};buffer.setBigEndian();let val=buffer.readUint16();if(65496!==val)throw Error("SOI marker not found. Not a valid JPEG file");let next=buffer.readUint16();if(65505===next){buffer.readUint16();let header=buffer.readBytes(6);if(69===header[0]&&120===header[1]&&105===header[2]&&102===header[3]&&0===header[4]&&0===header[5]){let exif=tiff.decode(buffer,{onlyFirst:!0,ignoreImageData:!0,offset:buffer.offset});result.exif=exif}}return result}module.exports=decode},9464:function(__unused_webpack_module,exports,__webpack_require__){"use strict";exports.decode=__webpack_require__(9698)},8737:function(module){!function(){function Item(data,prev,next){this.next=next,next&&(next.prev=this),this.prev=prev,prev&&(prev.next=this),this.data=data}function FastList(){if(!(this instanceof FastList))return new FastList;this._head=null,this._tail=null,this.length=0}FastList.prototype={push:function(data){this._tail=new Item(data,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(data){this._head=new Item(data,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var h=this._head;return this._head=h.next,h.next&&(h.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),h.data}},item:function(n){n<0&&(n=this.length+n);for(var h=this._head;n-- >0&&h;)h=h.next;return h?h.data:void 0},slice:function(n,m){if(n||(n=0),m||(m=this.length),m<0&&(m=this.length+m),n<0&&(n=this.length+n),m===n)return[];if(m<n)throw Error("invalid offset: "+n+","+m+" (length="+this.length+")");for(var len=m-n,ret=Array(len),i=0,h=this._head;n-- >0&&h;)h=h.next;for(;i<len&&h;)ret[i++]=h.data,h=h.next;return ret},drop:function(){FastList.call(this)},forEach:function(fn,thisp){for(var p=this._head,i=0,len=this.length;i<len&&p;)fn.call(thisp||this,p.data,i,this),p=p.next,i++},map:function(fn,thisp){var n=new FastList;return this.forEach(function(v,i,me){n.push(fn.call(thisp||me,v,i,me))}),n},filter:function(fn,thisp){var n=new FastList;return this.forEach(function(v,i,me){fn.call(thisp||me,v,i,me)&&n.push(v)}),n},reduce:function(fn,val,thisp){var i=0,p=this._head,len=this.length;for(val||(i=1,val=p&&p.data,p=p&&p.next);i<len&&p;)val=fn.call(thisp||this,val,p.data,this),i++,p=p.next;return val}},module.exports=FastList}()},9645:function(module){"use strict";function FFT(size){if(this.size=0|size,this.size<=1||(this.size&this.size-1)!=0)throw Error("FFT size must be a power of two and bigger than 1");this._csize=size<<1;for(var table=Array(2*this.size),i=0;i<table.length;i+=2){let angle=Math.PI*i/this.size;table[i]=Math.cos(angle),table[i+1]=-Math.sin(angle)}this.table=table;for(var power=0,t=1;this.size>t;t<<=1)power++;this._width=power%2==0?power-1:power,this._bitrev=Array(1<<this._width);for(var j=0;j<this._bitrev.length;j++){this._bitrev[j]=0;for(var shift=0;shift<this._width;shift+=2){var revShift=this._width-shift-2;this._bitrev[j]|=(j>>>shift&3)<<revShift}}this._out=null,this._data=null,this._inv=0}module.exports=FFT,FFT.prototype.fromComplexArray=function(complex,storage){for(var res=storage||Array(complex.length>>>1),i=0;i<complex.length;i+=2)res[i>>>1]=complex[i];return res},FFT.prototype.createComplexArray=function(){let res=Array(this._csize);for(var i=0;i<res.length;i++)res[i]=0;return res},FFT.prototype.toComplexArray=function(input,storage){for(var res=storage||this.createComplexArray(),i=0;i<res.length;i+=2)res[i]=input[i>>>1],res[i+1]=0;return res},FFT.prototype.completeSpectrum=function(spectrum){for(var size=this._csize,half=size>>>1,i=2;i<half;i+=2)spectrum[size-i]=spectrum[i],spectrum[size-i+1]=-spectrum[i+1]},FFT.prototype.transform=function(out,data){if(out===data)throw Error("Input and output buffers must be different");this._out=out,this._data=data,this._inv=0,this._transform4(),this._out=null,this._data=null},FFT.prototype.realTransform=function(out,data){if(out===data)throw Error("Input and output buffers must be different");this._out=out,this._data=data,this._inv=0,this._realTransform4(),this._out=null,this._data=null},FFT.prototype.inverseTransform=function(out,data){if(out===data)throw Error("Input and output buffers must be different");this._out=out,this._data=data,this._inv=1,this._transform4();for(var i=0;i<out.length;i++)out[i]/=this.size;this._out=null,this._data=null},FFT.prototype._transform4=function(){var outOff,t,out=this._out,size=this._csize,step=1<<this._width,len=size/step<<1,bitrev=this._bitrev;if(4===len)for(outOff=0,t=0;outOff<size;outOff+=len,t++){let off=bitrev[t];this._singleTransform2(outOff,off,step)}else for(outOff=0,t=0;outOff<size;outOff+=len,t++){let off1=bitrev[t];this._singleTransform4(outOff,off1,step)}var inv=this._inv?-1:1,table=this.table;for(step>>=2;step>=2;step>>=2){var quarterLen=(len=size/step<<1)>>>2;for(outOff=0;outOff<size;outOff+=len)for(var limit=outOff+quarterLen,i=outOff,k=0;i<limit;i+=2,k+=step){let A=i,B=A+quarterLen,C=B+quarterLen,D=C+quarterLen,Ar=out[A],Ai=out[A+1],Br=out[B],Bi=out[B+1],Cr=out[C],Ci=out[C+1],Dr=out[D],Di=out[D+1],MAr=Ar,MAi=Ai,tableBr=table[k],tableBi=inv*table[k+1],MBr=Br*tableBr-Bi*tableBi,MBi=Br*tableBi+Bi*tableBr,tableCr=table[2*k],tableCi=inv*table[2*k+1],MCr=Cr*tableCr-Ci*tableCi,MCi=Cr*tableCi+Ci*tableCr,tableDr=table[3*k],tableDi=inv*table[3*k+1],MDr=Dr*tableDr-Di*tableDi,MDi=Dr*tableDi+Di*tableDr,T0r=MAr+MCr,T0i=MAi+MCi,T1r=MAr-MCr,T1i=MAi-MCi,T2r=MBr+MDr,T2i=MBi+MDi,T3r=inv*(MBr-MDr),T3i=inv*(MBi-MDi),FAr=T0r+T2r,FAi=T0i+T2i,FCr=T0r-T2r,FCi=T0i-T2i,FBr=T1r+T3i,FBi=T1i-T3r,FDr=T1r-T3i,FDi=T1i+T3r;out[A]=FAr,out[A+1]=FAi,out[B]=FBr,out[B+1]=FBi,out[C]=FCr,out[C+1]=FCi,out[D]=FDr,out[D+1]=FDi}}},FFT.prototype._singleTransform2=function(outOff,off,step){let out=this._out,data=this._data,evenR=data[off],evenI=data[off+1],oddR=data[off+step],oddI=data[off+step+1],leftR=evenR+oddR,leftI=evenI+oddI,rightR=evenR-oddR,rightI=evenI-oddI;out[outOff]=leftR,out[outOff+1]=leftI,out[outOff+2]=rightR,out[outOff+3]=rightI},FFT.prototype._singleTransform4=function(outOff,off,step){let out=this._out,data=this._data,inv=this._inv?-1:1,step2=2*step,step3=3*step,Ar=data[off],Ai=data[off+1],Br=data[off+step],Bi=data[off+step+1],Cr=data[off+step2],Ci=data[off+step2+1],Dr=data[off+step3],Di=data[off+step3+1],T0r=Ar+Cr,T0i=Ai+Ci,T1r=Ar-Cr,T1i=Ai-Ci,T2r=Br+Dr,T2i=Bi+Di,T3r=inv*(Br-Dr),T3i=inv*(Bi-Di),FAr=T0r+T2r,FAi=T0i+T2i,FBr=T1r+T3i,FBi=T1i-T3r,FCr=T0r-T2r,FCi=T0i-T2i,FDr=T1r-T3i,FDi=T1i+T3r;out[outOff]=FAr,out[outOff+1]=FAi,out[outOff+2]=FBr,out[outOff+3]=FBi,out[outOff+4]=FCr,out[outOff+5]=FCi,out[outOff+6]=FDr,out[outOff+7]=FDi},FFT.prototype._realTransform4=function(){var outOff,t,out=this._out,size=this._csize,step=1<<this._width,len=size/step<<1,bitrev=this._bitrev;if(4===len)for(outOff=0,t=0;outOff<size;outOff+=len,t++){let off=bitrev[t];this._singleRealTransform2(outOff,off>>>1,step>>>1)}else for(outOff=0,t=0;outOff<size;outOff+=len,t++){let off1=bitrev[t];this._singleRealTransform4(outOff,off1>>>1,step>>>1)}var inv=this._inv?-1:1,table=this.table;for(step>>=2;step>=2;step>>=2){var halfLen=(len=size/step<<1)>>>1,quarterLen=halfLen>>>1,hquarterLen=quarterLen>>>1;for(outOff=0;outOff<size;outOff+=len)for(var i=0,k=0;i<=hquarterLen;i+=2,k+=step){var A=outOff+i,B=A+quarterLen,C=B+quarterLen,D=C+quarterLen,Ar=out[A],Ai=out[A+1],Br=out[B],Bi=out[B+1],Cr=out[C],Ci=out[C+1],Dr=out[D],Di=out[D+1],MAr=Ar,MAi=Ai,tableBr=table[k],tableBi=inv*table[k+1],MBr=Br*tableBr-Bi*tableBi,MBi=Br*tableBi+Bi*tableBr,tableCr=table[2*k],tableCi=inv*table[2*k+1],MCr=Cr*tableCr-Ci*tableCi,MCi=Cr*tableCi+Ci*tableCr,tableDr=table[3*k],tableDi=inv*table[3*k+1],MDr=Dr*tableDr-Di*tableDi,MDi=Dr*tableDi+Di*tableDr,T0r=MAr+MCr,T0i=MAi+MCi,T1r=MAr-MCr,T1i=MAi-MCi,T2r=MBr+MDr,T2i=MBi+MDi,T3r=inv*(MBr-MDr),T3i=inv*(MBi-MDi),FAr=T0r+T2r,FAi=T0i+T2i,FBr=T1r+T3i,FBi=T1i-T3r;if(out[A]=FAr,out[A+1]=FAi,out[B]=FBr,out[B+1]=FBi,0===i){var FCr=T0r-T2r,FCi=T0i-T2i;out[C]=FCr,out[C+1]=FCi;continue}if(i!==hquarterLen){var ST0r=T1r,ST0i=-T1i,ST1r=T0r,ST1i=-T0i,ST2r=-inv*T3i,ST2i=-inv*T3r,ST3r=-inv*T2i,ST3i=-inv*T2r,SFAr=ST0r+ST2r,SFAi=ST0i+ST2i,SFBr=ST1r+ST3i,SFBi=ST1i-ST3r,SA=outOff+quarterLen-i,SB=outOff+halfLen-i;out[SA]=SFAr,out[SA+1]=SFAi,out[SB]=SFBr,out[SB+1]=SFBi}}}},FFT.prototype._singleRealTransform2=function(outOff,off,step){let out=this._out,data=this._data,evenR=data[off],oddR=data[off+step],leftR=evenR+oddR,rightR=evenR-oddR;out[outOff]=leftR,out[outOff+1]=0,out[outOff+2]=rightR,out[outOff+3]=0},FFT.prototype._singleRealTransform4=function(outOff,off,step){let out=this._out,data=this._data,inv=this._inv?-1:1,step2=2*step,step3=3*step,Ar=data[off],Br=data[off+step],Cr=data[off+step2],Dr=data[off+step3],T0r=Ar+Cr,T1r=Ar-Cr,T2r=Br+Dr,T3r=inv*(Br-Dr),FAr=T0r+T2r,FBr=T1r,FBi=-T3r,FCr=T0r-T2r,FDr=T1r,FDi=T3r;out[outOff]=FAr,out[outOff+1]=0,out[outOff+2]=FBr,out[outOff+3]=FBi,out[outOff+4]=FCr,out[outOff+5]=0,out[outOff+6]=FDr,out[outOff+7]=FDi}},7769:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(1876).Buffer;let toBytes=s=>[...s].map(c=>c.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(buf,offset=0){let n=buf[offset],mul=1,i=0;for(;++i<8;)mul*=256,n+=buf[offset+i]*mul;return n}let fileType=input=>{if(!(input instanceof Uint8Array||input instanceof ArrayBuffer||Buffer.isBuffer(input)))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof input}\``);let buf=input instanceof Uint8Array?input:new Uint8Array(input);if(!(buf&&buf.length>1))return null;let check=(header,options)=>{options=Object.assign({offset:0},options);for(let i=0;i<header.length;i++)if(options.mask){if(header[i]!==(options.mask[i]&buf[i+options.offset]))return!1}else if(header[i]!==buf[i+options.offset])return!1;return!0},checkString=(header,options)=>check(toBytes(header),options);if(check([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(check([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(check([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(check([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((check([73,73,42,0])||check([77,77,0,42]))&&check([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(check([73,73,42,0])||check([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(check([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(check([80,75,3,4])){if(check([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(check(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(checkString("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(checkString("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(checkString("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};let findNextZipHeaderIndex=(arr,startAt=0)=>arr.findIndex((el,i,arr)=>i>=startAt&&80===arr[i]&&75===arr[i+1]&&3===arr[i+2]&&4===arr[i+3]),zipHeaderIndex=0,oxmlFound=!1,type=null;do{let offset=zipHeaderIndex+30;if(oxmlFound||(oxmlFound=check(oxmlContentTypes,{offset})||check(oxmlRels,{offset})),!type&&(checkString("word/",{offset})?type={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:checkString("ppt/",{offset})?type={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:checkString("xl/",{offset})&&(type={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),oxmlFound&&type)return type;zipHeaderIndex=findNextZipHeaderIndex(buf,offset)}while(zipHeaderIndex>=0);if(type)return type}if(check([80,75])&&(3===buf[2]||5===buf[2]||7===buf[2])&&(4===buf[3]||6===buf[3]||8===buf[3]))return{ext:"zip",mime:"application/zip"};if(check([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(check([82,97,114,33,26,7])&&(0===buf[6]||1===buf[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(check([51,103,112,53])||check([0,0,0])&&check([102,116,121,112],{offset:4})&&(check([109,112,52,49],{offset:8})||check([109,112,52,50],{offset:8})||check([105,115,111,109],{offset:8})||check([105,115,111,50],{offset:8})||check([109,109,112,52],{offset:8})||check([77,52,86],{offset:8})||check([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(check([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(check([26,69,223,163])){let sliced=buf.subarray(4,4100),idPos=sliced.findIndex((el,i,arr)=>66===arr[i]&&130===arr[i+1]);if(-1!==idPos){let docTypePos=idPos+3,findDocType=type=>[...type].every((c,i)=>sliced[docTypePos+i]===c.charCodeAt(0));if(findDocType("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(findDocType("webm"))return{ext:"webm",mime:"video/webm"}}}if(check([0,0,0,20,102,116,121,112,113,116,32,32])||check([102,114,101,101],{offset:4})||check([102,116,121,112,113,116,32,32],{offset:4})||check([109,100,97,116],{offset:4})||check([109,111,111,118],{offset:4})||check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(check([82,73,70,70])){if(check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(check([48,38,178,117,142,102,207,17,166,217])){let offset1=30;do{let objectSize=readUInt64LE(buf,offset1+16);if(check([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:offset1})){if(check([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:offset1+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(check([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:offset1+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}offset1+=objectSize}while(offset1+24<=buf.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(check([0,0,1,186])||check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(check([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let start=0;start<2&&start<buf.length-16;start++){if(check([73,68,51],{offset:start})||check([255,226],{offset:start,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(check([255,228],{offset:start,mask:[255,228]})||check([255,248],{offset:start,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(check([255,240],{offset:start,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(check([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(check([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(check([79,103,103,83]))return check([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:check([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:check([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:check([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:check([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(check([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(check([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(check([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(check([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(check([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===buf[0]||70===buf[0])&&check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(check([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(check([119,79,70,70])&&(check([0,1,0,0],{offset:4})||check([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(check([119,79,70,50])&&(check([0,1,0,0],{offset:4})||check([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(check([76,80],{offset:34})&&(check([0,0,1],{offset:8})||check([1,0,2],{offset:8})||check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(check([37,33]))return{ext:"ps",mime:"application/postscript"};if(check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(check([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(check([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(check([77,83,67,70])||check([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(check([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(check([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(check([31,160])||check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(check([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(check([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(check([71],{offset:4})&&(check([71],{offset:192})||check([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(check([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(check([0,0,0,12,106,80,32,32,13,10,135,10])){if(check([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(check([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(check([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(check([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(check([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(check([102,116,121,112],{offset:4})){if(check([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(check([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(check([104,101,105,99],{offset:8})||check([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(check([104,101,118,99],{offset:8})||check([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return check([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:check([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:check([77,80,43])||check([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:check([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:check([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:check([212,195,178,161])||check([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{let stream=eval("require")("stream");readableStream.once("readable",()=>{let pass=new stream.PassThrough,chunk=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{pass.fileType=fileType(chunk)}catch(error){reject(error)}readableStream.unshift(chunk),stream.pipeline?resolve(stream.pipeline(readableStream,pass,()=>{})):resolve(readableStream.pipe(pass))})})},2251:function(module,exports,__webpack_require__){var hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=exports=function(prop,obj){return hasOwnProperty.call(obj,prop)},exports.version=__webpack_require__(2898).version},1664:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Ee:function(){return Image_Image}});var ResolutionUnitSpecifier,ResolutionUnitSpecifier1,model_namespaceObject={};__webpack_require__.r(model_namespaceObject),__webpack_require__.d(model_namespaceObject,{CMYK:function(){return CMYK},GREY:function(){return GREY},HSL:function(){return HSL},HSV:function(){return HSV},RGB:function(){return RGB}});var exif_namespaceObject={};__webpack_require__.r(exif_namespaceObject),__webpack_require__.d(exif_namespaceObject,{tagsById:function(){return tagsById},tagsByName:function(){return tagsByName}});var gps_namespaceObject={};__webpack_require__.r(gps_namespaceObject),__webpack_require__.d(gps_namespaceObject,{tagsById:function(){return gps_tagsById},tagsByName:function(){return gps_tagsByName}});var standard_namespaceObject={};__webpack_require__.r(standard_namespaceObject),__webpack_require__.d(standard_namespaceObject,{tagsById:function(){return standard_tagsById},tagsByName:function(){return standard_tagsByName}});let bitMethods={getBit(pixel){return this.data[getSlot(pixel)]&1<<getShift(pixel)?1:0},setBit(pixel){this.data[getSlot(pixel)]|=1<<getShift(pixel)},clearBit(pixel){this.data[getSlot(pixel)]&=~(1<<getShift(pixel))},toggleBit(pixel){this.data[getSlot(pixel)]^=1<<getShift(pixel)},getBitXY(x,y){return x>=this.width||y>=this.height?0:this.getBit(y*this.width+x)},setBitXY(x,y){this.setBit(y*this.width+x)},clearBitXY(x,y){this.clearBit(y*this.width+x)},toggleBitXY(x,y){this.toggleBit(y*this.width+x)}};function getSlot(pixel){return pixel>>3}function getShift(pixel){return 7-(7&pixel)}function setBitMethods(Image){for(let i in bitMethods)Image.prototype[i]=bitMethods[i]}function checkProcessable(processName,options={}){let{bitDepth,alpha,colorModel,components,channels}=options;if("string"!=typeof processName||0===processName.length)throw TypeError("processName must be a string");if(bitDepth&&(Array.isArray(bitDepth)||(bitDepth=[bitDepth]),!bitDepth.includes(this.bitDepth)))throw TypeError(`The process: ${processName} can only be applied if bit depth is in: ${bitDepth}`);if(alpha&&(Array.isArray(alpha)||(alpha=[alpha]),!alpha.includes(this.alpha)))throw TypeError(`The process: ${processName} can only be applied if alpha is in: ${alpha}`);if(colorModel&&(Array.isArray(colorModel)||(colorModel=[colorModel]),!colorModel.includes(this.colorModel)))throw TypeError(`The process: ${processName} can only be applied if color model is in: ${colorModel}`);if(components&&(Array.isArray(components)||(components=[components]),!components.includes(this.components))){let errorMessage=`The process: ${processName} can only be applied if the number of components is in: ${components}`;if(1===components.length&&1===components[0])throw TypeError(`${errorMessage}.\rYou should transform your image using "image.grey()" before applying the algorithm.`);throw TypeError(errorMessage)}if(channels&&(Array.isArray(channels)||(channels=[channels]),!channels.includes(this.channels)))throw TypeError(`The process: ${processName} can only be applied if the number of channels is in: ${channels}`)}function createBlob(parts,properties){parts=parts||[],"string"==typeof(properties=properties||{})&&(properties={type:properties});try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var builder=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}function dataURLToBlob(dataURL){var type=dataURL.match(/data:([^;]+)/)[1];return createBlob([binaryStringToArrayBuffer(atob(dataURL.replace(/^[^,]+,/,"")))],{type:type})}function canvasToBlob(canvas,type,quality){return"function"==typeof canvas.toBlob?new Promise(function(resolve){canvas.toBlob(resolve,type,quality)}):Promise.resolve(dataURLToBlob(canvas.toDataURL(type,quality)))}function binaryStringToArrayBuffer(binary){for(var length=binary.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=-1;++i<length;)arr[i]=binary.charCodeAt(i);return buf}var src=__webpack_require__(4665),IOBuffer=__webpack_require__(4495),pako_esm=__webpack_require__(7885);let crcTable=[];for(let n=0;n<256;n++){let c=n;for(let k=0;k<8;k++)1&c?c=3988292384^c>>>1:c>>>=1;crcTable[n]=c}let initialCrc=4294967295;function updateCrc(currentCrc,data,length){let c=currentCrc;for(let n=0;n<length;n++)c=crcTable[(c^data[n])&255]^c>>>8;return c}function crc(data,length){return(updateCrc(initialCrc,data,length)^initialCrc)>>>0}function checkCrc(buffer,crcLength,chunkName){let expectedCrc=buffer.readUint32(),actualCrc=crc(new Uint8Array(buffer.buffer,buffer.byteOffset+buffer.offset-crcLength-4,crcLength),crcLength);if(actualCrc!==expectedCrc)throw Error(`CRC mismatch for chunk ${chunkName}. Expected ${expectedCrc}, found ${actualCrc}`)}function writeCrc(buffer,length){buffer.writeUint32(crc(new Uint8Array(buffer.buffer,buffer.byteOffset+buffer.offset-length,length),length))}function unfilterNone(currentLine,newLine,bytesPerLine){for(let i=0;i<bytesPerLine;i++)newLine[i]=currentLine[i]}function unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel){let i=0;for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+newLine[i-bytesPerPixel]&255}function unfilterUp(currentLine,newLine,prevLine,bytesPerLine){let i=0;if(0===prevLine.length)for(;i<bytesPerLine;i++)newLine[i]=currentLine[i];else for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+prevLine[i]&255}function unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i=0;if(0===prevLine.length){for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+(newLine[i-bytesPerPixel]>>1)&255}else{for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i]+(prevLine[i]>>1)&255;for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+(newLine[i-bytesPerPixel]+prevLine[i]>>1)&255}}function unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i=0;if(0===prevLine.length){for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+newLine[i-bytesPerPixel]&255}else{for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i]+prevLine[i]&255;for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+paethPredictor(newLine[i-bytesPerPixel],prevLine[i],prevLine[i-bytesPerPixel])&255}}function paethPredictor(a,b,c){let p=a+b-c,pa=Math.abs(p-a),pb=Math.abs(p-b),pc=Math.abs(p-c);return pa<=pb&&pa<=pc?a:pb<=pc?b:c}let uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=255===uint8[0],empty=new Uint8Array(0);function decodeInterlaceNull(params){let currentLine,newLine;let{data,width,height,channels,depth}=params,bytesPerPixel=channels*depth/8,bytesPerLine=width*bytesPerPixel,newData=new Uint8Array(height*bytesPerLine),prevLine=empty,offset=0;for(let i=0;i<height;i++){switch(currentLine=data.subarray(offset+1,offset+1+bytesPerLine),newLine=newData.subarray(i*bytesPerLine,(i+1)*bytesPerLine),data[offset]){case 0:unfilterNone(currentLine,newLine,bytesPerLine);break;case 1:unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel);break;case 2:unfilterUp(currentLine,newLine,prevLine,bytesPerLine);break;case 3:unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;case 4:unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;default:throw Error(`Unsupported filter: ${data[offset]}`)}prevLine=newLine,offset+=bytesPerLine+1}if(16!==depth)return newData;{let uint16Data=new Uint16Array(newData.buffer);if(osIsLittleEndian)for(let k=0;k<uint16Data.length;k++)uint16Data[k]=swap16(uint16Data[k]);return uint16Data}}function swap16(val){return(255&val)<<8|val>>8&255}let pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function writeSignature(buffer){buffer.writeBytes(pngSignature)}function checkSignature(buffer){if(!hasPngSignature(buffer.readBytes(pngSignature.length)))throw Error("wrong PNG signature")}function hasPngSignature(array){if(array.length<pngSignature.length)return!1;for(let i=0;i<pngSignature.length;i++)if(array[i]!==pngSignature[i])return!1;return!0}let textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(keyword){if(validateLatin1(keyword),0===keyword.length||keyword.length>79)throw Error("keyword length must be between 1 and 79")}let latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(text){if(!latin1Regex.test(text))throw Error("invalid latin1 text")}function decodetEXt(text,buffer,length){let keyword=readKeyword(buffer);text[keyword]=readLatin1(buffer,length-keyword.length-1)}function encodetEXt(buffer,keyword,text){validateKeyword(keyword),validateLatin1(text);let length=keyword.length+1+text.length;buffer.writeUint32(length),buffer.writeChars(textChunkName),buffer.writeChars(keyword),buffer.writeByte(NULL),buffer.writeChars(text),writeCrc(buffer,length+4)}function readKeyword(buffer){for(buffer.mark();buffer.readByte()!==NULL;);let end=buffer.offset;buffer.reset();let keyword=latin1Decoder.decode(buffer.readBytes(end-buffer.offset-1));return buffer.skip(1),validateKeyword(keyword),keyword}function readLatin1(buffer,length){return latin1Decoder.decode(buffer.readBytes(length))}let ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1};class PngDecoder extends IOBuffer.IOBuffer{_checkCrc;_inflator;_png;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;constructor(data,options={}){super(data);let{checkCrc=!1}=options;this._checkCrc=checkCrc,this._inflator=new pako_esm.T_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeChunk(){let length=this.readUint32(),type=this.readChars(4),offset=this.offset;switch(type){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(length);break;case"IDAT":this.decodeIDAT(length);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(length);break;case"iCCP":this.decodeiCCP(length);break;case textChunkName:decodetEXt(this._png.text,this,length);break;case"pHYs":this.decodepHYs();break;default:this.skip(length)}if(this.offset-offset!==length)throw Error(`Length mismatch while decoding chunk ${type}`);this._checkCrc?checkCrc(this,length+4,type):this.skip(4)}decodeIHDR(){let channels;let image=this._png;image.width=this.readUint32(),image.height=this.readUint32(),image.depth=checkBitDepth(this.readUint8());let colorType=this.readUint8();switch(this._colorType=colorType,colorType){case ColorType.GREYSCALE:channels=1;break;case ColorType.TRUECOLOUR:channels=3;break;case ColorType.INDEXED_COLOUR:channels=1;break;case ColorType.GREYSCALE_ALPHA:channels=2;break;case ColorType.TRUECOLOUR_ALPHA:channels=4;break;case ColorType.UNKNOWN:default:throw Error(`Unknown color type: ${colorType}`)}if(this._png.channels=channels,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(length){if(length%3!=0)throw RangeError(`PLTE field length must be a multiple of 3. Got ${length}`);let l=length/3;this._hasPalette=!0;let palette=[];this._palette=palette;for(let i=0;i<l;i++)palette.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(length){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,length)),this.skip(length)}decodetRNS(length){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:if(length%2!=0)throw RangeError(`tRNS chunk length must be a multiple of 2. Got ${length}`);if(length/2>this._png.width*this._png.height)throw Error(`tRNS chunk contains more alpha values than there are pixels (${length/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(length/2);for(let i=0;i<length/2;i++)this._transparency[i]=this.readUint16();break;case ColorType.INDEXED_COLOUR:{if(length>this._palette.length)throw Error(`tRNS chunk contains more alpha values than there are palette colors (${length} vs ${this._palette.length})`);let i1=0;for(;i1<length;i1++){let alpha=this.readByte();this._palette[i1].push(alpha)}for(;i1<this._palette.length;i1++)this._palette[i1].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(length){let name=readKeyword(this),compressionMethod=this.readUint8();if(compressionMethod!==CompressionMethod.DEFLATE)throw Error(`Unsupported iCCP compression method: ${compressionMethod}`);let compressedProfile=this.readBytes(length-name.length-2);this._png.iccEmbeddedProfile={name,profile:(0,pako_esm.rr)(compressedProfile)}}decodepHYs(){let ppuX=this.readUint32(),ppuY=this.readUint32(),unitSpecifier=this.readByte();this._png.resolution={x:ppuX,y:ppuY,unit:unitSpecifier}}decodeImage(){if(this._inflator.err)throw Error(`Error while decompressing the data: ${this._inflator.err}`);let data=this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data:data,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}}function checkBitDepth(value){if(1!==value&&2!==value&&4!==value&&8!==value&&16!==value)throw Error(`invalid bit depth: ${value}`);return value}let defaultZlibOptions={level:3};class PngEncoder extends IOBuffer.IOBuffer{_png;_zlibOptions;_colorType;constructor(data,options={}){super(),this._colorType=ColorType.UNKNOWN,this._zlibOptions={...defaultZlibOptions,...options.zlib},this._png=this._checkData(data),this.setBigEndian()}encode(){if(writeSignature(this),this.encodeIHDR(),this.encodeData(),this._png.text)for(let[keyword,text]of Object.entries(this._png.text))encodetEXt(this,keyword,text);return this.encodeIEND(),this.toArray()}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(CompressionMethod.DEFLATE),this.writeByte(FilterMethod.ADAPTIVE),this.writeByte(InterlaceMethod.NO_INTERLACE),writeCrc(this,17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),writeCrc(this,4)}encodeIDAT(data){this.writeUint32(data.length),this.writeChars("IDAT"),this.writeBytes(data),writeCrc(this,data.length+4)}encodeData(){let{width,height,channels,depth,data}=this._png,slotsPerLine=channels*width,newData=new IOBuffer.IOBuffer().setBigEndian(),offset=0;for(let i=0;i<height;i++)if(newData.writeByte(0),8===depth)offset=writeDataBytes(data,newData,slotsPerLine,offset);else if(16===depth)offset=writeDataUint16(data,newData,slotsPerLine,offset);else throw Error("unreachable");let buffer=newData.toArray(),compressed=(0,pako_esm.Wt)(buffer,this._zlibOptions);this.encodeIDAT(compressed)}_checkData(data){let{colorType,channels,depth}=getColorType(data),png={width:checkInteger(data.width,"width"),height:checkInteger(data.height,"height"),channels,data:data.data,depth,text:data.text};this._colorType=colorType;let expectedSize=png.width*png.height*channels;if(png.data.length!==expectedSize)throw RangeError(`wrong data size. Found ${png.data.length}, expected ${expectedSize}`);return png}}function checkInteger(value,name){if(Number.isInteger(value)&&value>0)return value;throw TypeError(`${name} must be a positive integer`)}function getColorType(data){let{channels=4,depth=8}=data;if(4!==channels&&3!==channels&&2!==channels&&1!==channels)throw RangeError(`unsupported number of channels: ${channels}`);if(8!==depth&&16!==depth)throw RangeError(`unsupported bit depth: ${depth}`);let returnValue={channels,depth,colorType:ColorType.UNKNOWN};switch(channels){case 4:returnValue.colorType=ColorType.TRUECOLOUR_ALPHA;break;case 3:returnValue.colorType=ColorType.TRUECOLOUR;break;case 1:returnValue.colorType=ColorType.GREYSCALE;break;case 2:returnValue.colorType=ColorType.GREYSCALE_ALPHA;break;default:throw Error("unsupported number of channels")}return returnValue}function writeDataBytes(data,newData,slotsPerLine,offset){for(let j=0;j<slotsPerLine;j++)newData.writeByte(data[offset++]);return offset}function writeDataUint16(data,newData,slotsPerLine,offset){for(let j=0;j<slotsPerLine;j++)newData.writeUint16(data[offset++]);return offset}function decodePng(data,options){let decoder=new PngDecoder(data,options);return decoder.decode()}function encodePng(png,options){let encoder=new PngEncoder(png,options);return encoder.encode()}(ResolutionUnitSpecifier=ResolutionUnitSpecifier1||(ResolutionUnitSpecifier1={}))[ResolutionUnitSpecifier.UNKNOWN=0]="UNKNOWN",ResolutionUnitSpecifier[ResolutionUnitSpecifier.METRE=1]="METRE";var jpeg_js=__webpack_require__(7870);let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256);for(let i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;function encode(bytes){let i;let len=bytes.length,base64="";for(i=0;i<len;i+=3)base64=chars[bytes[i]>>2]+chars[(3&bytes[i])<<4|bytes[i+1]>>4]+chars[(15&bytes[i+1])<<2|bytes[i+2]>>6]+chars[63&bytes[i+2]];return len%3==2?base64=`${base64.substring(0,base64.length-1)}=`:len%3==1&&(base64=`${base64.substring(0,base64.length-2)}==`),base64}function decode(base64){let encoded1,encoded2,encoded3,encoded4,bufferLength=.75*base64.length,len=base64.length,p=0;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);let bytes=new Uint8Array(bufferLength);for(let i=0;i<len;i+=4)encoded1=lookup[base64.charCodeAt(i)],encoded2=lookup[base64.charCodeAt(i+1)],encoded3=lookup[base64.charCodeAt(i+2)],encoded4=lookup[base64.charCodeAt(i+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return bytes}function toBase64URL(u8,type){let base64=encode(u8);return`data:${type};base64,${base64}`}let ImageData=self.ImageData,DOMImage=self.Image;function createCanvas(width,height){let canvas=self.document.createElement("canvas");return canvas.width=width,canvas.height=height,canvas}function fetchBinary(url,{withCredentials=!1}={}){return new Promise(function(resolve,reject){let xhr=new self.XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.withCredentials=withCredentials,xhr.onload=function(e){200!==this.status?reject(e):resolve(this.response)},xhr.onerror=reject,xhr.send()})}function createWriteStream(){throw Error("createWriteStream does not exist in the browser")}function writeFile(){throw Error("writeFile does not exist in the browser")}function getType(type){return type.includes("/")||(type=`image/${type}`),type}function encodeJpeg(image,options={}){let data={width:image.width,height:image.height,data:image.getRGBAData()};return(0,jpeg_js.encode)(data,options.quality).data}function export_encodePng(image,options){let data={width:image.width,height:image.height,channels:image.channels,depth:image.bitDepth,data:image.data};return(1===data.depth||32===data.depth)&&(data.depth=8,data.channels=4,data.data=image.getRGBAData()),encodePng(data,options)}let exportMethods={save(path,options={}){let{useCanvas=!1,encoder:encoderOptions}=options,{format}=options;if(!format){let m=/\.(?<format>[a-zA-Z]+)$/.exec(path);m&&(format=m.groups.format.toLowerCase())}if(!format)throw Error("file format not provided");return new Promise((resolve,reject)=>{let stream,buffer;switch(format.toLowerCase()){case"png":useCanvas?stream=this.getCanvas().pngStream():buffer=export_encodePng(this,encoderOptions);break;case"jpg":case"jpeg":useCanvas?stream=this.getCanvas().jpegStream():buffer=encodeJpeg(this,encoderOptions);break;case"bmp":buffer=(0,src.c)(this,encoderOptions);break;default:throw RangeError(`invalid output format: ${format}`)}if(stream){let out=createWriteStream(path);out.on("finish",resolve),out.on("error",reject),stream.pipe(out)}else buffer&&writeFile(path,buffer,err=>{if(err){reject(err);return}resolve()})})},toDataURL(type="image/png",options={}){"object"==typeof type&&(options=type,type="image/png");let{useCanvas=!1,encoder:encoderOptions}=options;function dataUrl(encoder,ctx){let u8=encoder(ctx,encoderOptions);return toBase64URL(u8,type)}return"image/bmp"===(type=getType(type))?dataUrl(src.c,this):"image/png"!==type||useCanvas?"image/jpeg"!==type||useCanvas?this.getCanvas().toDataURL(type):dataUrl(encodeJpeg,this):dataUrl(export_encodePng,this)},toBuffer(options={}){let{format="png",encoder:encoderOptions}=options;switch(format.toLowerCase()){case"png":return export_encodePng(this,encoderOptions);case"jpeg":case"jpg":return encodeJpeg(this,encoderOptions);case"bmp":return(0,src.c)(this,encoderOptions);default:throw RangeError(`invalid output format: ${format}`)}},toBase64(type="image/png",options={}){if(options.async)return this.toDataURL(type,options).then(function(dataURL){return dataURL.substring(dataURL.indexOf(",")+1)});{let dataURL=this.toDataURL(type,options);return dataURL.substring(dataURL.indexOf(",")+1)}},toBlob(type="image/png",quality=.8){return canvasToBlob(this.getCanvas(),type,quality)},getCanvas(){let data=new ImageData(this.getRGBAData({clamped:!0}),this.width,this.height),canvas=createCanvas(this.width,this.height);return canvas.getContext("2d").putImageData(data,0,0),canvas}};function setExportMethods(Image){for(let i in exportMethods)Image.prototype[i]=exportMethods[i]}var has_own=__webpack_require__(2251),has_own_default=__webpack_require__.n(has_own);let computedPropertyDescriptor={configurable:!0,enumerable:!1,get:void 0};function extendMethod(name,method,options={}){let{inPlace=!1,returnThis=!0,partialArgs=[]}=options;return inPlace?Image_Image.prototype[name]=function(...args){this.computed=null;let result=method.apply(this,[...partialArgs,...args]);return returnThis?this:result}:Image_Image.prototype[name]=function(...args){return method.apply(this,[...partialArgs,...args])},Image_Image}function extendProperty(name,method,options={}){let{partialArgs=[]}=options;return computedPropertyDescriptor.get=function(){if(null===this.computed)this.computed={};else if(has_own_default()(name,this.computed))return this.computed[name];let result=method.apply(this,partialArgs);return this.computed[name]=result,result},Object.defineProperty(Image_Image.prototype,name,computedPropertyDescriptor),Image_Image}let GREY="GREY",RGB="RGB",HSL="HSL",HSV="HSV",CMYK="CMYK";function getRGBAData(options={}){let{clamped}=options;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});let arrayLength=this.width*this.height*4,newData=clamped?new Uint8ClampedArray(arrayLength):new Uint8Array(arrayLength);return 1===this.bitDepth?fillDataFromBinary(this,newData):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?fillDataFromGrey32(this,newData):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[RGB]}),fillDataFromRGB32(this,newData))):1===this.components?fillDataFromGrey(this,newData):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[RGB]}),fillDataFromRGB(this,newData)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),copyAlpha(this,newData)):fillAlpha(this,newData),newData}function fillDataFromBinary(image,newData){for(let i=0;i<image.size;i++){let value=image.getBit(i);newData[4*i]=255*value,newData[4*i+1]=255*value,newData[4*i+2]=255*value}}function fillDataFromGrey32(image,newData){let min=image.min[0],max=image.max[0],range=max-min;for(let i=0;i<image.size;i++){let val=Math.floor(255*(image.data[i]-min)/range);newData[4*i]=val,newData[4*i+1]=val,newData[4*i+2]=val}}function fillDataFromRGB32(image,newData){let min=Math.min(...image.min),max=Math.max(...image.max),range=max-min;for(let i=0;i<image.size;i++){let val1=Math.floor(255*(image.data[3*i]-min)/range),val2=Math.floor(255*(image.data[3*i+1]-min)/range),val3=Math.floor(255*(image.data[3*i+2]-min)/range);newData[4*i]=val1,newData[4*i+1]=val2,newData[4*i+2]=val3}}function fillDataFromGrey(image,newData){for(let i=0;i<image.size;i++)newData[4*i]=image.data[i*image.channels]>>>image.bitDepth-8,newData[4*i+1]=image.data[i*image.channels]>>>image.bitDepth-8,newData[4*i+2]=image.data[i*image.channels]>>>image.bitDepth-8}function fillDataFromRGB(image,newData){for(let i=0;i<image.size;i++)newData[4*i]=image.data[i*image.channels]>>>image.bitDepth-8,newData[4*i+1]=image.data[i*image.channels+1]>>>image.bitDepth-8,newData[4*i+2]=image.data[i*image.channels+2]>>>image.bitDepth-8}function copyAlpha(image,newData){for(let i=0;i<image.size;i++)newData[4*i+3]=image.data[i*image.channels+image.components]>>image.bitDepth-8}function fillAlpha(image,newData){for(let i=0;i<image.size;i++)newData[4*i+3]=255}let BINARY="BINARY",kindNames_GREY="GREY",GREYA="GREYA",kindNames_RGB="RGB",RGBA="RGBA",kindNames_CMYK="CMYK",CMYKA="CMYKA",kinds={};function getKind(kind){let result=kinds[kind];if(!result)throw RangeError(`invalid image kind: ${kind}`);return result}kinds[BINARY]={components:1,alpha:0,bitDepth:1,colorModel:GREY},kinds[GREYA]={components:1,alpha:1,bitDepth:8,colorModel:GREY},kinds[kindNames_GREY]={components:1,alpha:0,bitDepth:8,colorModel:GREY},kinds[RGBA]={components:3,alpha:1,bitDepth:8,colorModel:RGB},kinds[kindNames_RGB]={components:3,alpha:0,bitDepth:8,colorModel:RGB},kinds[kindNames_CMYK]={components:4,alpha:0,bitDepth:8,colorModel:CMYK},kinds[CMYKA]={components:4,alpha:1,bitDepth:8,colorModel:CMYK};let validBitDepth=[1,8,16,32];function verifyKindDefinition(definition){let{components,alpha,bitDepth,colorModel}=definition;if(!Number.isInteger(components)||components<=0)throw RangeError(`invalid components: ${components}. Must be a positive integer`);if(0!==alpha&&1!==alpha&&"boolean"!=typeof alpha)throw TypeError(`invalid alpha: ${alpha}: must be a boolean, 0 or 1`);if(!validBitDepth.includes(bitDepth))throw RangeError(`invalid bitDepth: ${bitDepth}. Must be one of ${validBitDepth.join(", ")}`);if(!model_namespaceObject[colorModel])throw RangeError(`invalid colorModel: ${colorModel}. Must be one of ${Object.keys(model_namespaceObject).join(", ")}`)}function getTheoreticalPixelArraySize(size,channels,bitDepth){let length=channels*size;return 1===bitDepth&&(length=Math.ceil(length/8)),length}function createPixelArray(size,components,alpha,channels,bitDepth,maxValue){let arr;let length=channels*size;switch(bitDepth){case 1:arr=new Uint8Array(Math.ceil(length/8));break;case 8:arr=new Uint8Array(length);break;case 16:arr=new Uint16Array(length);break;case 32:arr=new Float32Array(length);break;default:throw Error(`Cannot create pixel array for bit depth ${bitDepth}`)}if(alpha)for(let i=components;i<arr.length;i+=channels)arr[i]=maxValue;return arr}var fast_jpeg_src=__webpack_require__(9464),image_type=__webpack_require__(9184),image_type_default=__webpack_require__.n(image_type);function guessStripByteCounts(ifd){if(1!==ifd.compression)throw Error("missing mandatory StripByteCounts field in compressed image");let bytesPerStrip=ifd.rowsPerStrip*ifd.width*ifd.samplesPerPixel*(ifd.bitsPerSample/8);return Array(ifd.stripOffsets.length).fill(bytesPerStrip)}function applyHorizontalDifferencing8Bit(data,width,components){let i=0;for(;i<data.length;){for(let j=components;j<width*components;j+=components)for(let k=0;k<components;k++)data[i+j+k]=data[i+j+k]+data[i+j-(components-k)]&255;i+=width*components}}function applyHorizontalDifferencing16Bit(data,width,components){let i=0;for(;i<data.length;){for(let j=components;j<width*components;j+=components)for(let k=0;k<components;k++)data[i+j+k]=data[i+j+k]+data[i+j-(components-k)]&65535;i+=width*components}}let tagsById={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName={};for(let i1 in tagsById)tagsByName[tagsById[i1]]=Number(i1);let gps_tagsById={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},gps_tagsByName={};for(let i2 in gps_tagsById)gps_tagsByName[gps_tagsById[i2]]=Number(i2);let standard_tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},standard_tagsByName={};for(let i3 in standard_tagsById)standard_tagsByName[standard_tagsById[i3]]=Number(i3);let tags={standard:standard_namespaceObject,exif:exif_namespaceObject,gps:gps_namespaceObject};class IFD{constructor(kind){if(!kind)throw Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=kind,this._hasMap=!1,this._map={}}get(tag){if("number"==typeof tag)return this.fields.get(tag);if("string"==typeof tag)return this.fields.get(tags[this.kind].tagsByName[tag]);throw Error("expected a number or string")}get map(){if(!this._hasMap){let taglist=tags[this.kind].tagsById;for(let key of this.fields.keys())taglist[key]&&(this._map[taglist[key]]=this.fields.get(key));this._hasMap=!0}return this._map}}let types=new Map([[1,[1,readByte]],[2,[1,readASCII]],[3,[2,readShort]],[4,[4,readLong]],[5,[8,readRational]],[6,[1,readSByte]],[7,[1,readByte]],[8,[2,readSShort]],[9,[4,readSLong]],[10,[8,readSRational]],[11,[4,readFloat]],[12,[8,readDouble]]]);function getByteLength(type,count){let val=types.get(type);if(!val)throw Error(`type not found: ${type}`);return val[0]*count}function readData(decoder,type,count){let val=types.get(type);if(!val)throw Error(`type not found: ${type}`);return val[1](decoder,count)}function readByte(decoder,count){if(1===count)return decoder.readUint8();let array=new Uint8Array(count);for(let i=0;i<count;i++)array[i]=decoder.readUint8();return array}function readASCII(decoder,count){let strings=[],currentString="";for(let i=0;i<count;i++){let char=String.fromCharCode(decoder.readUint8());"\0"===char?(strings.push(currentString),currentString=""):currentString+=char}return 1===strings.length?strings[0]:strings}function readShort(decoder,count){if(1===count)return decoder.readUint16();let array=new Uint16Array(count);for(let i=0;i<count;i++)array[i]=decoder.readUint16();return array}function readLong(decoder,count){if(1===count)return decoder.readUint32();let array=new Uint32Array(count);for(let i=0;i<count;i++)array[i]=decoder.readUint32();return array}function readRational(decoder,count){if(1===count)return decoder.readUint32()/decoder.readUint32();let rationals=Array(count);for(let i=0;i<count;i++)rationals[i]=decoder.readUint32()/decoder.readUint32();return rationals}function readSByte(decoder,count){if(1===count)return decoder.readInt8();let array=new Int8Array(count);for(let i=0;i<count;i++)array[i]=decoder.readInt8();return array}function readSShort(decoder,count){if(1===count)return decoder.readInt16();let array=new Int16Array(count);for(let i=0;i<count;i++)array[i]=decoder.readInt16();return array}function readSLong(decoder,count){if(1===count)return decoder.readInt32();let array=new Int32Array(count);for(let i=0;i<count;i++)array[i]=decoder.readInt32();return array}function readSRational(decoder,count){if(1===count)return decoder.readInt32()/decoder.readInt32();let rationals=Array(count);for(let i=0;i<count;i++)rationals[i]=decoder.readInt32()/decoder.readInt32();return rationals}function readFloat(decoder,count){if(1===count)return decoder.readFloat32();let array=new Float32Array(count);for(let i=0;i<count;i++)array[i]=decoder.readFloat32();return array}function readDouble(decoder,count){if(1===count)return decoder.readFloat64();let array=new Float64Array(count);for(let i=0;i<count;i++)array[i]=decoder.readFloat64();return array}let CLEAR_CODE=256,EOI_CODE=257,TABLE_START=258,MIN_BIT_LENGTH=9,stringTable=[];function initializeStringTable(){if(0===stringTable.length){for(let i=0;i<256;i++)stringTable.push([i]);let dummyString=[];for(let i1=256;i1<4096;i1++)stringTable.push(dummyString)}}let andTable=[511,1023,2047,4095],bitJumps=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class LzwDecoder{constructor(data){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH,this.stripArray=new Uint8Array(data.buffer,data.byteOffset,data.byteLength),this.outData=new IOBuffer.IOBuffer(data.byteLength),this.initializeTable()}decode(){let code=0,oldCode=0;for(;(code=this.getNextCode())!==EOI_CODE;)if(code===CLEAR_CODE){if(this.initializeTable(),(code=this.getNextCode())===EOI_CODE)break;this.writeString(this.stringFromCode(code)),oldCode=code}else if(this.isInTable(code))this.writeString(this.stringFromCode(code)),this.addStringToTable(this.stringFromCode(oldCode).concat(this.stringFromCode(code)[0])),oldCode=code;else{let outString=this.stringFromCode(oldCode).concat(this.stringFromCode(oldCode)[0]);this.writeString(outString),this.addStringToTable(outString),oldCode=code}let outArray=this.outData.toArray();return new DataView(outArray.buffer,outArray.byteOffset,outArray.byteLength)}initializeTable(){initializeStringTable(),this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH}writeString(string){this.outData.writeBytes(string)}stringFromCode(code){return stringTable[code]}isInTable(code){return code<this.tableLength}addStringToTable(string){if(stringTable[this.tableLength++]=string,stringTable.length>4096)throw stringTable=[],Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===bitJumps[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);let code=this.nextData>>this.nextBits-this.currentBitLength&andTable[this.currentBitLength-9];return(this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length)?257:code}}function decompressLzw(stripData){return new LzwDecoder(stripData).decode()}let dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends IFD{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let date=new Date,result=dateTimeRegex.exec(this.dateTime);if(null===result)throw Error(`invalid dateTime: ${this.dateTime}`);return date.setFullYear(Number(result[1]),Number(result[2])-1,Number(result[3])),date.setHours(Number(result[4]),Number(result[5]),Number(result[6])),date}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){let data=this.get("BitsPerSample");return data&&"number"!=typeof data?data[0]:data}get alpha(){let extraSamples=this.extraSamples;return!!extraSamples&&0!==extraSamples[0]}get associatedAlpha(){let extraSamples=this.extraSamples;return!!extraSamples&&1===extraSamples[0]}get extraSamples(){return alwaysArray(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return alwaysArray(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return alwaysArray(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){let totalColors=2**this.bitsPerSample,colorMap=this.get("ColorMap");if(!colorMap)return;if(colorMap.length!==3*totalColors)throw Error(`ColorMap size must be ${totalColors}`);let palette=[];for(let i=0;i<totalColors;i++)palette.push([colorMap[i],colorMap[i+totalColors],colorMap[i+2*totalColors]]);return palette}}function alwaysArray(value){return"number"==typeof value?[value]:value}function decompressZlib(stripData){let stripUint8=new Uint8Array(stripData.buffer,stripData.byteOffset,stripData.byteLength),inflated=(0,pako_esm.rr)(stripUint8);return new DataView(inflated.buffer,inflated.byteOffset,inflated.byteLength)}let defaultOptions={ignoreImageData:!1,onlyFirst:!1};class tiffDecoder_TIFFDecoder extends IOBuffer.IOBuffer{constructor(data){super(data),this._nextIFD=0}get isMultiPage(){let c=0;for(this.decodeHeader();this._nextIFD;)if(c++,this.decodeIFD({ignoreImageData:!0},!0),2===c)return!0;if(1===c)return!1;throw unsupported("ifdCount",c)}get pageCount(){let c=0;for(this.decodeHeader();this._nextIFD;)c++,this.decodeIFD({ignoreImageData:!0},!0);if(c>0)return c;throw unsupported("ifdCount",c)}decode(options={}){options=Object.assign({},defaultOptions,options);let result=[];for(this.decodeHeader();this._nextIFD;)if(result.push(this.decodeIFD(options,!0)),options.onlyFirst)return[result[0]];return result}decodeHeader(){let value=this.readUint16();if(18761===value)this.setLittleEndian();else if(19789===value)this.setBigEndian();else throw Error(`invalid byte order: 0x${value.toString(16)}`);if(42!==this.readUint16())throw Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(options,tiff){let ifd;if(this.seek(this._nextIFD),tiff)ifd=new TiffIfd;else{if(!options.kind)throw Error("kind is missing");ifd=new IFD(options.kind)}let numEntries=this.readUint16();for(let i=0;i<numEntries;i++)this.decodeIFDEntry(ifd);if(!options.ignoreImageData){if(!(ifd instanceof TiffIfd))throw Error("must be a tiff ifd");this.decodeImageData(ifd)}return this._nextIFD=this.readUint32(),ifd}decodeIFDEntry(ifd){let offset=this.offset,tag=this.readUint16(),type=this.readUint16(),numValues=this.readUint32();if(type<1||type>12){this.skip(4);return}let valueByteLength=getByteLength(type,numValues);valueByteLength>4&&this.seek(this.readUint32());let value=readData(this,type,numValues);if(ifd.fields.set(tag,value),34665===tag||34853===tag){let currentOffset=this.offset,kind="exif";34665===tag?kind="exif":34853===tag&&(kind="gps"),this._nextIFD=value,ifd[kind]=this.decodeIFD({kind,ignoreImageData:!0},!1),this.offset=currentOffset}this.seek(offset),this.skip(12)}decodeImageData(ifd){let orientation=ifd.orientation;if(orientation&&1!==orientation)throw unsupported("orientation",orientation);switch(ifd.type){case 0:case 1:case 2:case 3:this.readStripData(ifd);break;default:throw unsupported("image type",ifd.type)}if(this.applyPredictor(ifd),this.convertAlpha(ifd),0===ifd.type){let bitDepth=ifd.bitsPerSample,maxValue=Math.pow(2,bitDepth)-1;for(let i=0;i<ifd.data.length;i++)ifd.data[i]=maxValue-ifd.data[i]}}readStripData(ifd){let width=ifd.width,height=ifd.height,bitDepth=ifd.bitsPerSample,sampleFormat=ifd.sampleFormat,size=width*height*ifd.samplesPerPixel,data=getDataArray(size,bitDepth,sampleFormat),rowsPerStrip=ifd.rowsPerStrip,maxPixels=rowsPerStrip*width*ifd.samplesPerPixel,stripOffsets=ifd.stripOffsets,stripByteCounts=ifd.stripByteCounts||guessStripByteCounts(ifd),remainingPixels=size,pixel=0;for(let i=0;i<stripOffsets.length;i++){let stripData=new DataView(this.buffer,this.byteOffset+stripOffsets[i],stripByteCounts[i]),length=remainingPixels>maxPixels?maxPixels:remainingPixels;remainingPixels-=length;let dataToFill=stripData;switch(ifd.compression){case 1:break;case 5:dataToFill=decompressLzw(stripData);break;case 8:dataToFill=decompressZlib(stripData);break;case 2:throw unsupported("Compression","CCITT Group 3");case 32773:throw unsupported("Compression","PackBits");default:throw unsupported("Compression",ifd.compression)}pixel=this.fillUncompressed(bitDepth,sampleFormat,data,dataToFill,pixel,length)}ifd.data=data}fillUncompressed(bitDepth,sampleFormat,data,stripData,pixel,length){if(8===bitDepth)return fill8bit(data,stripData,pixel,length);if(16===bitDepth)return fill16bit(data,stripData,pixel,length,this.isLittleEndian());if(32===bitDepth&&3===sampleFormat)return fillFloat32(data,stripData,pixel,length,this.isLittleEndian());throw unsupported("bitDepth",bitDepth)}applyPredictor(ifd){let bitDepth=ifd.bitsPerSample;switch(ifd.predictor){case 1:break;case 2:if(8===bitDepth)applyHorizontalDifferencing8Bit(ifd.data,ifd.width,ifd.components);else if(16===bitDepth)applyHorizontalDifferencing16Bit(ifd.data,ifd.width,ifd.components);else throw Error(`Horizontal differencing is only supported for images with a bit depth of ${bitDepth}`);break;default:throw Error(`invalid predictor: ${ifd.predictor}`)}}convertAlpha(ifd){if(ifd.alpha&&ifd.associatedAlpha){let{data,components,maxSampleValue}=ifd;for(let i=0;i<data.length;i+=components){let alphaValue=data[i+components-1];for(let j=0;j<components-1;j++)data[i+j]=Math.round(data[i+j]*maxSampleValue/alphaValue)}}}}function getDataArray(size,bitDepth,sampleFormat){if(8===bitDepth)return new Uint8Array(size);if(16===bitDepth)return new Uint16Array(size);if(32===bitDepth&&3===sampleFormat)return new Float32Array(size);throw unsupported("bit depth / sample format",`${bitDepth} / ${sampleFormat}`)}function fill8bit(dataTo,dataFrom,index,length){for(let i=0;i<length;i++)dataTo[index++]=dataFrom.getUint8(i);return index}function fill16bit(dataTo,dataFrom,index,length,littleEndian){for(let i=0;i<2*length;i+=2)dataTo[index++]=dataFrom.getUint16(i,littleEndian);return index}function fillFloat32(dataTo,dataFrom,index,length,littleEndian){for(let i=0;i<4*length;i+=4)dataTo[index++]=dataFrom.getFloat32(i,littleEndian);return index}function unsupported(type,value){return Error(`Unsupported ${type}: ${value}`)}function decodeTIFF(data,options){let decoder=new tiffDecoder_TIFFDecoder(data);return decoder.decode(options)}function matchAndCrop(options={}){let{algorithm="matchToPrevious",ignoreBorder=[0,0]}=options;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let matchToPrevious="matchToPrevious"===algorithm,parent=this[0],results=[];results[0]={position:[0,0],image:this[0]};let relativePosition=[0,0];for(let i=1;i<this.length;i++){let position=parent.getBestMatch(this[i],{border:ignoreBorder});results[i]={position:[position[0]+relativePosition[0],position[1]+relativePosition[1]],image:this[i]},matchToPrevious&&(relativePosition[0]+=position[0],relativePosition[1]+=position[1],parent=this[i])}let leftShift=0,rightShift=0,topShift=0,bottomShift=0;for(let i1=0;i1<results.length;i1++){let result=results[i1];result.position[0]>leftShift&&(leftShift=result.position[0]),result.position[0]<rightShift&&(rightShift=result.position[0]),result.position[1]>topShift&&(topShift=result.position[1]),result.position[1]<bottomShift&&(bottomShift=result.position[1])}rightShift=0-rightShift,bottomShift=0-bottomShift;for(let i2=0;i2<results.length;i2++){let result1=results[i2];result1.crop=result1.image.crop({x:leftShift-result1.position[0],y:topShift-result1.position[1],width:parent.width-rightShift-leftShift,height:parent.height-bottomShift-topShift})}let newImages=[];for(let i3=0;i3<results.length;i3++)newImages[i3]=results[i3].crop;return new Stack(newImages)}function min(){this.checkProcessable("min",{bitDepth:[8,16]});let min=this[0].min;for(let i=1;i<this.length;i++)for(let j=0;j<min.length;j++)min[j]=Math.min(min[j],this[i].min[j]);return min}function max(){this.checkProcessable("min",{bitDepth:[8,16]});let max=this[0].max;for(let i=1;i<this.length;i++)for(let j=0;j<max.length;j++)max[j]=Math.max(max[j],this[i].max[j]);return max}function histogram_median(histogram){let previous,total=histogram.reduce((sum,x)=>sum+x);if(0===total)throw Error("unreachable");let position=0,currentTotal=0,middle=total/2;for(;;){if(histogram[position]>0){if(void 0!==previous)return(previous+position)/2;if((currentTotal+=histogram[position])>middle)return position;currentTotal===middle&&(previous=position)}position++}}function mean(histogram){let total=0,sum=0;for(let i=0;i<histogram.length;i++)total+=histogram[i],sum+=histogram[i]*i;return 0===total?0:sum/total}function median_median(){this.checkProcessable("median",{bitDepth:[8,16]});let histograms=this.getHistograms({maxSlots:this[0].maxValue+1}),result=Array(histograms.length);for(let c=0;c<histograms.length;c++){let histogram=histograms[c];result[c]=histogram_median(histogram)}return result}function histogram(options){this.checkProcessable("min",{bitDepth:[8,16]});let histogram=this[0].getHistogram(options);for(let i=1;i<this.length;i++){let secondHistogram=this[i].getHistogram(options);for(let j=0;j<histogram.length;j++)histogram[j]+=secondHistogram[j]}return histogram}function histograms(options){this.checkProcessable("min",{bitDepth:[8,16]});let histograms=this[0].getHistograms(options),histogramLength=histograms[0].length;for(let i=1;i<this.length;i++){let secondHistograms=this[i].getHistograms(options);for(let c=0;c<histograms.length;c++)for(let j=0;j<histogramLength;j++)histograms[c][j]+=secondHistograms[c][j]}return histograms}function averageImage(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let data=new Uint32Array(this[0].data.length);for(let i=0;i<this.length;i++){let current=this[i];for(let j=0;j<this[0].data.length;j++)data[j]+=current.data[j]}let image=Image_Image.createFrom(this[0]),newData=image.data;for(let i1=0;i1<this[0].data.length;i1++)newData[i1]=data[i1]/this.length;return image}function maxImage(){this.checkProcessable("max",{bitDepth:[8,16]});let image=Image_Image.createFrom(this[0]);for(let current of(image.data.fill(0),this))for(let j=0;j<image.data.length;j++)image.data[j]=Math.max(current.data[j],image.data[j]);return image}function minImage(){this.checkProcessable("max",{bitDepth:[8,16]});let image=Image_Image.createFrom(this[0]);for(let current of(image.data.fill(image.maxValue),this))for(let j=0;j<image.data.length;j++)image.data[j]=Math.min(current.data[j],image.data[j]);return image}function extend(Stack){Stack.extendMethod("matchAndCrop",matchAndCrop),Stack.extendMethod("getMin",min),Stack.extendMethod("getMax",max),Stack.extendMethod("getMedian",median_median),Stack.extendMethod("getHistogram",histogram),Stack.extendMethod("getHistograms",histograms),Stack.extendMethod("getAverage",averageImage),Stack.extendMethod("getAverageImage",averageImage),Stack.extendMethod("getMaxImage",maxImage),Stack.extendMethod("getMinImage",minImage)}let Stack_computedPropertyDescriptor={configurable:!0,enumerable:!1,get:void 0};class Stack extends Array{constructor(images){if(Array.isArray(images)){super(images.length);for(let i=0;i<images.length;i++)this[i]=images[i]}else"number"==typeof images?super(images):super();this.computed=null}static load(urls){return Promise.all(urls.map(Image_Image.load)).then(images=>new Stack(images))}static extendMethod(name,method,options={}){let{inPlace=!1,returnThis=!0,partialArgs=[]}=options;return inPlace?Stack.prototype[name]=function(...args){this.computed=null;let result=method.apply(this,[...partialArgs,...args]);return returnThis?this:result}:Stack.prototype[name]=function(...args){return method.apply(this,[...partialArgs,...args])},Stack}static extendProperty(name,method,options={}){let{partialArgs=[]}=options;return Stack_computedPropertyDescriptor.get=function(){if(null===this.computed)this.computed={};else if(has_own_default()(name,this.computed))return this.computed[name];let result=method.apply(this,partialArgs);return this.computed[name]=result,result},Object.defineProperty(Stack.prototype,name,Stack_computedPropertyDescriptor),Stack}checkProcessable(processName,options={}){if("string"!=typeof processName)throw TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw TypeError(`The process: ${processName} can not be applied on an empty stack`);this[0].checkProcessable(processName,options);for(let i=1;i<this.length;i++){if((void 0===options.sameSize||options.sameSize)&&this[0].width!==this[i].width)throw TypeError(`The process: ${processName} can not be applied if width is not identical in all images`);if((void 0===options.sameSize||options.sameSize)&&this[0].height!==this[i].height)throw TypeError(`The process: ${processName} can not be applied if height is not identical in all images`);if((void 0===options.sameAlpha||options.sameAlpha)&&this[0].alpha!==this[i].alpha)throw TypeError(`The process: ${processName} can not be applied if alpha is not identical in all images`);if((void 0===options.sameBitDepth||options.sameBitDepth)&&this[0].bitDepth!==this[i].bitDepth)throw TypeError(`The process: ${processName} can not be applied if bitDepth is not identical in all images`);if((void 0===options.sameColorModel||options.sameColorModel)&&this[0].colorModel!==this[i].colorModel)throw TypeError(`The process: ${processName} can not be applied if colorModel is not identical in all images`);if((void 0===options.sameNumberChannels||options.sameNumberChannels)&&this[0].channels!==this[i].channels)throw TypeError(`The process: ${processName} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Stack.prototype.map=function(cb,thisArg){if("function"!=typeof cb)throw TypeError(`${cb} is not a function`);let newStack=new Stack(this.length);for(let i=0;i<this.length;i++)newStack[i]=cb.call(thisArg,this[i],i,this);return newStack}),extend(Stack);let isDataURL=/^data:[a-z]+\/(?:[a-z]+);base64,/;function load(image,options){if("string"==typeof image)return loadURL(image,options);if(image instanceof ArrayBuffer)return Promise.resolve(loadBinary(new Uint8Array(image),void 0,options&&options.ignorePalette));if(image.buffer)return Promise.resolve(loadBinary(image,void 0,options&&options.ignorePalette));throw Error('argument to "load" must be a string or buffer.')}function loadBinary(image,base64Url,ignorePalette){let type=image_type_default()(image);if(type)switch(type.mime){case"image/png":return loadPNG(image);case"image/jpeg":return loadJPEG(image);case"image/tiff":return loadTIFF(image,ignorePalette);default:return loadGeneric(getBase64(type.mime))}return loadGeneric(getBase64("application/octet-stream"));function getBase64(type){return base64Url||toBase64URL(image,type)}}function loadURL(url,options){let binaryDataP;let dataURL=url.slice(0,64).match(isDataURL);return(binaryDataP=null!==dataURL?Promise.resolve(decode(url.slice(dataURL[0].length))):fetchBinary(url,options)).then(binaryData=>{let uint8=new Uint8Array(binaryData);return loadBinary(uint8,dataURL?url:void 0,options&&options.ignorePalette)})}function loadPNG(data){let components;let png=decodePng(data),channels=png.channels,alpha=0;return(2===channels||4===channels?(components=channels-1,alpha=1):components=channels,png.palette)?loadPNGFromPalette(png):new Image_Image(png.width,png.height,png.data,{components,alpha,bitDepth:png.depth,meta:{text:png.text}})}function loadPNGFromPalette(png){let pixels=png.width*png.height,channels=png.palette[0].length,data=new Uint8Array(pixels*channels),pixelsPerByte=8/png.depth,factor=png.depth<8?pixelsPerByte:1,mask=parseInt("1".repeat(png.depth),2),hasAlpha=4===channels,dataIndex=0;for(let i=0;i<pixels;i++){let index=Math.floor(i/factor),value=png.data[index];png.depth<8&&(value=value>>>png.depth*(pixelsPerByte-1-i%pixelsPerByte)&mask);let paletteValue=png.palette[value];data[dataIndex++]=paletteValue[0],data[dataIndex++]=paletteValue[1],data[dataIndex++]=paletteValue[2],hasAlpha&&(data[dataIndex++]=paletteValue[3])}return new Image_Image(png.width,png.height,data,{components:3,alpha:hasAlpha,bitDepth:8})}function loadJPEG(data){let meta;let decodedExif=(0,fast_jpeg_src.decode)(data);decodedExif.exif&&(meta=getMetadata(decodedExif.exif));let jpeg=(0,jpeg_js.decode)(data,{useTArray:!0,maxMemoryUsageInMB:1024}),image=new Image_Image(jpeg.width,jpeg.height,jpeg.data,{meta});if(meta&&meta.tiff.tags.Orientation){let orientation=meta.tiff.tags.Orientation;orientation>2&&(image=image.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[orientation])),[2,4,5,7].includes(orientation)&&(image=image.flipX())}return image}function loadTIFF(data,ignorePalette){let result=decodeTIFF(data);return 1===result.length?getImageFromIFD(result[0],ignorePalette):new Stack(result.map(function(image){return getImageFromIFD(image,ignorePalette)}))}function getMetadata(image){let metadata={tiff:{fields:image.fields,tags:image.map}};return image.exif&&(metadata.exif=image.exif),image.gps&&(metadata.gps=image.gps),metadata}function getImageFromIFD(image,ignorePalette){if(ignorePalette||3!==image.type)return new Image_Image(image.width,image.height,image.data,{components:2===image.type?3:1,alpha:image.alpha,colorModel:2===image.type?RGB:GREY,bitDepth:image.bitsPerSample.length?image.bitsPerSample[0]:image.bitsPerSample,meta:getMetadata(image)});{let data=new Uint16Array(3*image.width*image.height),palette=image.palette,ptr=0;for(let i=0;i<image.data.length;i++){let index=image.data[i],color=palette[index];data[ptr++]=color[0],data[ptr++]=color[1],data[ptr++]=color[2]}return new Image_Image(image.width,image.height,data,{components:3,alpha:image.alpha,colorModel:RGB,bitDepth:16,meta:getMetadata(image)})}}function loadGeneric(url,options){return options=options||{},new Promise(function(resolve,reject){let image=new DOMImage;image.onload=function(){let w=image.width,h=image.height,ctx=createCanvas(w,h).getContext("2d");ctx.drawImage(image,0,0,w,h);let data=ctx.getImageData(0,0,w,h).data;resolve(new Image_Image(w,h,data,options))},image.onerror=function(){reject(Error(`Could not load ${url}`))},image.src=url})}let valueMethods={getValueXY(x,y,channel){return this.data[(y*this.width+x)*this.channels+channel]},setValueXY(x,y,channel,value){return this.data[(y*this.width+x)*this.channels+channel]=value,this.computed=null,this},getValue(index,channel){return this.data[index*this.channels+channel]},setValue(index,channel,value){return this.data[index*this.channels+channel]=value,this.computed=null,this},getPixelXY(x,y){return this.getPixel(y*this.width+x)},setPixelXY(x,y,value){return this.setPixel(y*this.width+x,value)},getPixel(index){let value=Array(this.channels),target=index*this.channels;for(let i=0;i<this.channels;i++)value[i]=this.data[target+i];return value},setPixel(index,value){let target=index*this.channels;for(let i=0;i<value.length;i++)this.data[target+i]=value[i];return this.computed=null,this}};function setValueMethods(Image){for(let i in valueMethods)Image.prototype[i]=valueMethods[i]}function getImageParameters(image){return{width:image.width,height:image.height,components:image.components,alpha:image.alpha,colorModel:image.colorModel,bitDepth:image.bitDepth}}function getOutputImage(thisImage,options,newParameters,internalOptions={}){let{out}=options;if(void 0===out)return internalOptions.copy?thisImage.clone():Image_Image.createFrom(thisImage,newParameters);{if(!Image_Image.isImage(out))throw TypeError("out must be an Image object");let requirements=Object.assign(getImageParameters(thisImage),newParameters);for(let property in requirements)if(out[property]!==requirements[property])throw RangeError(`cannot use out. Its ${property} must be "${requirements[property]}" (found "${out[property]}")`);return out}}function getOutputImageOrInPlace(thisImage,options,internalOptions){if(void 0!==options.inPlace&&"boolean"!=typeof options.inPlace)throw TypeError("inPlace option must be a boolean");if(options.inPlace){if(void 0!==options.out)throw TypeError("out option must not be set if inPlace option is true");return thisImage}return getOutputImage(thisImage,options,null,internalOptions)}function abs(options={}){this.checkProcessable("abs",{bitDepth:[32]});let out=getOutputImageOrInPlace(this,options);return absolute(this,out),out}function absolute(image,out){for(let i=0;i<image.data.length;i++)out.data[i]=Math.abs(image.data[i])}function copyAlphaChannel(from,to){if(1===from.alpha&&1===to.alpha)for(let i=0;i<from.size;i++)to.data[i*to.channels+to.components]=from.data[i*from.channels+from.components]}function invert(options={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});let out=getOutputImageOrInPlace(this,options);return 1===this.bitDepth?invertBinary(this,out):(invertColor(this,out),this!==out&&copyAlphaChannel(this,out)),out}function invertBinary(image,out){for(let i=0;i<image.data.length;i++)out.data[i]=~image.data[i]}function invertColor(image,out){for(let pixel=0;pixel<image.data.length;pixel+=image.channels)for(let c=0;c<image.components;c++)out.data[pixel+c]=image.maxValue-image.data[pixel+c]}function flipX(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let i=0;i<this.height;i++){let offsetY=i*this.width*this.channels;for(let j=0;j<Math.floor(this.width/2);j++){let posCurrent=j*this.channels+offsetY,posOpposite=(this.width-j-1)*this.channels+offsetY;for(let k=0;k<this.channels;k++){let tmp=this.data[posCurrent+k];this.data[posCurrent+k]=this.data[posOpposite+k],this.data[posOpposite+k]=tmp}}}return this}function flipY(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let i=0;i<Math.floor(this.height/2);i++)for(let j=0;j<this.width;j++){let posCurrent=j*this.channels+i*this.width*this.channels,posOpposite=j*this.channels+(this.height-1-i)*this.channels*this.width;for(let k=0;k<this.channels;k++){let tmp=this.data[posCurrent+k];this.data[posCurrent+k]=this.data[posOpposite+k],this.data[posOpposite+k]=tmp}}return this}function blurFilter(options={}){let{radius=1}=options;if(radius<1)throw Error("radius must be greater than 1");let n=2*radius+1,kernel=Array(n);for(let i=0;i<n;i++){kernel[i]=Array(n);for(let j=0;j<n;j++)kernel[i][j]=1/(n*n)}return this.convolution(kernel)}var median_quickselect_min=__webpack_require__(5520),median_quickselect_min_default=__webpack_require__.n(median_quickselect_min);function validateArrayOfChannels(image,options={}){let{channels,allowAlpha,defaultAlpha}=options;return("boolean"!=typeof allowAlpha&&(allowAlpha=!0),void 0===channels)?allChannels(image,defaultAlpha):validateChannels(image,channels,allowAlpha)}function allChannels(image,defaultAlpha){let length=defaultAlpha?image.channels:image.components,array=Array(length);for(let i=0;i<length;i++)array[i]=i;return array}function validateChannels(image,channels,allowAlpha){Array.isArray(channels)||(channels=[channels]);for(let c=0;c<channels.length;c++)channels[c]=validateChannel(image,channels[c],allowAlpha);return channels}function validateChannel(image,channel,allowAlpha=!0){if(void 0===channel)throw RangeError(`validateChannel : the channel has to be >=0 and <${image.channels}`);if("string"==typeof channel){switch(image.colorModel){case GREY:break;case RGB:if("rgb".includes(channel))switch(channel){case"r":channel=0;break;case"g":channel=1;break;case"b":channel=2}break;case HSL:if("hsl".includes(channel))switch(channel){case"h":channel=0;break;case"s":channel=1;break;case"l":channel=2}break;case HSV:if("hsv".includes(channel))switch(channel){case"h":channel=0;break;case"s":channel=1;break;case"v":channel=2}break;case CMYK:if("cmyk".includes(channel))switch(channel){case"c":channel=0;break;case"m":channel=1;break;case"y":channel=2;break;case"k":channel=3}break;default:throw Error(`Unexpected color model: ${image.colorModel}`)}if("a"===channel){if(!image.alpha)throw Error("validateChannel : the image does not contain alpha channel");channel=image.components}if("string"==typeof channel)throw Error(`validateChannel : undefined channel: ${channel}`)}if(channel>=image.channels)throw RangeError(`validateChannel : the channel has to be >=0 and <${image.channels}`);if(!allowAlpha&&channel>=image.components)throw RangeError("validateChannel : alpha channel may not be selected");return channel}function medianFilter(options={}){let{radius=1,border="copy",channels}=options;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),radius<1)throw Error("radius must be greater than 0");channels=validateArrayOfChannels(this,channels,!0);let kWidth=radius,kHeight=radius,newImage=Image_Image.createFrom(this),kernel=Array((2*kWidth+1)*(2*kHeight+1));for(let channel=0;channel<channels.length;channel++){let c=channels[channel];for(let y=kHeight;y<this.height-kHeight;y++)for(let x=kWidth;x<this.width-kWidth;x++){let n=0;for(let j=-kHeight;j<=kHeight;j++)for(let i=-kWidth;i<=kWidth;i++){let index=((y+j)*this.width+x+i)*this.channels+c;kernel[n++]=this.data[index]}let index1=(y*this.width+x)*this.channels+c;newImage.data[index1]=median_quickselect_min_default()(kernel)}}if(this.alpha&&!channels.includes(this.channels))for(let i1=this.components;i1<this.data.length;i1+=this.channels)newImage.data[i1]=this.data[i1];return newImage.setBorder({size:[kWidth,kHeight],algorithm:border}),newImage}function gaussianFilter(options={}){let{radius=1,sigma,channels,border="copy"}=options;this.checkProcessable("gaussian",{bitDepth:[8,16]});let kernel=getKernel(radius,sigma);return this.convolution([kernel,kernel],{border,channels,algorithm:"separable"})}function getKernel(radius,sigma){let n=2*radius+1,kernel=Array(n),sigmaX=sigma||((n-1)*.5-1)*.3+.8,scale2X=-.5/(sigmaX*sigmaX),sum=0;for(let i=0;i<n;i++){let x=i-radius,t=Math.exp(scale2X*x*x);kernel[i]=t,sum+=t}for(let i1=0;i1<n;i1++)kernel[i1]/=sum;return kernel}let SOBEL_X=[[-1,0,1],[-2,0,2],[-1,0,1]],SOBEL_Y=[[-1,-2,-1],[0,0,0],[1,2,1]],SCHARR_X=[[3,0,-3],[10,0,-10],[3,0,-3]],SCHARR_Y=[[3,10,3],[0,0,0],[-3,-10,-3]];var ml_matrix_convolution_src=__webpack_require__(414),is_integer=__webpack_require__(8336),is_integer_default=__webpack_require__.n(is_integer);function validateKernel(kernel){let kHeight,kWidth;if(Array.isArray(kernel)){if(Array.isArray(kernel[0])){if((1&kernel.length)==0||(1&kernel[0].length)==0)throw RangeError("validateKernel: Kernel rows and columns should be odd numbers");kHeight=Math.floor(kernel.length/2),kWidth=Math.floor(kernel[0].length/2)}else{let kernelWidth=Math.sqrt(kernel.length);if(is_integer_default()(kernelWidth))kWidth=kHeight=Math.floor(Math.sqrt(kernel.length)/2);else throw RangeError("validateKernel: Kernel array should be a square");let newKernel=Array(kernelWidth);for(let i=0;i<kernelWidth;i++){newKernel[i]=Array(kernelWidth);for(let j=0;j<kernelWidth;j++)newKernel[i][j]=kernel[i*kernelWidth+j]}kernel=newKernel}}else throw Error(`validateKernel: Invalid Kernel: ${kernel}`);return{kernel,kWidth,kHeight}}function clamp(value,image){return Math.round(Math.min(Math.max(value,0),image.maxValue))}function directConvolution(input,kernel,output){if(void 0===output){let length=input.length+kernel.length-1;output=Array(length)}fill(output);for(var i=0;i<input.length;i++)for(var j=0;j<kernel.length;j++)output[i+j]+=input[i]*kernel[j];return output}function fill(array){for(var i=0;i<array.length;i++)array[i]=0}function convolutionSeparable(data,separatedKernel,width,height){let tmp,conv,offset,kernel;let result=Array(data.length);offset=((kernel=separatedKernel[1]).length-1)/2,conv=Array(width+kernel.length-1),tmp=Array(width);for(let y=0;y<height;y++){for(let x=0;x<width;x++)tmp[x]=data[y*width+x];directConvolution(tmp,kernel,conv);for(let x1=0;x1<width;x1++)result[y*width+x1]=conv[offset+x1]}offset=((kernel=separatedKernel[0]).length-1)/2,conv=Array(height+kernel.length-1),tmp=Array(height);for(let x2=0;x2<width;x2++){for(let y1=0;y1<height;y1++)tmp[y1]=result[y1*width+x2];directConvolution(tmp,kernel,conv);for(let y2=0;y2<height;y2++)result[y2*width+x2]=conv[offset+y2]}return result}__webpack_require__(9645),__webpack_require__(995);var matrix=__webpack_require__(8406);matrix.AbstractMatrix,matrix.CHO,matrix.CholeskyDecomposition,matrix.DistanceMatrix,matrix.EVD,matrix.EigenvalueDecomposition,matrix.LU,matrix.LuDecomposition;let matrix_Matrix=matrix.Matrix;matrix.MatrixColumnSelectionView,matrix.MatrixColumnView,matrix.MatrixFlipColumnView,matrix.MatrixFlipRowView,matrix.MatrixRowSelectionView,matrix.MatrixRowView,matrix.MatrixSelectionView,matrix.MatrixSubView,matrix.MatrixTransposeView,matrix.NIPALS,matrix.Nipals,matrix.QR,matrix.QrDecomposition;let matrix_SVD=matrix.SVD,SingularValueDecomposition=matrix.SingularValueDecomposition;matrix.SymmetricMatrix,matrix.WrapperMatrix1D,matrix.WrapperMatrix2D,matrix.correlation,matrix.covariance,matrix.Matrix,matrix.Matrix,matrix.determinant;let inverse=matrix.inverse;matrix.linearDependencies,matrix.pseudoInverse;let solve=matrix.solve;function getSeparatedKernel(kernel){let svd=new matrix_SVD(kernel,{autoTranspose:!0});if(1!==svd.rank)return null;let s=Math.sqrt(svd.s[0]),v=svd.U.to2DArray().map(v=>v[0]*s),h=svd.V.to2DArray().map(h=>h[0]*s);return[v,h]}function convolution(kernel,options={}){let halfHeight,halfWidth,index,x,y,channel,c,tmpResult,{channels,bitDepth,normalize=!1,divisor=1,border="copy",algorithm="auto"}=options,createOptions={};bitDepth&&(createOptions.bitDepth=bitDepth);let newImage=Image_Image.createFrom(this,createOptions);if(channels=validateArrayOfChannels(this,channels,!0),"separable"!==algorithm)({kernel}=validateKernel(kernel));else if(!Array.isArray(kernel)||2!==kernel.length)throw RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===algorithm){let separatedKernel=getSeparatedKernel(kernel);null!==separatedKernel?(algorithm="separable",kernel=separatedKernel):algorithm=(kernel.length>9||kernel[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===algorithm?(halfHeight=Math.floor(kernel[0].length/2),halfWidth=Math.floor(kernel[1].length/2)):(halfHeight=Math.floor(kernel.length/2),halfWidth=Math.floor(kernel[0].length/2));let clamped=newImage.isClamped,tmpData=Array(this.height*this.width);for(channel=0;channel<channels.length;channel++){for(y=0,c=channels[channel];y<this.height;y++)for(x=0;x<this.width;x++)tmpData[index=y*this.width+x]=this.data[index*this.channels+c];if("direct"===algorithm)tmpResult=(0,ml_matrix_convolution_src.direct)(tmpData,kernel,{rows:this.height,cols:this.width,normalize:normalize,divisor:divisor});else if("separable"===algorithm){if(tmpResult=convolutionSeparable(tmpData,kernel,this.width,this.height),normalize){divisor=0;for(let i=0;i<kernel[0].length;i++)for(let j=0;j<kernel[1].length;j++)divisor+=kernel[0][i]*kernel[1][j]}if(1!==divisor)for(let i1=0;i1<tmpResult.length;i1++)tmpResult[i1]/=divisor}else tmpResult=(0,ml_matrix_convolution_src.fft)(tmpData,kernel,{rows:this.height,cols:this.width,normalize:normalize,divisor:divisor});for(y=0;y<this.height;y++)for(x=0;x<this.width;x++)index=y*this.width+x,clamped?newImage.data[index*this.channels+c]=clamp(tmpResult[index],newImage):newImage.data[index*this.channels+c]=tmpResult[index]}if(this.alpha&&!channels.includes(this.channels))for(x=this.components;x<this.data.length;x+=this.channels)newImage.data[x]=this.data[x];return"periodic"!==border&&newImage.setBorder({size:[halfWidth,halfHeight],algorithm:border}),newImage}function gradientFilter(options={}){let{direction="xy",border="copy",kernelX,kernelY,channels,bitDepth=this.bitDepth}=options;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),direction){case"x":if(!kernelX)throw Error("kernelX option is missing");return convolution.call(this,kernelX,{channels:channels,border:border,bitDepth});case"y":if(!kernelY)throw Error("kernelY option is missing");return convolution.call(this,kernelY,{channels:channels,border:border,bitDepth});case"xy":{if(!kernelX)throw Error("kernelX option is missing");if(!kernelY)throw Error("kernelY option is missing");let gX=convolution.call(this,kernelX,{channels:channels,border:border,bitDepth:32}),gY=convolution.call(this,kernelY,{channels:channels,border:border,bitDepth:32});return gX.hypotenuse(gY,{bitDepth,channels:channels})}default:throw Error(`Unknown parameter direction: ${direction}`)}}function sobelFilter(options){return gradientFilter.call(this,Object.assign({},options,{kernelX:SOBEL_X,kernelY:SOBEL_Y}))}function scharrFilter(options){return gradientFilter.call(this,Object.assign({},options,{kernelX:SCHARR_X,kernelY:SCHARR_Y}))}matrix.wrap;var new_array=__webpack_require__(2664),new_array_default=__webpack_require__.n(new_array);function level(options={}){let{algorithm="range",channels,min=this.min,max=this.max}=options;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),(channels=validateArrayOfChannels(this,{channels:channels})).length!==this.channel&&(Array.isArray(min)&&min.length===this.channels&&(min=min.filter((a,index)=>channels.includes(index))),Array.isArray(max)&&max.length===this.channels&&(max=max.filter((a,index)=>channels.includes(index)))),"range"===algorithm)min<0&&(min=0),max>this.maxValue&&(max=this.maxValue),Array.isArray(min)||(min=new_array_default()(channels.length,min)),Array.isArray(max)||(max=new_array_default()(channels.length,max)),processImage(this,min,max,channels);else throw Error(`level: algorithm not implement: ${algorithm}`);return this}function processImage(image,min,max,channels){let delta=1e-5,factor=Array(channels.length);for(let i=0;i<channels.length;i++)0===min[i]&&max[i]===image.maxValue?factor[i]=0:max[i]===min[i]?factor[i]=0:factor[i]=(image.maxValue+1-delta)/(max[i]-min[i]),min[i]+=(.5-delta/2)/factor[i];for(let j=0;j<channels.length;j++){let c=channels[j];if(0!==factor[j])for(let i1=0;i1<image.data.length;i1+=image.channels)image.data[i1+c]=Math.min(Math.max(0,(image.data[i1+c]-min[j])*factor[j]+.5|0),image.maxValue)}}var is_array_type=__webpack_require__(7811),is_array_type_default=__webpack_require__.n(is_array_type);function checkNumberArray(value){if(isNaN(value)){if(value instanceof Image_Image)return value.data;if(!is_array_type_default()(value))throw Error("checkNumberArray: the value should be either a number, array or Image");return value}if(value<=0)throw Error("checkNumberArray: the value must be greater than 0");return value}function add(value,options={}){let{channels}=options;if(this.checkProcessable("add",{bitDepth:[8,16]}),channels=validateArrayOfChannels(this,{channels:channels}),isNaN(value=checkNumberArray(value))){if(this.data.length!==value.length)throw Error("add: the data size is different");for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=0;i<this.data.length;i+=this.channels)this.data[i+c]=Math.max(0,Math.min(this.maxValue,this.data[i+c]+value[i+c]>>0))}}else for(let j1=0;j1<channels.length;j1++){let c1=channels[j1];for(let i1=0;i1<this.data.length;i1+=this.channels)this.data[i1+c1]=Math.min(this.maxValue,this.data[i1+c1]+value>>0)}return this}function subtract(value,options={}){let{channels}=options;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),channels=validateArrayOfChannels(this,{channels:channels}),isNaN(value=checkNumberArray(value))){if(this.data.length!==value.length)throw Error("subtract: the data size is different");for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=0;i<this.data.length;i+=this.channels)this.data[i+c]=Math.max(0,Math.min(this.maxValue,this.data[i+c]-value[i+c]>>0))}}else for(let j1=0;j1<channels.length;j1++){let c1=channels[j1];for(let i1=0;i1<this.data.length;i1+=this.channels)this.data[i1+c1]=Math.max(0,this.data[i1+c1]-value>>0)}return this}function subtractImage(otherImage,options={}){let{channels,absolute=!1}=options;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==otherImage.width||this.height!==otherImage.height)throw Error("subtractImage: both images must have the same size");if(this.alpha!==otherImage.alpha||this.bitDepth!==otherImage.bitDepth)throw Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==otherImage.channels)throw Error("subtractImage: both images must have the same number of channels");let newImage=this.clone();channels=validateArrayOfChannels(this,{channels:channels});for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=c;i<this.data.length;i+=this.channels){let value=this.data[i]-otherImage.data[i];absolute?newImage.data[i]=Math.abs(value):newImage.data[i]=Math.max(value,0)}}return newImage}function hypotenuse(otherImage,options={}){let{bitDepth=this.bitDepth,channels}=options;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==otherImage.width||this.height!==otherImage.height)throw Error("hypotenuse: both images must have the same size");if(this.alpha!==otherImage.alpha||this.bitDepth!==otherImage.bitDepth)throw Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==otherImage.channels)throw Error("hypotenuse: both images must have the same number of channels");let newImage=Image_Image.createFrom(this,{bitDepth:bitDepth});channels=validateArrayOfChannels(this,{channels:channels});let clamped=newImage.isClamped;for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=c;i<this.data.length;i+=this.channels){let value=Math.hypot(this.data[i],otherImage.data[i]);clamped?newImage.data[i]=Math.min(Math.max(Math.round(value),0),newImage.maxValue):newImage.data[i]=value}}return newImage}function multiply(value,options={}){let{channels}=options;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),value<=0)throw Error("multiply: the value must be greater than 0");if(channels=validateArrayOfChannels(this,{channels:channels}),isNaN(value=checkNumberArray(value))){if(this.data.length!==value.length)throw Error("multiply: the data size is different");for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=0;i<this.data.length;i+=this.channels)this.data[i+c]=Math.max(0,Math.min(this.maxValue,this.data[i+c]*value[i+c]>>0))}}else for(let j1=0;j1<channels.length;j1++){let c1=channels[j1];for(let i1=0;i1<this.data.length;i1+=this.channels)this.data[i1+c1]=Math.min(this.maxValue,this.data[i1+c1]*value>>0)}return this}function divide(value,options={}){let{channels}=options;if(this.checkProcessable("divide",{bitDepth:[8,16]}),channels=validateArrayOfChannels(this,{channels:channels}),isNaN(value=checkNumberArray(value))){if(this.data.length!==value.length)throw Error("divide: the: the data size is different");for(let j=0;j<channels.length;j++){let c=channels[j];for(let i=0;i<this.data.length;i+=this.channels)this.data[i+c]=Math.max(0,Math.min(this.maxValue,this.data[i+c]/value[i+c]>>0))}}else for(let j1=0;j1<channels.length;j1++){let c1=channels[j1];for(let i1=0;i1<this.data.length;i1+=this.channels)this.data[i1+c1]=Math.min(this.maxValue,this.data[i1+c1]/value>>0)}return this}var lib_esm=__webpack_require__(4091);class src_BaseRegression{constructor(){if(new.target===src_BaseRegression)throw Error("BaseRegression must be subclassed")}predict(x){if("number"==typeof x)return this._predict(x);if((0,lib_esm.isAnyArray)(x)){let y=[];for(let i=0;i<x.length;i++)y.push(this._predict(x[i]));return y}throw TypeError("x must be a number or array")}_predict(){throw Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(x,y){if(!(0,lib_esm.isAnyArray)(x)||!(0,lib_esm.isAnyArray)(y)||x.length!==y.length)throw Error("x and y must be arrays of the same length");let n=x.length,y2=Array(n);for(let i=0;i<n;i++)y2[i]=this._predict(x[i]);let xSum=0,ySum=0,chi2=0,rmsd=0,xSquared=0,ySquared=0,xY=0;for(let i1=0;i1<n;i1++)xSum+=y2[i1],ySum+=y[i1],xSquared+=y2[i1]*y2[i1],ySquared+=y[i1]*y[i1],xY+=y2[i1]*y[i1],0!==y[i1]&&(chi2+=(y[i1]-y2[i1])*(y[i1]-y2[i1])/y[i1]),rmsd+=(y[i1]-y2[i1])*(y[i1]-y2[i1]);let r=(n*xY-xSum*ySum)/Math.sqrt((n*xSquared-xSum*xSum)*(n*ySquared-ySum*ySum));return{r:r,r2:r*r,chi2:chi2,rmsd:Math.sqrt(rmsd/n)}}}var kernel=__webpack_require__(6952),kernel_default=__webpack_require__.n(kernel);let kernel_ridge_regression_defaultOptions={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class KernelRidgeRegression extends src_BaseRegression{constructor(inputs,outputs,options){if(super(),!0===inputs)this.alpha=outputs.alpha,this.inputs=outputs.inputs,this.kernelType=outputs.kernelType,this.kernelOptions=outputs.kernelOptions,this.kernel=new(kernel_default())(outputs.kernelType,outputs.kernelOptions);else{inputs=matrix_Matrix.checkMatrix(inputs),options=Object.assign({},kernel_ridge_regression_defaultOptions,options);let kernelFunction=new(kernel_default())(options.kernelType,options.kernelOptions),K=kernelFunction.compute(inputs),n=inputs.rows;K.add(matrix_Matrix.eye(n,n).mul(options.lambda)),this.alpha=solve(K,outputs),this.inputs=inputs,this.kernelType=options.kernelType,this.kernelOptions=options.kernelOptions,this.kernel=kernelFunction}}_predict(newInputs){return this.kernel.compute([newInputs],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(json){if("kernelRidgeRegression"!==json.name)throw TypeError("not a KRR model");return new KernelRidgeRegression(!0,json)}}function background(coordinates,values,options){let model=new KernelRidgeRegression(coordinates,values,options),allCoordinates=Array(this.size);for(let i=0;i<this.width;i++)for(let j=0;j<this.height;j++)allCoordinates[j*this.width+i]=[i,j];let result=model.predict(allCoordinates),background=Image_Image.createFrom(this);for(let i1=0;i1<this.size;i1++)background.data[i1]=Math.min(this.maxValue,Math.max(0,result[i1][0]));return background}function dilate(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("dilate: The number of rows and columns of the kernel must be odd");let onlyOnes=!0;outer:for(let row of kernel)for(let value of row)if(1!==value){onlyOnes=!1;break outer}let result=this;for(let i=0;i<iterations;i++)if(1===this.bitDepth){if(onlyOnes){let newImage=result.clone();result=dilateOnceBinaryOnlyOnes(result,newImage,kernel.length,kernel[0].length)}else{let newImage1=Image_Image.createFrom(result);result=dilateOnceBinary(result,newImage1,kernel)}}else if(onlyOnes){let newImage2=Image_Image.createFrom(result);result=dilateOnceGreyOnlyOnes(result,newImage2,kernel.length,kernel[0].length)}else{let newImage3=Image_Image.createFrom(result);result=dilateOnceGrey(result,newImage3,kernel)}return result}function dilateOnceGrey(img,newImage,kernel){let kernelWidth=kernel.length,kernelHeight=kernel[0].length,radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2;for(let y=0;y<img.height;y++)for(let x=0;x<img.width;x++){let max=0;for(let jj=0;jj<kernelHeight;jj++)for(let ii=0;ii<kernelWidth;ii++){if(1!==kernel[ii][jj])continue;let i=ii-radiusX+x,j=jj-radiusY+y;if(i<0||j<0||i>=img.width||j>=img.height)continue;let value=img.getValueXY(i,j,0);value>max&&(max=value)}newImage.setValueXY(x,y,0,max)}return newImage}function dilateOnceGreyOnlyOnes(img,newImage,kernelWidth,kernelHeight){let radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2,maxList=[];for(let x=0;x<img.width;x++)maxList.push(0);for(let y=0;y<img.height;y++){for(let x1=0;x1<img.width;x1++){let max=0;for(let h=Math.max(0,y-radiusY);h<Math.min(img.height,y+radiusY+1);h++){let value=img.getValueXY(x1,h,0);value>max&&(max=value)}maxList[x1]=max}for(let x2=0;x2<img.width;x2++){let max1=0;for(let i=Math.max(0,x2-radiusX);i<Math.min(img.width,x2+radiusX+1);i++)maxList[i]>max1&&(max1=maxList[i]);newImage.setValueXY(x2,y,0,max1)}}return newImage}function dilateOnceBinary(img,newImage,kernel){let kernelWidth=kernel.length,kernelHeight=kernel[0].length,radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2;for(let y=0;y<img.height;y++)for(let x=0;x<img.width;x++){let max=0;intLoop:for(let jj=0;jj<kernelHeight;jj++)for(let ii=0;ii<kernelWidth;ii++){if(1!==kernel[ii][jj])continue;let i=ii-radiusX+x,j=jj-radiusY+y;if(j<0||i<0||i>=img.width||j>=img.height)continue;let value=img.getBitXY(i,j);if(1===value){max=1;break intLoop}}1===max&&newImage.setBitXY(x,y)}return newImage}function dilateOnceBinaryOnlyOnes(img,newImage,kernelWidth,kernelHeight){let radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2,maxList=[];for(let x=0;x<img.width;x++)maxList.push(1);for(let y=0;y<img.height;y++){for(let x1=0;x1<img.width;x1++){maxList[x1]=0;for(let h=Math.max(0,y-radiusY);h<Math.min(img.height,y+radiusY+1);h++)if(1===img.getBitXY(x1,h)){maxList[x1]=1;break}}for(let x2=0;x2<img.width;x2++)if(1!==newImage.getBitXY(x2,y)){for(let i=Math.max(0,x2-radiusX);i<Math.min(img.width,x2+radiusX+1);i++)if(1===maxList[i]){newImage.setBitXY(x2,y);break}}}return newImage}function erode(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("erode: The number of rows and columns of the kernel must be odd");let onlyOnes=!0;outer:for(let row of kernel)for(let value of row)if(1!==value){onlyOnes=!1;break outer}let result=this;for(let i=0;i<iterations;i++)if(1===this.bitDepth){if(onlyOnes){let newImage=result.clone();result=erodeOnceBinaryOnlyOnes(result,newImage,kernel.length,kernel[0].length)}else{let newImage1=Image_Image.createFrom(result);result=erodeOnceBinary(result,newImage1,kernel)}}else if(onlyOnes){let newImage2=Image_Image.createFrom(result);result=erodeOnceGreyOnlyOnes(result,newImage2,kernel.length,kernel[0].length)}else{let newImage3=Image_Image.createFrom(result);result=erodeOnceGrey(result,newImage3,kernel)}return result}function erodeOnceGrey(img,newImage,kernel){let kernelWidth=kernel.length,kernelHeight=kernel[0].length,radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2;for(let y=0;y<img.height;y++)for(let x=0;x<img.width;x++){let min=img.maxValue;for(let jj=0;jj<kernelHeight;jj++)for(let ii=0;ii<kernelWidth;ii++){if(1!==kernel[ii][jj])continue;let i=ii-radiusX+x,j=jj-radiusY+y;if(i<0||j<0||i>=img.width||j>=img.height)continue;let value=img.getValueXY(i,j,0);value<min&&(min=value)}newImage.setValueXY(x,y,0,min)}return newImage}function erodeOnceGreyOnlyOnes(img,newImage,kernelWidth,kernelHeight){let radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2,minList=[];for(let x=0;x<img.width;x++)minList.push(0);for(let y=0;y<img.height;y++){for(let x1=0;x1<img.width;x1++){let min=img.maxValue;for(let h=Math.max(0,y-radiusY);h<Math.min(img.height,y+radiusY+1);h++){let value=img.getValueXY(x1,h,0);value<min&&(min=value)}minList[x1]=min}for(let x2=0;x2<img.width;x2++){let min1=img.maxValue;for(let i=Math.max(0,x2-radiusX);i<Math.min(img.width,x2+radiusX+1);i++)minList[i]<min1&&(min1=minList[i]);newImage.setValueXY(x2,y,0,min1)}}return newImage}function erodeOnceBinary(img,newImage,kernel){let kernelWidth=kernel.length,kernelHeight=kernel[0].length,radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2;for(let y=0;y<img.height;y++)for(let x=0;x<img.width;x++){let min=1;intLoop:for(let jj=0;jj<kernelHeight;jj++)for(let ii=0;ii<kernelWidth;ii++){if(1!==kernel[ii][jj])continue;let i=ii-radiusX+x,j=jj-radiusY+y;if(j<0||i<0||i>=img.width||j>=img.height)continue;let value=img.getBitXY(i,j);if(0===value){min=0;break intLoop}}1===min&&newImage.setBitXY(x,y)}return newImage}function erodeOnceBinaryOnlyOnes(img,newImage,kernelWidth,kernelHeight){let radiusX=(kernelWidth-1)/2,radiusY=(kernelHeight-1)/2,minList=[];for(let x=0;x<img.width;x++)minList.push(0);for(let y=0;y<img.height;y++){for(let x1=0;x1<img.width;x1++){minList[x1]=1;for(let h=Math.max(0,y-radiusY);h<Math.min(img.height,y+radiusY+1);h++)if(0===img.getBitXY(x1,h)){minList[x1]=0;break}}for(let x2=0;x2<img.width;x2++)if(0!==newImage.getBitXY(x2,y)){for(let i=Math.max(0,x2-radiusX);i<Math.min(img.width,x2+radiusX+1);i++)if(0===minList[i]){newImage.clearBitXY(x2,y);break}}}return newImage}function open_open(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("open: The number of rows and columns of the kernel must be odd");let newImage=this;for(let i=0;i<iterations;i++)newImage=(newImage=newImage.erode({kernel})).dilate({kernel});return newImage}function close_close(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("close: The number of rows and columns of the kernel must be odd");let newImage=this;for(let i=0;i<iterations;i++)newImage=newImage.dilate({kernel}).erode({kernel});return newImage}function topHat(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),kernel.length%2==0||kernel[0].length%2==0)throw TypeError("topHat: The number of rows and columns of the kernel must be odd");let newImage=this;for(let i=0;i<iterations;i++)newImage=newImage.open({kernel}).subtractImage(newImage,{absolute:!0});return newImage}function blackHat(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("blackHat: The number of rows and columns of the kernel must be odd");let newImage=this;for(let i=0;i<iterations;i++){let closeImage=newImage.close({kernel});newImage=closeImage.subtractImage(newImage,{absolute:!0})}return newImage}function morphologicalGradient(options={}){let{kernel=[[1,1,1],[1,1,1],[1,1,1]],iterations=1}=options;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),kernel.columns%2==0||kernel.rows%2==0)throw TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let newImage=this;for(let i=0;i<iterations;i++){let dilatedImage=newImage.dilate({kernel}),erodedImage=newImage.erode({kernel});newImage=dilatedImage.subtractImage(erodedImage,{absolute:!0})}return newImage}function order4Points(pts){let tl=0,tr=0,br=0,bl=0,minX=pts[0][0],indexMinX=0;for(let i=1;i<pts.length;i++)pts[i][0]<minX&&(minX=pts[i][0],indexMinX=i);let minX2=pts[(indexMinX+1)%pts.length][0],indexMinX2=(indexMinX+1)%pts.length;for(let i1=1;i1<pts.length;i1++)pts[i1][0]<minX2&&i1!==indexMinX&&(minX2=pts[i1][0],indexMinX2=i1);return pts[indexMinX2][1]<pts[indexMinX][1]?(tl=pts[indexMinX2],bl=pts[indexMinX],indexMinX!==(indexMinX2+1)%4?(tr=pts[(indexMinX2+1)%4],br=pts[(indexMinX2+2)%4]):(tr=pts[(indexMinX2+2)%4],br=pts[(indexMinX2+3)%4])):(bl=pts[indexMinX2],tl=pts[indexMinX],indexMinX2!==(indexMinX+1)%4?(tr=pts[(indexMinX+1)%4],br=pts[(indexMinX+2)%4]):(tr=pts[(indexMinX+2)%4],br=pts[(indexMinX+3)%4])),[tl,tr,br,bl]}function distance2Points(p1,p2){return Math.sqrt(Math.pow(p1[0]-p2[0],2)+Math.pow(p1[1]-p2[1],2))}function crossVect(u,v){return[u[1]*v[2]-u[2]*v[1],u[2]*v[0]-u[0]*v[2],u[0]*v[1]-u[1]*v[0]]}function dotVect(u,v){return u[0]*v[0]+u[1]*v[1]+u[2]*v[2]}function computeWidthAndHeigth(tl,tr,br,bl,widthImage,heightImage){let w=Math.max(distance2Points(tl,tr),distance2Points(bl,br)),h=Math.max(distance2Points(tl,bl),distance2Points(tr,br)),finalW=0,finalH=0,u0=Math.ceil(widthImage/2),v0=Math.ceil(heightImage/2),arVis=w/h,m1=[tl[0],tl[1],1],m2=[tr[0],tr[1],1],m3=[bl[0],bl[1],1],m4=[br[0],br[1],1],k2=dotVect(crossVect(m1,m4),m3)/dotVect(crossVect(m2,m4),m3),k3=dotVect(crossVect(m1,m4),m2)/dotVect(crossVect(m3,m4),m2),n2=[k2*m2[0]-m1[0],k2*m2[1]-m1[1],k2*m2[2]-m1[2]],n3=[k3*m3[0]-m1[0],k3*m3[1]-m1[1],k3*m3[2]-m1[2]],n21=n2[0],n22=n2[1],n23=n2[2],n31=n3[0],n32=n3[1],n33=n3[2],f=1/(n23*n33)*(n21*n31-(n21*n33+n23*n31)*u0+n23*n33*u0*u0+(n22*n32-(n22*n33+n23*n32)*v0+n23*n33*v0*v0));f=f>=0?Math.sqrt(f):Math.sqrt(-f);let A=new matrix_Matrix([[f,0,u0],[0,f,v0],[0,0,1]]),Ati=inverse(A.transpose()),Ai=inverse(A),n2R=matrix_Matrix.rowVector(n2),n3R=matrix_Matrix.rowVector(n3),arReal=Math.sqrt(dotVect(n2R.mmul(Ati).mmul(Ai).to1DArray(),n2)/dotVect(n3R.mmul(Ati).mmul(Ai).to1DArray(),n3));return 0===arReal||0===arVis?(finalW=Math.ceil(w),finalH=Math.ceil(h)):arReal<arVis?finalH=Math.ceil((finalW=Math.ceil(w))/arReal):finalW=Math.ceil(arReal*(finalH=Math.ceil(h))),[finalW,finalH]}function projectionPoint(x,y,a,b,c,d,e,f,g,h,image,channel){let[newX,newY]=[(a*x+b*y+c)/(g*x+h*y+1),(d*x+e*y+f)/(g*x+h*y+1)];return image.getValueXY(Math.floor(newX),Math.floor(newY),channel)}function warpingFourPoints(pts,options={}){let widthRect,heightRect,{calculateRatio=!0}=options;if(4!==pts.length)throw Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${pts.length} elements`);let[pt1,pt2,pt3,pt4]=pts,[tl,tr,br,bl]=order4Points([pt1,pt2,pt3,pt4]);calculateRatio?[widthRect,heightRect]=computeWidthAndHeigth(tl,tr,br,bl,this.width,this.height):(widthRect=Math.ceil(Math.max(distance2Points(tl,tr),distance2Points(bl,br))),heightRect=Math.ceil(Math.max(distance2Points(tl,bl),distance2Points(tr,br))));let newImage=Image_Image.createFrom(this,{width:widthRect,height:heightRect}),[X1,Y1]=tl,[X2,Y2]=tr,[X3,Y3]=br,[X4,Y4]=bl,[x1,y1]=[0,0],[x2,y2]=[0,widthRect-1],[x3,y3]=[heightRect-1,widthRect-1],[x4,y4]=[heightRect-1,0],S=new matrix_Matrix([[x1,y1,1,0,0,0,-x1*X1,-y1*X1],[x2,y2,1,0,0,0,-x2*X2,-y2*X2],[x3,y3,1,0,0,0,-x3*X3,-y1*X3],[x4,y4,1,0,0,0,-x4*X4,-y4*X4],[0,0,0,x1,y1,1,-x1*Y1,-y1*Y1],[0,0,0,x2,y2,1,-x2*Y2,-y2*Y2],[0,0,0,x3,y3,1,-x3*Y3,-y3*Y3],[0,0,0,x4,y4,1,-x4*Y4,-y4*Y4]]),D=matrix_Matrix.columnVector([X1,X2,X3,X4,Y1,Y2,Y3,Y4]),[a,b,c,d,e,f,g,h]=new SingularValueDecomposition(S).solve(D).to1DArray(),Xt=new matrix_Matrix(heightRect,widthRect);for(let channel=0;channel<this.channels;channel++){for(let i=0;i<heightRect;i++)for(let j=0;j<widthRect;j++)Xt.set(i,j,projectionPoint(i,j,a,b,c,d,e,f,g,h,this,channel));newImage.setMatrix(Xt,{channel:channel})}return newImage}function crop(options={}){let{x=0,y=0,width=this.width-x,height=this.height-y}=options;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),x>this.width-1||y>this.height-1)throw RangeError(`crop: origin (x:${x}, y:${y}) out of range (${this.width-1}; ${this.height-1})`);if(width<=0||height<=0)throw RangeError(`crop: width and height (width:${width}; height:${height}) must be positive numbers`);if(x<0||y<0)throw RangeError(`crop: x and y (x:${x}, y:${y}) must be positive numbers`);if(width>this.width-x||height>this.height-y)throw RangeError(`crop: (x: ${x}, y:${y}, width:${width}, height:${height}) size is out of range`);let result=this;if(1===this.bitDepth){let newImage=new Image_Image(width,height,{kind:"BINARY",parent:this});result=cropBinary(this,newImage,x,y,width,height)}else{let newImage1=Image_Image.createFrom(this,{width,height,position:[x,y]});result=cropDefault(this,newImage1,x,y,width,height)}return result}function cropDefault(img,newImage,x,y,width,height){let xWidth=width*img.channels,y1=y+height,ptr=0,jLeft=x*img.channels;for(let i=y;i<y1;i++){let j=i*img.width*img.channels+jLeft,jL=j+xWidth;for(;j<jL;j++)newImage.data[ptr++]=img.data[j]}return newImage}function cropBinary(img,newImage,x,y,width,height){let xWidth=width*img.channels,y1=y+height,ptr=0,jLeft=x*img.channels;for(let i=y;i<y1;i++){let j=i*img.width*img.channels+jLeft,jL=j+xWidth;for(;j<jL;j++)img.getBit(j)&&newImage.setBit(ptr),++ptr}return newImage}function cropAlpha(options={}){this.checkProcessable("cropAlpha",{alpha:1});let{threshold=this.maxValue}=options,left=findLeft(this,threshold,this.components);if(-1===left)throw Error("Could not find new dimensions. Threshold may be too high.");let top=findTop(this,threshold,this.components,left),bottom=findBottom(this,threshold,this.components,left),right=findRight(this,threshold,this.components,left,top,bottom);return this.crop({x:left,y:top,width:right-left+1,height:bottom-top+1})}function findLeft(image,threshold,channel){for(let x=0;x<image.width;x++)for(let y=0;y<image.height;y++)if(image.getValueXY(x,y,channel)>=threshold)return x;return -1}function findTop(image,threshold,channel,left){for(let y=0;y<image.height;y++)for(let x=left;x<image.width;x++)if(image.getValueXY(x,y,channel)>=threshold)return y;return -1}function findBottom(image,threshold,channel,left){for(let y=image.height-1;y>=0;y--)for(let x=left;x<image.width;x++)if(image.getValueXY(x,y,channel)>=threshold)return y;return -1}function findRight(image,threshold,channel,left,top,bottom){for(let x=image.width-1;x>=left;x--)for(let y=top;y<=bottom;y++)if(image.getValueXY(x,y,channel)>=threshold)return x;return -1}function getFactor(value){if("string"==typeof value){let last=value[value.length-1];value=parseFloat(value),"%"===last&&(value/=100)}return value}function getThreshold(value,maxValue){if(!maxValue)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof value){if("%"!==value[value.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(value)/100*maxValue}if("number"==typeof value)return value<1?value*maxValue:value;throw Error("getThreshold : the value is not valid")}function factorDimensions(factor,width,height){let newWidth=Math.round((factor=getFactor(factor))*width),newHeight=Math.round(factor*height);return newWidth<=0&&(newWidth=1),newHeight<=0&&(newHeight=1),{width:newWidth,height:newHeight}}function checkRow(image,row){if(row<0||row>=image.height)throw RangeError(`row must be included between 0 and ${image.height-1}. Current value: ${row}`)}function checkColumn(image,column){if(column<0||column>=image.width)throw RangeError(`column must be included between 0 and ${image.width-1}. Current value: ${column}`)}function checkChannel(image,channel){if(channel<0||channel>=image.channels)throw RangeError(`channel must be included between 0 and ${image.channels-1}. Current value: ${channel}`)}let validInterpolations={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function checkInterpolation(interpolation){if("string"!=typeof interpolation)throw TypeError("interpolation must be a string");if(!validInterpolations[interpolation=interpolation.toLowerCase()])throw RangeError(`invalid interpolation algorithm: ${interpolation}`);return validInterpolations[interpolation]}function nearestNeighbor(newImage,newWidth,newHeight){let wRatio=this.width/newWidth,hRatio=this.height/newHeight;if(this.bitDepth>1)for(let i=0;i<newWidth;i++){let w=Math.floor((i+.5)*wRatio);for(let j=0;j<newHeight;j++){let h=Math.floor((j+.5)*hRatio);for(let c=0;c<this.channels;c++)newImage.setValueXY(i,j,c,this.getValueXY(w,h,c))}}else for(let i1=0;i1<newWidth;i1++){let w1=Math.floor((i1+.5)*wRatio);for(let j1=0;j1<newHeight;j1++){let h1=Math.floor((j1+.5)*hRatio);this.getBitXY(w1,h1)&&newImage.setBitXY(i1,j1)}}}function resize(options={}){let{factor=1,interpolation=validInterpolations.nearestneighbor,preserveAspectRatio=!0}=options,interpolationToUse=checkInterpolation(interpolation),width=options.width,height=options.height;if(width||(width=height&&preserveAspectRatio?Math.round(height*(this.width/this.height)):this.width),height||(height=preserveAspectRatio?Math.round(width*(this.height/this.width)):this.height),{width,height}=factorDimensions(factor,width,height),width===this.width&&height===this.height){let newImage=this.clone();return newImage.position=[0,0],newImage}let shiftX=Math.round((this.width-width)/2),shiftY=Math.round((this.height-height)/2),newImage1=Image_Image.createFrom(this,{width,height,position:[shiftX,shiftY]});if(interpolationToUse===validInterpolations.nearestneighbor)nearestNeighbor.call(this,newImage1,width,height);else throw Error(`unsupported resize interpolation: ${interpolationToUse}`);return newImage1}function hsv(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB]});let newImage=Image_Image.createFrom(this,{colorModel:HSV}),ptr=0,data=this.data;for(let i=0;i<data.length;i+=this.channels){let red=data[i],green=data[i+1],blue=data[i+2],min=Math.min(red,green,blue),max=Math.max(red,green,blue),delta=max-min,hue=0,saturation=0===max?0:delta/max,value=max;if(max!==min){switch(max){case red:hue=(green-blue)/delta+(green<blue?6:0);break;case green:hue=(blue-red)/delta+2;break;case blue:hue=(red-green)/delta+4;break;default:throw Error("unreachable")}hue/=6}newImage.data[ptr++]=hue*this.maxValue,newImage.data[ptr++]=saturation*this.maxValue,newImage.data[ptr++]=value,this.alpha&&(newImage.data[ptr++]=data[i+3])}return newImage}function hsl(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB]});let newImage=Image_Image.createFrom(this,{colorModel:HSL}),threshold=Math.floor(this.maxValue/2),ptr=0,data=this.data;for(let i=0;i<data.length;i+=this.channels){let red=data[i],green=data[i+1],blue=data[i+2],max=Math.max(red,green,blue),min=Math.min(red,green,blue),hue=0,saturation=0,luminance=(max+min)/2;if(max!==min){let delta=max-min;switch(saturation=luminance>threshold?delta/(2-max-min):delta/(max+min),max){case red:hue=(green-blue)/delta+(green<blue?6:0);break;case green:hue=(blue-red)/delta+2;break;case blue:hue=(red-green)/delta+4;break;default:throw Error("unreachable")}hue/=6}newImage.data[ptr++]=hue*this.maxValue,newImage.data[ptr++]=saturation*this.maxValue,newImage.data[ptr++]=luminance,this.alpha&&(newImage.data[ptr++]=data[i+3])}return newImage}function cmyk(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB]});let newImage=Image_Image.createFrom(this,{components:4,colorModel:CMYK}),ptr=0,data=this.data;for(let i=0;i<data.length;i+=this.channels){let red=data[i],green=data[i+1],blue=data[i+2],black=Math.min(this.maxValue-red,this.maxValue-green,this.maxValue-blue),cyan=(this.maxValue-red-black)/(1-black/this.maxValue),magenta=(this.maxValue-green-black)/(1-black/this.maxValue),yellow=(this.maxValue-blue-black)/(1-black/this.maxValue);newImage.data[ptr++]=Math.round(cyan),newImage.data[ptr++]=Math.round(magenta),newImage.data[ptr++]=Math.round(yellow),newImage.data[ptr++]=Math.round(black),this.alpha&&(newImage.data[ptr++]=data[i+3])}return newImage}function rgba8(){return new Image_Image(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}let methods={luma709:(red,green,blue)=>6966*red+23436*green+2366*blue>>15,luma601:(red,green,blue)=>9798*red+19235*green+3735*blue>>15,maximum:(red,green,blue)=>Math.max(red,green,blue),minimum:(red,green,blue)=>Math.min(red,green,blue),average:(red,green,blue)=>(red+green+blue)/3>>0,minmax:(red,green,blue)=>(Math.max(red,green,blue)+Math.min(red,green,blue))/2,red:red=>red,green:(red,green)=>green,blue:(red,green,blue)=>blue,cyan(red,green,blue,image){let black=methods.black(red,green,blue,image);return(image.maxValue-red-black)/(1-black/image.maxValue)>>0},magenta(red,green,blue,image){let black=methods.black(red,green,blue,image);return(image.maxValue-green-black)/(1-black/image.maxValue)>>0},yellow(red,green,blue,image){let black=methods.black(red,green,blue,image);return(image.maxValue-blue-black)/(1-black/image.maxValue)>>0},black:(red,green,blue,image)=>Math.min(image.maxValue-red,image.maxValue-green,image.maxValue-blue),hue(red,green,blue,image){let min=methods.min(red,green,blue),max=methods.max(red,green,blue);if(max===min)return 0;let hue=0,delta=max-min;switch(max){case red:hue=(green-blue)/delta+(green<blue?6:0);break;case green:hue=(blue-red)/delta+2;break;case blue:hue=(red-green)/delta+4;break;default:throw Error("unreachable")}return hue/6*image.maxValue>>0},saturation(red,green,blue,image){let min=methods.min(red,green,blue),max=methods.max(red,green,blue),delta=max-min;return 0===max?0:delta/max*image.maxValue},lightness(red,green,blue){let min=methods.min(red,green,blue);return(methods.max(red,green,blue)+min)/2}};Object.defineProperty(methods,"luminosity",{enumerable:!1,value:methods.lightness}),Object.defineProperty(methods,"luminance",{enumerable:!1,value:methods.lightness}),Object.defineProperty(methods,"min",{enumerable:!1,value:methods.minimum}),Object.defineProperty(methods,"max",{enumerable:!1,value:methods.maximum}),Object.defineProperty(methods,"brightness",{enumerable:!1,value:methods.maximum});let names={};function grey(options={}){let method,{algorithm="luma709",keepAlpha=!1,mergeAlpha=!0}=options;if("string"!=typeof algorithm&&"function"!=typeof algorithm)throw TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(algorithm="red"),keepAlpha&=this.alpha,mergeAlpha&=this.alpha,keepAlpha&&(mergeAlpha=!1);let newImage=getOutputImage(this,options,{components:1,alpha:keepAlpha,colorModel:GREY});if("function"==typeof algorithm)method=algorithm;else if(!(method=methods[algorithm.toLowerCase()]))throw Error(`unsupported grey algorithm: ${algorithm}`);let ptr=0;for(let i=0;i<this.data.length;i+=this.channels)mergeAlpha?newImage.data[ptr++]=clamp(method(this.data[i],this.data[i+1],this.data[i+2],this)*this.data[i+this.components]/this.maxValue,this):(newImage.data[ptr++]=clamp(method(this.data[i],this.data[i+1],this.data[i+2],this),this),newImage.alpha&&(newImage.data[ptr++]=this.data[i+this.components]));return newImage}function huang(histogram){let firstBin=0;for(let ih=0;ih<histogram.length;ih++)if(0!==histogram[ih]){firstBin=ih;break}let lastBin=histogram.length-1;for(let ih1=histogram.length-1;ih1>=firstBin;ih1--)if(0!==histogram[ih1]){lastBin=ih1;break}let term=1/(lastBin-firstBin),mu0=Array(histogram.length),sumPix=0,numPix=0;for(let ih2=firstBin;ih2<histogram.length;ih2++)sumPix+=ih2*histogram[ih2],numPix+=histogram[ih2],mu0[ih2]=sumPix/numPix;let mu1=Array(histogram.length);sumPix=numPix=0;for(let ih3=lastBin;ih3>0;ih3--)sumPix+=ih3*histogram[ih3],numPix+=histogram[ih3],mu1[ih3-1]=sumPix/numPix;let threshold=-1,minEnt=Number.MAX_VALUE;for(let it=0;it<histogram.length;it++){let muX,ent=0;for(let ih4=0;ih4<=it;ih4++)(muX=1/(1+term*Math.abs(ih4-mu0[it])))<1e-6||muX>.999999||(ent+=histogram[ih4]*(-muX*Math.log(muX)-(1-muX)*Math.log(1-muX)));for(let ih5=it+1;ih5<histogram.length;ih5++)(muX=1/(1+term*Math.abs(ih5-mu1[it])))<1e-6||muX>.999999||(ent+=histogram[ih5]*(-muX*Math.log(muX)-(1-muX)*Math.log(1-muX)));ent<minEnt&&(minEnt=ent,threshold=it)}return threshold}function intermodes(histogram){let iHisto=histogram.slice(),iter=0;for(;!bimodalTest(iHisto);){let previous=0,current=0,next=iHisto[0];for(let i=0;i<histogram.length-1;i++)previous=current,current=next,next=iHisto[i+1],iHisto[i]=(previous+current+next)/3;if(iHisto[histogram.length-1]=(current+next)/3,++iter>1e4)throw Error("Intermodes Threshold not found after 10000 iterations")}let tt=0;for(let i1=1;i1<histogram.length-1;i1++)iHisto[i1-1]<iHisto[i1]&&iHisto[i1+1]<iHisto[i1]&&(tt+=i1);return Math.floor(tt/2)}function bimodalTest(iHisto){let b=!1,modes=0;for(let k=1;k<iHisto.length-1;k++)if(iHisto[k-1]<iHisto[k]&&iHisto[k+1]<iHisto[k]&&++modes>2)return!1;return 2===modes&&(b=!0),b}function isodata(histogram){let l,toth,totl,h;let g=0;for(let i=1;i<histogram.length;i++)if(histogram[i]>0){g=i+1;break}for(;;){l=0,totl=0;for(let i1=0;i1<g;i1++)totl+=histogram[i1],l+=histogram[i1]*i1;h=0,toth=0;for(let i2=g+1;i2<histogram.length;i2++)toth+=histogram[i2],h+=histogram[i2]*i2;if(totl>0&&toth>0&&g===Math.round(((l/=totl)+(h/=toth))/2))break;if(++g>histogram.length-2)throw Error("Threshold not found")}return g}function li(histogram,total){let threshold,sumBack,sumObj,numBack,numObj,oldThresh,newThresh,meanBack,meanObj,mean,tolerance,temp;tolerance=.5,mean=0;for(let ih=0;ih<histogram.length;ih++)mean+=ih*histogram[ih];mean/=total,newThresh=mean;do{threshold=(oldThresh=newThresh)+.5|0,sumBack=0,numBack=0;for(let ih1=0;ih1<=threshold;ih1++)sumBack+=ih1*histogram[ih1],numBack+=histogram[ih1];meanBack=0===numBack?0:sumBack/numBack,sumObj=0,numObj=0;for(let ih2=threshold+1;ih2<histogram.length;ih2++)sumObj+=ih2*histogram[ih2],numObj+=histogram[ih2];newThresh=(temp=(meanBack-(meanObj=0===numObj?0:sumObj/numObj))/(Math.log(meanBack)-Math.log(meanObj)))<-Number.EPSILON?temp-.5|0:temp+.5|0}while(Math.abs(newThresh-oldThresh)>tolerance);return threshold}function maxEntropy(histogram,total){let totEnt,entBack,entObj,normHisto=Array(histogram.length);for(let ih=0;ih<histogram.length;ih++)normHisto[ih]=histogram[ih]/total;let P1=Array(histogram.length),P2=Array(histogram.length);P1[0]=normHisto[0],P2[0]=1-P1[0];for(let ih1=1;ih1<histogram.length;ih1++)P1[ih1]=P1[ih1-1]+normHisto[ih1],P2[ih1]=1-P1[ih1];let firstBin=0;for(let ih2=0;ih2<histogram.length;ih2++)if(Math.abs(P1[ih2])>=Number.EPSILON){firstBin=ih2;break}let lastBin=histogram.length-1;for(let ih3=histogram.length-1;ih3>=firstBin;ih3--)if(Math.abs(P2[ih3])>=Number.EPSILON){lastBin=ih3;break}let threshold=-1,maxEnt=Number.MIN_VALUE;for(let it=firstBin;it<=lastBin;it++){entBack=0;for(let ih4=0;ih4<=it;ih4++)0!==histogram[ih4]&&(entBack-=normHisto[ih4]/P1[it]*Math.log(normHisto[ih4]/P1[it]));entObj=0;for(let ih5=it+1;ih5<histogram.length;ih5++)0!==histogram[ih5]&&(entObj-=normHisto[ih5]/P2[it]*Math.log(normHisto[ih5]/P2[it]));maxEnt<(totEnt=entBack+entObj)&&(maxEnt=totEnt,threshold=it)}return threshold}function mean_mean(histogram,total){let sum=0;for(let i=0;i<histogram.length;i++)sum+=i*histogram[i];return Math.floor(sum/total)}function minError(histogram,total){let threshold,mu,nu,p,q,sigma2,tau2,w0,w1,sqterm,temp;let Tprev=-2,mean=0;for(let ih=0;ih<histogram.length;ih++)mean+=ih*histogram[ih];for(mean/=total,threshold=mean;threshold!==Tprev;){let sumA1=sumA(histogram,threshold),sumA2=sumA(histogram,histogram.length-1),sumB1=sumB(histogram,threshold),sumB2=sumB(histogram,histogram.length-1),sumC1=sumC(histogram,threshold),sumC2=sumC(histogram,histogram.length-1);if(mu=sumB1/sumA1,nu=(sumB2-sumB1)/(sumA2-sumA1),p=sumA1/sumA2,q=(sumA2-sumA1)/sumA2,w0=1/(sigma2=sumC1/sumA1-mu*mu)-1/(tau2=(sumC2-sumC1)/(sumA2-sumA1)-nu*nu),(sqterm=(w1=mu/sigma2-nu/tau2)*w1-w0*(mu*mu/sigma2-nu*nu/tau2+Math.log10(sigma2*(q*q)/(tau2*(p*p)))))<0)break;Tprev=threshold,threshold=isNaN(temp=(w1+Math.sqrt(sqterm))/w0)?Tprev:Math.floor(temp)}return threshold}function sumA(y,j){let x=0;for(let i=0;i<=j;i++)x+=y[i];return x}function sumB(y,j){let x=0;for(let i=0;i<=j;i++)x+=i*y[i];return x}function sumC(y,j){let x=0;for(let i=0;i<=j;i++)x+=i*i*y[i];return x}function minimum(histogram){if(histogram.length<2)return 0;let iterations=0,threshold=-1,max=-1,histogramCopy=Array(histogram.length);for(let i=0;i<histogram.length;i++)histogramCopy[i]=histogram[i],histogram[i]>0&&(max=i);for(;!minimum_bimodalTest(histogramCopy);)if(histogramCopy=smoothed(histogramCopy),++iterations>1e4)return threshold;return minimumBetweenPeeks(histogramCopy,max)}function smoothed(histogram){let auHistogram=Array(histogram.length);for(let i=1;i<histogram.length-1;i++)auHistogram[i]=(histogram[i-1]+histogram[i]+histogram[i+1])/3;return auHistogram[0]=(histogram[0]+histogram[1])/3,auHistogram[histogram.length-1]=(histogram[histogram.length-2]+histogram[histogram.length-1])/3,auHistogram}function minimumBetweenPeeks(histogramBimodal,max){let threshold;for(let i=1;i<max;i++)if(histogramBimodal[i-1]>histogramBimodal[i]&&histogramBimodal[i+1]>=histogramBimodal[i]){threshold=i;break}return threshold}function minimum_bimodalTest(histogram){let len=histogram.length,isBimodal=!1,peaks=0;for(let k=1;k<len-1;k++)if(histogram[k-1]<histogram[k]&&histogram[k+1]<histogram[k]&&++peaks>2)return!1;return 2===peaks&&(isBimodal=!0),isBimodal}function moments(histogram,total){let p0,cd,c0,c1,z0,z1,m0=1,m1=0,m2=0,m3=0,sum=0,threshold=-1,histogramLength=histogram.length,normalizedHistogram=Array(histogramLength);for(let i=0;i<histogramLength;i++)normalizedHistogram[i]=histogram[i]/total;for(let i1=0;i1<histogramLength;i1++)m1+=i1*normalizedHistogram[i1],m2+=i1*i1*normalizedHistogram[i1],m3+=i1*i1*i1*normalizedHistogram[i1];cd=m0*m2-m1*m1,c0=(-m2*m2+m1*m3)/cd,z0=.5*(-(c1=(-(m0*m3)+m2*m1)/cd)-Math.sqrt(c1*c1-4*c0)),p0=((z1=.5*(-c1+Math.sqrt(c1*c1-4*c0)))-m1)/(z1-z0);for(let i2=0;i2<histogramLength;i2++)if((sum+=normalizedHistogram[i2])>p0){threshold=i2;break}return threshold}function otsu(histogramCounts,total){let sumB=0,wB=0,maximum=0,level=0,sum1=0;for(let i=0;i<histogramCounts.length;i++)sum1+=i*histogramCounts[i];for(let ii=0;ii<histogramCounts.length;ii++){wB+=histogramCounts[ii];let wF=total-wB;if(0===wB||0===wF)continue;sumB+=ii*histogramCounts[ii];let mF=(sum1-sumB)/wF,between=wB*wF*(sumB/wB-mF)*(sumB/wB-mF);between>=maximum&&(level=ii,maximum=between)}return level}function percentile(histogram){let threshold=-1,percentile=.5,avec=Array(histogram.length),total=partialSum(histogram,histogram.length-1),temp=1;for(let i=0;i<histogram.length;i++)avec[i]=Math.abs(partialSum(histogram,i)/total-percentile),avec[i]<temp&&(temp=avec[i],threshold=i);return threshold}function partialSum(histogram,endIndex){let x=0;for(let i=0;i<=endIndex;i++)x+=histogram[i];return x}function renyiEntropy(histogram,total){let firstBin,lastBin,betas;let normHisto=Array(histogram.length),P1=Array(histogram.length),P2=Array(histogram.length),threshold1=0,threshold2=0,threshold3=0,maxEnt1=0,maxEnt2=0,maxEnt3=0,term2=2,term3=-1;for(let ih=0;ih<histogram.length;ih++)normHisto[ih]=histogram[ih]/total;P1[0]=normHisto[0],P2[0]=1-P1[0];for(let ih1=1;ih1<histogram.length;ih1++)P1[ih1]=P1[ih1-1]+normHisto[ih1],P2[ih1]=1-P1[ih1];firstBin=0;for(let ih2=0;ih2<histogram.length;ih2++)if(Math.abs(P1[ih2])>=Number.EPSILON){firstBin=ih2;break}lastBin=histogram.length-1;for(let ih3=histogram.length-1;ih3>=firstBin;ih3--)if(Math.abs(P2[ih3])>=Number.EPSILON){lastBin=ih3;break}for(let it=firstBin;it<=lastBin;it++){let entBack1=0,entBack2=0,entBack3=0;for(let ih4=0;ih4<=it;ih4++)0!==histogram[ih4]&&(entBack1-=normHisto[ih4]/P1[it]*Math.log(normHisto[ih4]/P1[it])),entBack2+=Math.sqrt(normHisto[ih4]/P1[it]),entBack3+=normHisto[ih4]*normHisto[ih4]/(P1[it]*P1[it]);let entObj1=0,entObj2=0,entObj3=0;for(let ih5=it+1;ih5<histogram.length;ih5++)0!==histogram[ih5]&&(entObj1-=normHisto[ih5]/P2[it]*Math.log(normHisto[ih5]/P2[it])),entObj2+=Math.sqrt(normHisto[ih5]/P2[it]),entObj3+=normHisto[ih5]*normHisto[ih5]/(P2[it]*P2[it]);let totEnt1=entBack1+entObj1,totEnt2=term2*(entBack2*entObj2>0?Math.log(entBack2*entObj2):0),totEnt3=term3*(entBack3*entObj3>0?Math.log(entBack3*entObj3):0);totEnt1>maxEnt1&&(maxEnt1=totEnt1,threshold1=it),totEnt2>maxEnt2&&(maxEnt2=totEnt2,threshold2=it),totEnt3>maxEnt3&&(maxEnt3=totEnt3,threshold3=it)}let tStars=[threshold1,threshold2,threshold3];tStars.sort((a,b)=>a-b),betas=5>=Math.abs(tStars[0]-tStars[1])?5>=Math.abs(tStars[1]-tStars[2])?[1,2,1]:[0,1,3]:5>=Math.abs(tStars[1]-tStars[2])?[3,1,0]:[1,2,1];let omega=P1[tStars[2]]-P1[tStars[0]];return Math.round(tStars[0]*(P1[tStars[0]]+.25*omega*betas[0])+.25*tStars[1]*omega*betas[1]+tStars[2]*(P2[tStars[2]]+.25*omega*betas[2]))}function shanbhag(histogram,total){let term,totEnt,entBack,entObj,normHisto=Array(histogram.length);for(let ih=0;ih<histogram.length;ih++)normHisto[ih]=histogram[ih]/total;let P1=Array(histogram.length),P2=Array(histogram.length);P1[0]=normHisto[0],P2[0]=1-P1[0];for(let ih1=1;ih1<histogram.length;ih1++)P1[ih1]=P1[ih1-1]+normHisto[ih1],P2[ih1]=1-P1[ih1];let firstBin=0;for(let ih2=0;ih2<histogram.length;ih2++)if(Math.abs(P1[ih2])>=Number.EPSILON){firstBin=ih2;break}let lastBin=histogram.length-1;for(let ih3=histogram.length-1;ih3>=firstBin;ih3--)if(Math.abs(P2[ih3])>=Number.EPSILON){lastBin=ih3;break}let threshold=-1,minEnt=Number.MAX_VALUE;for(let it=firstBin;it<=lastBin;it++){entBack=0,term=.5/P1[it];for(let ih4=1;ih4<=it;ih4++)entBack-=normHisto[ih4]*Math.log(1-term*P1[ih4-1]);entBack*=term,entObj=0,term=.5/P2[it];for(let ih5=it+1;ih5<histogram.length;ih5++)entObj-=normHisto[ih5]*Math.log(1-term*P2[ih5]);entObj*=term,(totEnt=Math.abs(entBack-entObj))<minEnt&&(minEnt=totEnt,threshold=it)}return threshold}function triangle(histogram){let nx,ny,d,min=0,dmax=0,max=0,min2=0;for(let i=0;i<histogram.length;i++)if(histogram[i]>0){min=i;break}min>0&&min--;for(let i1=histogram.length-1;i1>0;i1--)if(histogram[i1]>0){min2=i1;break}min2<histogram.length-1&&min2++;for(let i2=0;i2<histogram.length;i2++)histogram[i2]>dmax&&(max=i2,dmax=histogram[i2]);let inverted=!1;if(max-min<min2-max){inverted=!0;let left=0,right=histogram.length-1;for(;left<right;){let temp=histogram[left];histogram[left]=histogram[right],histogram[right]=temp,left++,right--}min=histogram.length-1-min2,max=histogram.length-1-max}if(min===max)return min;d=Math.sqrt((nx=histogram[max])*nx+(ny=min-max)*ny),nx/=d,ny/=d,d=nx*min+ny*histogram[min];let split=min,splitDistance=0;for(let i3=min+1;i3<=max;i3++){let newDistance=nx*i3+ny*histogram[i3]-d;newDistance>splitDistance&&(split=i3,splitDistance=newDistance)}if(split--,!inverted)return split;{let left1=0,right1=histogram.length-1;for(;left1<right1;){let temp1=histogram[left1];histogram[left1]=histogram[right1],histogram[right1]=temp1,left1++,right1--}return histogram.length-1-split}}function yen(histogram,total){let crit,normHisto=Array(histogram.length);for(let ih=0;ih<histogram.length;ih++)normHisto[ih]=histogram[ih]/total;let P1=Array(histogram.length);P1[0]=normHisto[0];for(let ih1=1;ih1<histogram.length;ih1++)P1[ih1]=P1[ih1-1]+normHisto[ih1];let P1Sq=Array(histogram.length);P1Sq[0]=normHisto[0]*normHisto[0];for(let ih2=1;ih2<histogram.length;ih2++)P1Sq[ih2]=P1Sq[ih2-1]+normHisto[ih2]*normHisto[ih2];let P2Sq=Array(histogram.length);P2Sq[histogram.length-1]=0;for(let ih3=histogram.length-2;ih3>=0;ih3--)P2Sq[ih3]=P2Sq[ih3+1]+normHisto[ih3+1]*normHisto[ih3+1];let threshold=-1,maxCrit=Number.MIN_VALUE;for(let it=0;it<histogram.length;it++)(crit=-1*(P1Sq[it]*P2Sq[it]>0?Math.log(P1Sq[it]*P2Sq[it]):0)+2*(P1[it]*(1-P1[it])>0?Math.log(P1[it]*(1-P1[it])):0))>maxCrit&&(maxCrit=crit,threshold=it);return threshold}Object.keys(methods).forEach(name=>{names[name]=name});let thresholdAlgorithms_methods={huang:huang,intermodes:intermodes,isodata:isodata,li:li,maxentropy:maxEntropy,mean:mean_mean,minerror:minError,minimum:minimum,moments:moments,otsu:otsu,percentile:percentile,renyientropy:renyiEntropy,shanbhag:shanbhag,triangle:triangle,yen:yen},thresholdAlgorithms_names={};function getThreshold_getThreshold(options={}){let{algorithm=thresholdAlgorithms_names.otsu}=options;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let method=thresholdAlgorithms_methods[algorithm.toLowerCase()];if(method)return method(this.getHistogram(),this.size);throw Error(`unknown thresholding algorithm: ${algorithm}`)}Object.keys(thresholdAlgorithms_methods).forEach(name=>{thresholdAlgorithms_names[name]=name});let THRESHOLD="threshold";function mask(options={}){let{algorithm=THRESHOLD,threshold=.5,useAlpha=!0,invert=!1}=options;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),threshold=algorithm===THRESHOLD?getThreshold(threshold,this.maxValue):getThreshold_getThreshold.call(this,options);let newImage=new Image_Image(this.width,this.height,{kind:"BINARY",parent:this}),ptr=0;if(this.alpha&&useAlpha)for(let i=0;i<this.data.length;i+=this.channels){let value=this.data[i]+(this.maxValue-this.data[i])*(this.maxValue-this.data[i+1])/this.maxValue;(invert&&value<=threshold||!invert&&value>=threshold)&&newImage.setBit(ptr),ptr++}else for(let i1=0;i1<this.data.length;i1+=this.channels)(invert&&this.data[i1]<=threshold||!invert&&this.data[i1]>=threshold)&&newImage.setBit(ptr),ptr++;return newImage}function copyImage(fromImage,toImage,x,y){let fromWidth=fromImage.width,fromHeight=fromImage.height,toWidth=toImage.width,channels=fromImage.channels;for(let i=0;i<fromWidth;i++)for(let j=0;j<fromHeight;j++)for(let k=0;k<channels;k++){let source=(j*fromWidth+i)*channels+k,target=((y+j)*toWidth+x+i)*channels+k;toImage.data[target]=fromImage.data[source]}}function pad(options={}){let{size=0,algorithm="copy",color}=options;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===algorithm){if(color.length!==this.channels)throw Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let i=0;i<color.length;i++)0===color[i]&&(color[i]=.001)}else color=new_array_default()(this.channels,null);Array.isArray(size)||(size=[size,size]);let newWidth=this.width+2*size[0],newHeight=this.height+2*size[1],channels=this.channels,newImage=Image_Image.createFrom(this,{width:newWidth,height:newHeight});copyImage(this,newImage,size[0],size[1]);for(let i1=size[0];i1<newWidth-size[0];i1++)for(let k=0;k<channels;k++){let value=color[k]||newImage.data[(size[1]*newWidth+i1)*channels+k];for(let j=0;j<size[1];j++)newImage.data[(j*newWidth+i1)*channels+k]=value;value=color[k]||newImage.data[((newHeight-size[1]-1)*newWidth+i1)*channels+k];for(let j1=newHeight-size[1];j1<newHeight;j1++)newImage.data[(j1*newWidth+i1)*channels+k]=value}for(let j2=0;j2<newHeight;j2++)for(let k1=0;k1<channels;k1++){let value1=color[k1]||newImage.data[(j2*newWidth+size[0])*channels+k1];for(let i2=0;i2<size[0];i2++)newImage.data[(j2*newWidth+i2)*channels+k1]=value1;value1=color[k1]||newImage.data[(j2*newWidth+newWidth-size[0]-1)*channels+k1];for(let i3=newWidth-size[0];i3<newWidth;i3++)newImage.data[(j2*newWidth+i3)*channels+k1]=value1}return newImage}function colorDepth(newColorDepth=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(newColorDepth))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===newColorDepth)return this.clone();let newImage=Image_Image.createFrom(this,{bitDepth:newColorDepth});switch(newColorDepth){case 8:if(1===this.bitDepth)for(let i=0;i<this.size;i++)this.getBit(i)&&(newImage.data[i]=255);else for(let i1=0;i1<this.data.length;i1++)newImage.data[i1]=this.data[i1]>>8;break;case 16:if(1===this.bitDepth)for(let i2=0;i2<this.size;i2++)this.getBit(i2)&&(newImage.data[i2]=65535);else for(let i3=0;i3<this.data.length;i3++)newImage.data[i3]=this.data[i3]<<8|this.data[i3];break;default:throw Error("colorDepth conversion unexpected case")}return newImage}function rotateFree(degrees,options={}){let{interpolation=validInterpolations.nearestneighbor,width=this.width,height=this.height}=options;if("number"!=typeof degrees)throw TypeError("degrees must be a number");let interpolationToUse=checkInterpolation(interpolation),radians=degrees*Math.PI/180,newWidth=Math.floor(Math.abs(width*Math.cos(radians))+Math.abs(height*Math.sin(radians))),newHeight=Math.floor(Math.abs(height*Math.cos(radians))+Math.abs(width*Math.sin(radians))),cos=Math.cos(-radians),sin=Math.sin(-radians),x0=newWidth/2,y0=newHeight/2;newWidth%2==0?(x0-=.5,newHeight%2==0?y0-=.5:y0=Math.floor(y0)):(x0=Math.floor(x0),newHeight%2==0?y0-=.5:y0=Math.floor(y0));let incrementX=Math.floor(width/2-x0),incrementY=Math.floor(height/2-y0);if(1===this.bitDepth){let newImage=new Image_Image(newWidth,newHeight,{kind:"BINARY",parent:this});switch(interpolationToUse){case validInterpolations.nearestneighbor:return rotateBinaryNearestNeighbor(this,newImage,incrementX,incrementY,x0,y0,cos,sin);case validInterpolations.bilinear:return rotateBinaryBilinear(this,newImage,incrementX,incrementY,x0,y0,cos,sin);default:throw Error(`unsupported rotate interpolation: ${interpolationToUse}`)}}else{let newImage1=Image_Image.createFrom(this,{width:newWidth,height:newHeight});switch(interpolationToUse){case validInterpolations.nearestneighbor:return rotateNearestNeighbor(this,newImage1,incrementX,incrementY,x0,y0,cos,sin);case validInterpolations.bilinear:return rotateBilinear(this,newImage1,incrementX,incrementY,x0,y0,cos,sin);default:throw Error(`unsupported rotate interpolation: ${interpolationToUse}`)}}}function rotateNearestNeighbor(thisImage,newImage,incrementX,incrementY,x0,y0,cos,sin){for(let i=0;i<newImage.width;i+=1)for(let j=0;j<newImage.height;j+=1)for(let c=0;c<thisImage.channels;c++){let x=Math.round((i-x0)*cos-(j-y0)*sin+x0)+incrementX,y=Math.round((j-y0)*cos+(i-x0)*sin+y0)+incrementY;x<0||x>=thisImage.width||y<0||y>=thisImage.height?1===thisImage.alpha&&c===thisImage.channels-1?newImage.setValueXY(i,j,c,0):newImage.setValueXY(i,j,c,thisImage.maxValue):newImage.setValueXY(i,j,c,thisImage.getValueXY(x,y,c))}return newImage}function rotateBinaryNearestNeighbor(thisImage,newImage,incrementX,incrementY,x0,y0,cos,sin){for(let i=0;i<newImage.width;i+=1)for(let j=0;j<newImage.height;j+=1){let x=Math.round((i-x0)*cos-(j-y0)*sin+x0)+incrementX,y=Math.round((j-y0)*cos+(i-x0)*sin+y0)+incrementY;(x<0||x>=thisImage.width||y<0||y>=thisImage.height||thisImage.getBitXY(x,y))&&newImage.setBitXY(i,j)}return newImage}function rotateBilinear(thisImage,newImage,incrementX,incrementY,x0,y0,cos,sin){let stride=thisImage.width*thisImage.channels;for(let j=0;j<newImage.height;j++)for(let i=0;i<newImage.width;i++){let x=(i-x0)*cos-(j-y0)*sin+x0+incrementX,y=(j-y0)*cos+(i-x0)*sin+y0+incrementY,x1=0|x,y1=0|y,xDiff=x-x1,yDiff=y-y1;for(let c=0;c<thisImage.channels;c++)if(x<0||x>=thisImage.width||y<0||y>=thisImage.height)1===thisImage.alpha&&c===thisImage.channels-1?newImage.setValueXY(i,j,c,0):newImage.setValueXY(i,j,c,thisImage.maxValue);else{let index=(y1*thisImage.width+x1)*thisImage.channels+c,A=thisImage.data[index],B=thisImage.data[index+thisImage.channels],C=thisImage.data[index+stride],result=A+xDiff*(B-A)+yDiff*(C-A)+xDiff*yDiff*(A-B-C+thisImage.data[index+stride+thisImage.channels])|0;newImage.setValueXY(i,j,c,result)}}return newImage}function rotateBinaryBilinear(thisImage,newImage,incrementX,incrementY,x0,y0,cos,sin){let stride=thisImage.width;for(let j=0;j<newImage.height;j++)for(let i=0;i<newImage.width;i++){let x=(i-x0)*cos-(j-y0)*sin+x0+incrementX,y=(j-y0)*cos+(i-x0)*sin+y0+incrementY,x1=0|x,y1=0|y,xDiff=x-x1,yDiff=y-y1;if(x<0||x>=thisImage.width||y<0||y>=thisImage.height)newImage.setBitXY(i,j);else{let index=y1*thisImage.width+x1,A=thisImage.getBit(index),B=thisImage.getBit(index+1),C=thisImage.getBit(index+stride);(A|xDiff&B-A|yDiff&C-A|xDiff&yDiff&A-B-C+thisImage.getBit(index+1+stride))>0&&newImage.setBitXY(i,j)}}return newImage}function rotate(angle,options){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof angle)throw TypeError("angle must be a number");switch(angle<0&&(angle=360*Math.ceil(-angle/360)+angle),angle%360){case 0:return this.clone();case 90:return rotateRight.call(this);case 180:return rotate180.call(this);case 270:return rotateLeft.call(this);default:return rotateFree.call(this,angle,options)}}function rotateLeft(){if(1===this.bitDepth){let newImage=new Image_Image(this.height,this.width,{kind:"BINARY",parent:this}),newMaxHeight=newImage.height-1;for(let i=0;i<this.height;i++)for(let j=0;j<this.width;j++)this.getBitXY(j,i)&&newImage.setBitXY(i,newMaxHeight-j);return newImage}{let newImage1=Image_Image.createFrom(this,{width:this.height,height:this.width}),newMaxHeight1=newImage1.height-1;for(let i1=0;i1<this.height;i1++)for(let j1=0;j1<this.width;j1++)for(let k=0;k<this.channels;k++)newImage1.setValueXY(i1,newMaxHeight1-j1,k,this.getValueXY(j1,i1,k));return newImage1}}function rotateRight(){if(1===this.bitDepth){let newImage=new Image_Image(this.height,this.width,{kind:"BINARY",parent:this}),newMaxWidth=newImage.width-1;for(let i=0;i<this.height;i++)for(let j=0;j<this.width;j++)this.getBitXY(j,i)&&newImage.setBitXY(newMaxWidth-i,j);return newImage}{let newImage1=Image_Image.createFrom(this,{width:this.height,height:this.width}),newMaxWidth1=newImage1.width-1;for(let i1=0;i1<this.height;i1++)for(let j1=0;j1<this.width;j1++)for(let k=0;k<this.channels;k++)newImage1.setValueXY(newMaxWidth1-i1,j1,k,this.getValueXY(j1,i1,k));return newImage1}}function rotate180(){if(1===this.bitDepth){let newImage=new Image_Image(this.width,this.height,{kind:"BINARY",parent:this}),newMaxWidth=newImage.width-1,newMaxHeight=newImage.height-1;for(let i=0;i<this.height;i++)for(let j=0;j<this.width;j++)this.getBitXY(j,i)&&newImage.setBitXY(newMaxWidth-j,newMaxHeight-i);return newImage}{let newImage1=Image_Image.createFrom(this),newMaxWidth1=newImage1.width-1,newMaxHeight1=newImage1.height-1;for(let i1=0;i1<this.height;i1++)for(let j1=0;j1<this.width;j1++)for(let k=0;k<this.channels;k++)newImage1.setValueXY(newMaxWidth1-j1,newMaxHeight1-i1,k,this.getValueXY(j1,i1,k));return newImage1}}function insert(toInsert,options={}){let parameters=getImageParameters(toInsert);this.checkProcessable("insert",parameters);let{x=0,y=0}=options,out=getOutputImageOrInPlace(this,options,{copy:!0}),maxY=Math.min(out.height,y+toInsert.height),maxX=Math.min(out.width,x+toInsert.width);if(1===out.bitDepth)for(let j=y;j<maxY;j++)for(let i=x;i<maxX;i++){let val=toInsert.getBitXY(i-x,j-y);val?out.setBitXY(i,j):out.clearBitXY(i,j)}else for(let j1=y;j1<maxY;j1++)for(let i1=x;i1<maxX;i1++)out.setPixelXY(i1,j1,toInsert.getPixelXY(i1-x,j1-y));return out}function setBorder(options={}){let{size=0,algorithm="copy",color}=options;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===algorithm){if(color.length!==this.channels)throw Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let i=0;i<color.length;i++)0===color[i]&&(color[i]=.001)}else color=new_array_default()(this.channels,null);Array.isArray(size)||(size=[size,size]);let leftRightSize=size[0],topBottomSize=size[1],channels=this.channels;for(let i1=leftRightSize;i1<this.width-leftRightSize;i1++)for(let k=0;k<channels;k++){let value=color[k]||this.data[(i1+this.width*topBottomSize)*channels+k];for(let j=0;j<topBottomSize;j++)this.data[(j*this.width+i1)*channels+k]=value;value=color[k]||this.data[(i1+this.width*(this.height-topBottomSize-1))*channels+k];for(let j1=this.height-topBottomSize;j1<this.height;j1++)this.data[(j1*this.width+i1)*channels+k]=value}for(let j2=0;j2<this.height;j2++)for(let k1=0;k1<channels;k1++){let value1=color[k1]||this.data[(j2*this.width+leftRightSize)*channels+k1];for(let i2=0;i2<leftRightSize;i2++)this.data[(j2*this.width+i2)*channels+k1]=value1;value1=color[k1]||this.data[(j2*this.width+this.width-leftRightSize-1)*channels+k1];for(let i3=this.width-leftRightSize;i3<this.width;i3++)this.data[(j2*this.width+i3)*channels+k1]=value1}return this}function split(options={}){let{preserveAlpha=!0}=options;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new Stack([this.clone()]);let images=new Stack,data=this.data;if(this.alpha&&preserveAlpha)for(let i=0;i<this.components;i++){let newImage=Image_Image.createFrom(this,{components:1,alpha:!0,colorModel:GREY}),ptr=0;for(let j=0;j<data.length;j+=this.channels)newImage.data[ptr++]=data[j+i],newImage.data[ptr++]=data[j+this.components];images.push(newImage)}else for(let i1=0;i1<this.channels;i1++){let newImage1=Image_Image.createFrom(this,{components:1,alpha:!1,colorModel:GREY}),ptr1=0;for(let j1=0;j1<data.length;j1+=this.channels)newImage1.data[ptr1++]=data[j1+i1];images.push(newImage1)}return images}function getChannel(channel,options={}){let{keepAlpha=!1,mergeAlpha=!1}=options;keepAlpha&=this.alpha,mergeAlpha&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),channel=validateChannel(this,channel);let newImage=Image_Image.createFrom(this,{components:1,alpha:keepAlpha,colorModel:GREY}),ptr=0;for(let j=0;j<this.data.length;j+=this.channels)mergeAlpha?newImage.data[ptr++]=this.data[j+channel]*this.data[j+this.components]/this.maxValue:(newImage.data[ptr++]=this.data[j+channel],keepAlpha&&(newImage.data[ptr++]=this.data[j+this.components]));return newImage}function combineChannels(method=defaultCombineMethod,options={}){let{mergeAlpha=!1,keepAlpha=!1}=options;mergeAlpha&=this.alpha,keepAlpha&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let newImage=Image_Image.createFrom(this,{components:1,alpha:keepAlpha,colorModel:GREY}),ptr=0;for(let i=0;i<this.size;i++){let value=method(this.getPixel(i));mergeAlpha?newImage.data[ptr++]=value*this.data[i*this.channels+this.components]/this.maxValue:(newImage.data[ptr++]=value,keepAlpha&&(newImage.data[ptr++]=this.data[i*this.channels+this.components]))}return newImage}function defaultCombineMethod(pixel){return(pixel[0]+pixel[1]+pixel[2])/3}function setChannel(channel,image){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),image.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),image.width!==this.width||image.height!==this.height)throw Error("Images must have exactly the same width and height");let ptr=channel=validateChannel(this,channel);for(let i=0;i<image.data.length;i++)this.data[ptr]=image.data[i],ptr+=this.channels;return this}function getSimilarity(image,options={}){let{shift=[0,0],average,channels,defaultAlpha,normalize,border=[0,0]}=options;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(border)||(border=[border,border]),channels=validateArrayOfChannels(this,{channels:channels,defaultAlpha:defaultAlpha}),this.bitDepth!==image.bitDepth)throw Error("Both images must have the same bitDepth");if(this.channels!==image.channels)throw Error("Both images must have the same number of channels");if(this.colorModel!==image.colorModel)throw Error("Both images must have the same colorModel");void 0===average&&(average=!0);let minX=Math.max(border[0],-shift[0]),maxX=Math.min(this.width-border[0],this.width-shift[0]),minY=Math.max(border[1],-shift[1]),maxY=Math.min(this.height-border[1],this.height-shift[1]),results=new_array_default()(channels.length,0);for(let i=0;i<channels.length;i++){let c=channels[i],sumThis=normalize?this.sum[c]:Math.max(this.sum[c],image.sum[c]),sumImage=normalize?image.sum[c]:Math.max(this.sum[c],image.sum[c]);if(0!==sumThis&&0!==sumImage)for(let x=minX;x<maxX;x++)for(let y=minY;y<maxY;y++){let indexThis=x*this.multiplierX+y*this.multiplierY+c,indexImage=indexThis+shift[0]*this.multiplierX+shift[1]*this.multiplierY;results[i]+=Math.min(this.data[indexThis]/sumThis,image.data[indexImage]/sumImage)}}return average?results.reduce((sum,x)=>sum+x)/results.length:results}function getPixelsGrid(options={}){let{sampling=[10,10],painted=!1,mask}=options;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(sampling)||(sampling=[sampling,sampling]);let xSampling=sampling[0],ySampling=sampling[1],xyS=[],zS=[],xStep=this.width/xSampling,yStep=this.height/ySampling,currentX=Math.floor(xStep/2);for(let i=0;i<xSampling;i++){let currentY=Math.floor(yStep/2);for(let j=0;j<ySampling;j++){let x=Math.round(currentX),y=Math.round(currentY);(!mask||mask.getBitXY(x,y))&&(xyS.push([x,y]),zS.push(this.getPixelXY(x,y))),currentY+=yStep}currentX+=xStep}let toReturn={xyS,zS};return painted&&(toReturn.painted=this.rgba8().paintPoints(xyS)),toReturn}function util_matrix_Matrix(width,height,defaultValue){let matrix=Array(width);for(let x=0;x<width;x++)matrix[x]=Array(height);if(defaultValue)for(let x1=0;x1<width;x1++)for(let y=0;y<height;y++)matrix[x1][y]=defaultValue;return matrix.width=width,matrix.height=height,Object.setPrototypeOf(matrix,util_matrix_Matrix.prototype),matrix}function getBestMatch(image,options={}){let{border}=options;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==image.bitDepth)throw Error("Both images must have the same bitDepth");if(this.channels!==image.channels)throw Error("Both images must have the same number of channels");if(this.colorModel!==image.colorModel)throw Error("Both images must have the same colorModel");let similarityMatrix=new util_matrix_Matrix(image.width,image.height,-1/0),currentX=Math.floor(image.width/2),currentY=Math.floor(image.height/2),middleX=currentX,middleY=currentY,theEnd=!1;for(;!theEnd;){let toCalculatePositions=similarityMatrix.localSearch(currentX,currentY,-1/0);for(let i=0;i<toCalculatePositions.length;i++){let position=toCalculatePositions[i],similarity=this.getSimilarity(image,{border:border,shift:[middleX-position[0],middleY-position[1]]});similarityMatrix[position[0]][position[1]]=similarity}let max=similarityMatrix.localMax(currentX,currentY);max.position[0]!==currentX||max.position[1]!==currentY?(currentX=max.position[0],currentY=max.position[1]):theEnd=!0}return[currentX-middleX,currentY-middleY]}function getRow(row,channel=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),checkRow(this,row),checkChannel(this,channel);let array=Array(this.width),ptr=0,begin=row*this.width*this.channels+channel,end=begin+this.width*this.channels;for(let j=begin;j<end;j+=this.channels)array[ptr++]=this.data[j];return array}function getColumn(column,channel=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),checkColumn(this,column),checkChannel(this,channel);let array=Array(this.height),ptr=0,step=this.width*this.channels;for(let j=channel+column*this.channels;j<this.data.length;j+=step)array[ptr++]=this.data[j];return array}function getMatrix(options={}){let{channel}=options;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===channel){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");channel=0}let matrix=new matrix_Matrix(this.height,this.width);for(let x=0;x<this.height;x++)for(let y=0;y<this.width;y++)matrix.set(x,y,this.getValueXY(y,x,channel));return matrix}function setMatrix(matrix,options={}){matrix=new matrix_Matrix(matrix);let{channel}=options;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===channel){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");channel=0}if(this.width!==matrix.columns||this.height!==matrix.rows)throw RangeError("The size of the matrix must be equal to the size of the image");for(let x=0;x<this.height;x++)for(let y=0;y<this.width;y++)this.setValueXY(y,x,channel,matrix.get(x,y));return this}function getPixelsArray(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let array=Array(this.size),ptr=0;for(let i=0;i<this.data.length;i+=this.channels){let pixel=Array(this.components);for(let j=0;j<this.components;j++)pixel[j]=this.data[i+j];array[ptr++]=pixel}return array}function getIntersection(mask2){let mask1=this,closestParent=mask1.getClosestCommonParent(mask2),startPos1=mask1.getRelativePosition(closestParent,{defaultFurther:!0}),allRelPos1=getRelativePositionForAllPixels(mask1,startPos1),startPos2=mask2.getRelativePosition(closestParent,{defaultFurther:!0}),allRelPos2=getRelativePositionForAllPixels(mask2,startPos2),commonSurface=getCommonSurface(allRelPos1,allRelPos2),intersection={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let i=0;i<commonSurface.length;i++){let currentRelativePos=commonSurface[i],realPos1=[currentRelativePos[0]-startPos1[0],currentRelativePos[1]-startPos1[1]],realPos2=[currentRelativePos[0]-startPos2[0],currentRelativePos[1]-startPos2[1]],valueBitMask1=mask1.getBitXY(realPos1[0],realPos1[1]),valueBitMask2=mask2.getBitXY(realPos2[0],realPos2[1]);1===valueBitMask1&&1===valueBitMask2&&intersection.commonWhitePixels.push(currentRelativePos)}for(let i1=0;i1<allRelPos1.length;i1++){let posX,posY;0!==i1&&(posX=Math.floor(i1/mask1.width),posY=i1%mask1.width),1===mask1.getBitXY(posX,posY)&&intersection.whitePixelsMask1.push(allRelPos1[i1])}for(let i2=0;i2<allRelPos2.length;i2++){let posX1=0,posY1=0;0!==i2&&(posX1=Math.floor(i2/mask2.width),posY1=i2%mask2.width),1===mask2.getBitXY(posX1,posY1)&&intersection.whitePixelsMask2.push(allRelPos2[i2])}return intersection}function getRelativePositionForAllPixels(mask,startPosition){let relativePositions=[];for(let i=0;i<mask.height;i++)for(let j=0;j<mask.width;j++){let originalPos=[i,j];relativePositions.push([originalPos[0]+startPosition[0],originalPos[1]+startPosition[1]])}return relativePositions}function getCommonSurface(positionArray1,positionArray2){let i=0,j=0,commonSurface=[];for(;i<positionArray1.length&&j<positionArray2.length;)positionArray1[i][0]===positionArray2[j][0]&&positionArray1[i][1]===positionArray2[j][1]?(commonSurface.push(positionArray1[i]),i++,j++):positionArray1[i][0]<positionArray2[j][0]||positionArray1[i][0]===positionArray2[j][0]&&positionArray1[i][1]<positionArray2[j][1]?i++:j++;return commonSurface}function getClosestCommonParent(mask){let furthestParent,depthMask1=getDepth(this),depthMask2=getDepth(mask);if(furthestParent=depthMask1>=depthMask2?getFurthestParent(this,depthMask1):getFurthestParent(mask,depthMask2),0===depthMask1||0===depthMask2)return furthestParent;let m1=this,m2=mask;for(;depthMask1!==depthMask2;)if(depthMask1>depthMask2){if(null===(m1=m1.parent))return furthestParent;depthMask1-=1}else{if(null===(m2=m2.parent))return furthestParent;depthMask2-=1}for(;m1!==m2&&null!==m1&&null!==m2;)if(m1=m1.parent,m2=m2.parent,null===m1||null===m2)return furthestParent;return m1!==m2?furthestParent:m1}function getDepth(mask){let d=0,m=mask;for(;null!=m.parent;)m=m.parent,d++;return d}function getFurthestParent(mask,depth){let m=mask;for(;depth>0;)m=m.parent,depth-=1;return m}util_matrix_Matrix.prototype.localMin=function(x,y){let min=this[x][y],position=[x,y];for(let i=Math.max(0,x-1);i<Math.min(this.length,x+2);i++)for(let j=Math.max(0,y-1);j<Math.min(this[0].length,y+2);j++)this[i][j]<min&&(min=this[i][j],position=[i,j]);return{position:position,value:min}},util_matrix_Matrix.prototype.localMax=function(x,y){let max=this[x][y],position=[x,y];for(let i=Math.max(0,x-1);i<Math.min(this.length,x+2);i++)for(let j=Math.max(0,y-1);j<Math.min(this[0].length,y+2);j++)this[i][j]>max&&(max=this[i][j],position=[i,j]);return{position:position,value:max}},util_matrix_Matrix.prototype.localSearch=function(x,y,value){let results=[];for(let i=Math.max(0,x-1);i<Math.min(this.length,x+2);i++)for(let j=Math.max(0,y-1);j<Math.min(this[0].length,y+2);j++)this[i][j]===value&&results.push([i,j]);return results};let src_defaultOptions={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Gx=[[-1,0,1],[-2,0,2],[-1,0,1]],Gy=[[-1,-2,-1],[0,0,0],[1,2,1]],convOptions={bitDepth:32,mode:"periodic"};function cannyEdgeDetector(image,options){image.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),options=Object.assign({},src_defaultOptions,options);let width=image.width,height=image.height,brightness=image.maxValue,gfOptions={sigma:options.gaussianBlur,radius:3},gf=image.gaussianFilter(gfOptions),gradientX=gf.convolution(Gy,convOptions),gradientY=gf.convolution(Gx,convOptions),G=gradientY.hypotenuse(gradientX),Image=image.constructor,nms=new Image(width,height,{kind:"GREY",bitDepth:32}),edges=new Image(width,height,{kind:"GREY",bitDepth:32}),finalImage=new Image(width,height,{kind:"GREY"});for(var i=1;i<width-1;i++)for(var j=1;j<height-1;j++){var dir=(Math.round(Math.atan2(gradientY.getValueXY(i,j,0),gradientX.getValueXY(i,j,0))*(5/Math.PI))+5)%5;0===dir&&(G.getValueXY(i,j,0)<=G.getValueXY(i,j-1,0)||G.getValueXY(i,j,0)<=G.getValueXY(i,j+1,0))||1===dir&&(G.getValueXY(i,j,0)<=G.getValueXY(i-1,j+1,0)||G.getValueXY(i,j,0)<=G.getValueXY(i+1,j-1,0))||2===dir&&(G.getValueXY(i,j,0)<=G.getValueXY(i-1,j,0)||G.getValueXY(i,j,0)<=G.getValueXY(i+1,j,0))||3===dir&&(G.getValueXY(i,j,0)<=G.getValueXY(i-1,j-1,0)||G.getValueXY(i,j,0)<=G.getValueXY(i+1,j+1,0))||nms.setValueXY(i,j,0,G.getValueXY(i,j,0))}for(i=0;i<width*height;++i){var currentNms=nms.data[i],currentEdge=0;currentNms>options.highThreshold&&(currentEdge++,finalImage.data[i]=brightness),currentNms>options.lowThreshold&&currentEdge++,edges.data[i]=currentEdge}var currentPixels=[];for(i=1;i<width-1;++i)for(j=1;j<height-1;++j)if(1===edges.getValueXY(i,j,0)){outer:for(var k=i-1;k<i+2;++k)for(var l=j-1;l<j+2;++l)if(2===edges.getValueXY(k,l,0)){currentPixels.push([i,j]),finalImage.setValueXY(i,j,0,brightness);break outer}}for(;currentPixels.length>0;){var newPixels=[];for(i=0;i<currentPixels.length;++i)for(j=-1;j<2;++j)for(k=-1;k<2;++k)if(0!==j||0!==k){var row=currentPixels[i][0]+j,col=currentPixels[i][1]+k;1===edges.getValueXY(row,col,0)&&0===finalImage.getValueXY(row,col,0)&&(newPixels.push([row,col]),finalImage.setValueXY(row,col,0,brightness))}currentPixels=newPixels}return finalImage}function cannyEdge(options){return cannyEdgeDetector(this,options)}function extract(mask,options={}){let{position}=options;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!position&&!(position=mask.getRelativePosition(this)))throw Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let extract=Image_Image.createFrom(this,{width:mask.width,height:mask.height,alpha:1,position:position,parent:this});for(let x=0;x<mask.width;x++)for(let y=0;y<mask.height;y++){for(let channel=0;channel<this.channels;channel++){let value=this.getValueXY(x+position[0],y+position[1],channel);extract.setValueXY(x,y,channel,value)}mask.getBitXY(x,y)||extract.setValueXY(x,y,this.components,0)}return extract}{let extract1=Image_Image.createFrom(this,{width:mask.width,height:mask.height,position:position,parent:this});for(let y1=0;y1<mask.height;y1++)for(let x1=0;x1<mask.width;x1++)mask.getBitXY(x1,y1)&&this.getBitXY(x1+position[0],y1+position[1])&&extract1.setBitXY(x1,y1);return extract1}}var fast_list=__webpack_require__(8737),fast_list_default=__webpack_require__.n(fast_list);function floodFill(options={}){let{x=0,y=0,inPlace=!0}=options,destination=inPlace?this:Image_Image.createFrom(this);this.checkProcessable("floodFill",{bitDepth:1});let bit=this.getBitXY(x,y);if(bit)return destination;let queue=new(fast_list_default());for(queue.push(new Node(x,y));queue.length>0;){let node=queue.shift();destination.setBitXY(node.x,node.y);for(let i=node.x+1;i<this.width&&!(destination.getBitXY(i,node.y)||this.getBitXY(i,node.y));i++)destination.setBitXY(i,node.y),node.y+1<this.height&&!this.getBitXY(i,node.y+1)&&queue.push(new Node(i,node.y+1)),node.y-1>=0&&!this.getBitXY(i,node.y-1)&&queue.push(new Node(i,node.y-1));for(let i1=node.x-1;i1>=0&&!(destination.getBitXY(i1,node.y)||this.getBitXY(i1,node.y));i1++)destination.setBitXY(i1,node.y),node.y+1<this.height&&!this.getBitXY(i1,node.y+1)&&queue.push(new Node(i1,node.y+1)),node.y-1>=0&&!this.getBitXY(i1,node.y-1)&&queue.push(new Node(i1,node.y-1))}return destination}function Node(x,y){this.x=x,this.y=y}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function hsv2rgb(h,s,v){var rgb=[],c=(v/=100)*(s/=100),hh=h/60,x=c*(1-Math.abs(hh%2-1)),m=v-c;return{r:Math.round(255*((rgb=hh>=0&&hh<1?[c,x,0]:hh>=1&&hh<2?[x,c,0]:hh>=2&&hh<3?[0,c,x]:h>=3&&hh<4?[0,x,c]:h>=4&&hh<5?[x,0,c]:h>=5&&hh<=6?[c,0,x]:[0,0,0])[0]+m)),g:Math.round(255*(rgb[1]+m)),b:Math.round(255*(rgb[2]+m))}}function hsl2hsv(h,s,l){return{h:h,s:2*(s*=(l<50?l:100-l)/100)/(l+s)*100,v:l+s}}function hsl2rgb(h,s,l){var hsv=hsl2hsv(h,s,l);return hsv2rgb(hsv.h,hsv.s,hsv.v)}var colors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function parse(str){return named(str)||hex3(str)||hex6(str)||rgb(str)||rgba$1(str)||index_esm_hsl(str)||hsla(str)}function named(str){var c=colors[str.toLowerCase()];if(c)return{r:c[0],g:c[1],b:c[2],a:100}}function rgb(str){var m=str.match(/rgb\(([^)]+)\)/);if(m){var parts=m[1].split(/ *, */).map(Number);return{r:parts[0],g:parts[1],b:parts[2],a:100}}}function rgba$1(str){var m=str.match(/rgba\(([^)]+)\)/);if(m){var parts=m[1].split(/ *, */).map(Number);return{r:parts[0],g:parts[1],b:parts[2],a:100*parts[3]}}}function hex6(str){if("#"===str[0]&&7===str.length)return{r:parseInt(str.slice(1,3),16),g:parseInt(str.slice(3,5),16),b:parseInt(str.slice(5,7),16),a:100}}function hex3(str){if("#"===str[0]&&4===str.length)return{r:parseInt(str[1]+str[1],16),g:parseInt(str[2]+str[2],16),b:parseInt(str[3]+str[3],16),a:100}}function index_esm_hsl(str){var m=str.match(/hsl\(([^)]+)\)/);if(m){var parts=m[1].split(/ *, */);return _extends({},hsl2rgb(parseInt(parts[0],10),parseInt(parts[1],10),parseInt(parts[2],10)),{a:100})}}function hsla(str){var m=str.match(/hsla\(([^)]+)\)/);if(m){var parts=m[1].split(/ *, */),h=parseInt(parts[0],10),s=parseInt(parts[1],10),l=parseInt(parts[2],10),a=parseInt(100*parseFloat(parts[3]),10);return _extends({},hsl2rgb(h,s,l),{a:a})}}function css2array(string){let color=parse(string);return[color.r,color.g,color.b,Math.round(255*color.a/100)]}function hue2rgb(p,q,t){return(t<0&&(t+=1),t>1&&(t-=1),t<1/6)?p+(q-p)*6*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}function color_hsl2rgb(h,s,l){let m1,m2,hue,r,g,b;return l/=100,0==(s/=100)?r=g=b=255*l:(m2=l<=.5?l*(s+1):l+s-l*s,r=hue2rgb(m1=2*l-m2,m2,(hue=h/360)+1/3),g=hue2rgb(m1,m2,hue),b=hue2rgb(m1,m2,hue-1/3)),{r:r,g:g,b:b}}function getDistinctColors(numColors){let colors=Array(numColors),j=0;for(let i=0;i<360;i+=360/numColors){let color=color_hsl2rgb(i,100,30+ ++j%4*15);colors[j-1]=[Math.round(255*color.r),Math.round(255*color.g),Math.round(255*color.b)]}return colors}function getRandomColor(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}function getColors(options){let{color,colors,randomColors,numberColors=50}=options;if(color&&!Array.isArray(color)&&(color=css2array(color)),color)return[color];if(colors)return colors.map(function(color){return Array.isArray(color)?color:css2array(color)});if(randomColors){colors=Array(numberColors);for(let i=0;i<numberColors;i++)colors[i]=getRandomColor()}return getDistinctColors(numberColors)}function paintLabels(labels,positions,options={}){let{color="blue",colors,font="12px Helvetica",rotate=0}=options;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB}),!Array.isArray(labels))throw Error("paintLabels: labels must be an array");if(!Array.isArray(positions))throw Error("paintLabels: positions must be an array");if(color&&!Array.isArray(color)&&(color=css2array(color)),colors=colors?colors.map(function(color){return Array.isArray(color)?color:css2array(color)}):[color],labels.length!==positions.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(font)||(font=[font]),Array.isArray(rotate)||(rotate=[rotate]);let ctx=this.getCanvas().getContext("2d");for(let i=0;i<labels.length;i++){ctx.save();let color1=colors[i%colors.length];ctx.fillStyle=`rgba(${color1[0]},${color1[1]},${color1[2]},${color1[3]/this.maxValue})`,ctx.font=font[i%font.length];let position=positions[i];ctx.translate(position[0],position[1]),ctx.rotate(rotate[i%rotate.length]/180*Math.PI),ctx.fillText(labels[i],0,0),ctx.restore()}return this.data=Uint8Array.from(ctx.getImageData(0,0,this.width,this.height).data),this}function paintMasks(masks,options={}){let{alpha=255,labels=[],labelsPosition=[],labelColor="blue",labelFont="12px Helvetica"}=options;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB});let colors=getColors(Object.assign({},options,{numberColors:masks.length}));Array.isArray(masks)||(masks=[masks]);for(let i=0;i<masks.length;i++){let mask=masks[i],color=colors[i%colors.length];for(let x=0;x<mask.width;x++)for(let y=0;y<mask.height;y++)if(mask.getBitXY(x,y))for(let component=0;component<Math.min(this.components,color.length);component++)if(255===alpha)this.setValueXY(x+mask.position[0],y+mask.position[1],component,color[component]);else{let value=this.getValueXY(x+mask.position[0],y+mask.position[1],component);value=Math.round((value*(255-alpha)+color[component]*alpha)/255),this.setValueXY(x+mask.position[0],y+mask.position[1],component,value)}}if(Array.isArray(labels)&&labels.length>0){let ctx=this.getCanvas().getContext("2d");ctx.fillStyle=labelColor,ctx.font=labelFont;for(let i1=0;i1<Math.min(masks.length,labels.length);i1++){let position=labelsPosition[i1]?labelsPosition[i1]:masks[i1].position;ctx.fillText(labels[i1],position[0],position[1])}this.data=Uint8Array.from(ctx.getImageData(0,0,this.width,this.height).data)}return this}function zerosMatrix(height,width){let matrix=Array(height);for(let i=0;i<height;i++)matrix[i]=Array(width).fill(0);return matrix}let cross=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],smallCross=[[0,1,0],[1,1,1],[0,1,0]];class Shape{constructor(options={}){let{kind="cross",shape,size,width,height,filled=!0}=options;if(size&&(width=size,height=size),shape)switch(shape.toLowerCase()){case"square":case"rectangle":this.matrix=rectangle(width,height,{filled});break;case"circle":case"ellipse":this.matrix=ellipse(width,height,{filled});break;case"triangle":this.matrix=Shape_triangle(width,height,{filled});break;default:throw Error(`Shape: unexpected shape: ${shape}`)}else if(kind)switch(kind.toLowerCase()){case"cross":this.matrix=cross;break;case"smallcross":this.matrix=smallCross;break;default:throw Error(`Shape: unexpected kind: ${kind}`)}else throw Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let matrix=this.matrix,points=[];for(let y=0;y<matrix.length;y++)for(let x=0;x<matrix[0].length;x++)matrix[y][x]&&points.push([x-this.halfWidth,y-this.halfHeight]);return points}getMask(){let img=new Image_Image(this.width,this.height,{kind:BINARY});for(let y=0;y<this.matrix.length;y++)for(let x=0;x<this.matrix[0].length;x++)this.matrix[y][x]&&img.setBitXY(x,y);return img}}function rectangle(width,height,options){let matrix=zerosMatrix(height,width);if(options.filled)for(let y=0;y<height;y++)for(let x=0;x<width;x++)matrix[y][x]=1;else{for(let y1 of[0,height-1])for(let x1=0;x1<width;x1++)matrix[y1][x1]=1;for(let y2=0;y2<height;y2++)for(let x2 of[0,width-1])matrix[y2][x2]=1}return matrix}function ellipse(width,height,options){let matrix=zerosMatrix(height,width,options),yEven=1-height%2,xEven=1-width%2,a=Math.floor((width-1)/2),b=Math.floor((height-1)/2),a2=a*a,b2=b*b;if(options.filled)for(let y=0;y<=b;y++){let shift=Math.floor(Math.sqrt(a2-a2*y*y/b2));for(let x=a-shift;x<=a;x++)matrix[b-y][x]=1,matrix[b+y+yEven][x]=1,matrix[b-y][width-x-1]=1,matrix[b+y+yEven][width-x-1]=1}else{for(let y1=0;y1<=b;y1++){let x1=a-Math.floor(Math.sqrt(a2-a2*y1*y1/b2));matrix[b-y1][x1]=1,matrix[b+y1+yEven][x1]=1,matrix[b-y1][width-x1-1]=1,matrix[b+y1+yEven][width-x1-1]=1}for(let x2=0;x2<=a;x2++){let y2=b-Math.floor(Math.sqrt(b2-b2*x2*x2/a2));matrix[y2][a-x2]=1,matrix[y2][a+x2+xEven]=1,matrix[height-y2-1][a-x2]=1,matrix[height-y2-1][a+x2+xEven]=1}}return matrix}function Shape_triangle(width,height,options){if(!options.filled)throw Error("Non filled triangle is not implemented");let matrix=zerosMatrix(height,width,options);for(let y=0;y<height;y++){let shift=Math.floor((1-y/height)*width/2);for(let x=shift;x<width-shift;x++)matrix[y][x]=1}return matrix}function paintPoints(points,options={}){let{shape}=options;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let colors=getColors(Object.assign({},options,{numberColors:points.length})),shapePixels=new Shape(shape).getPoints(),numberChannels=Math.min(this.channels,colors[0].length);for(let i=0;i<points.length;i++){let color=colors[i%colors.length],xP=points[i][0],yP=points[i][1];for(let j=0;j<shapePixels.length;j++){let xS=shapePixels[j][0],yS=shapePixels[j][1];if(xP+xS>=0&&yP+yS>=0&&xP+xS<this.width&&yP+yS<this.height){let position=(xP+xS+(yP+yS)*this.width)*this.channels;for(let channel=0;channel<numberChannels;channel++)this.data[position+channel]=color[channel]}}}return this}function paintPolyline(points,options={}){let{color=[this.maxValue,0,0],closed=!1}=options;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let numberChannels=Math.min(this.channels,color.length);for(let i=0;i<points.length-1+closed;i++){let from=points[i],to=points[(i+1)%points.length],dx=to[0]-from[0],dy=to[1]-from[1],steps=Math.max(Math.abs(dx),Math.abs(dy)),xIncrement=dx/steps,yIncrement=dy/steps,x=from[0],y=from[1];for(let j=0;j<=steps;j++){let xPoint=Math.round(x),yPoint=Math.round(y);if(xPoint>=0&&yPoint>=0&&xPoint<this.width&&yPoint<this.height){if(1===this.bitDepth)this.setBitXY(xPoint,yPoint);else{let position=(xPoint+yPoint*this.width)*this.channels;for(let channel=0;channel<numberChannels;channel++)this.data[position+channel]=color[channel]}}x+=xIncrement,y+=yIncrement}}return this}function paintPolylines(polylines,options={}){let optionsCopy=Object.assign({},options);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let colors=getColors(Object.assign({},options,{numberColors:polylines.length}));for(let i=0;i<polylines.length;i++)optionsCopy.color=colors[i%colors.length],this.paintPolyline(polylines[i],optionsCopy);return this}function paintPolygon(points,options={}){let{color=[this.maxValue,0,0],filled=!1}=options;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),options.closed=!0;let filteredPoints=deleteDouble(points);if(!1===filled)return this.paintPolyline(points,options);{let matrixBinary=Array(this.height);for(let i=0;i<this.height;i++){matrixBinary[i]=[];for(let j=0;j<this.width;j++)matrixBinary[i].push(0)}for(let p=0;p<filteredPoints.length;p++){let line=lineBetweenTwoPoints(filteredPoints[p],filteredPoints[(p+1)%filteredPoints.length]);for(let y=0;y<this.height;y++)for(let x=0;x<this.width;x++)isAtTheRightOfTheLine(x,y,line,this.height)&&(matrixBinary[y][x]=0===matrixBinary[y][x]?1:0)}for(let y1=0;y1<this.height;y1++)for(let x1=0;x1<this.width;x1++)if(1===matrixBinary[y1][x1]){if(1===this.bitDepth)this.setBitXY(x1,y1);else{let numberChannels=Math.min(this.channels,color.length),position=(x1+y1*this.width)*this.channels;for(let channel=0;channel<numberChannels;channel++)this.data[position+channel]=color[channel]}}return this.paintPolyline(points,options)}}function deleteDouble(points){let finalPoints=[];for(let i=0;i<points.length;i++)if(points[i][0]!==points[(i+1)%points.length][0]||points[i][1]!==points[(i+1)%points.length][1]){if(points[i][0]===points[(i-1+points.length)%points.length][0]&&points[i][1]===points[(i-1+points.length)%points.length][1])continue;if(points[(i+1)%points.length][0]===points[(i-1+points.length)%points.length][0]&&points[(i-1+points.length)%points.length][1]===points[(i+1)%points.length][1])continue;finalPoints.push(points[i])}return finalPoints}function lineBetweenTwoPoints(p1,p2){if(p1[0]===p2[0])return{a:0,b:p1[0],vertical:!0};{let coeffA=(p2[1]-p1[1])/(p2[0]-p1[0]),coeffB=p1[1]-coeffA*p1[0];return{a:coeffA,b:coeffB,vertical:!1}}}function isAtTheRightOfTheLine(x,y,line,height){if(!0===line.vertical)return line.b<=x;if(0===line.a)return!1;{let xline=(y-line.b)/line.a;return xline<x&&xline>=0&&xline<=height}}function paintPolygons(polygons,options={}){let optionsCopy=Object.assign({},options);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let colors=getColors(Object.assign({},options,{numberColors:polygons.length}));for(let i=0;i<polygons.length;i++)optionsCopy.color=colors[i%colors.length],this.paintPolygon(polygons[i],optionsCopy);return this}function getHistogram(options={}){let{maxSlots=256,channel,useAlpha=!0}=options;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===channel){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");channel=0}return getChannelHistogram.call(this,channel,{useAlpha,maxSlots})}function getHistograms(options={}){let{maxSlots=256,useAlpha=!0}=options;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let results=Array(useAlpha?this.components:this.channels);for(let i=0;i<results.length;i++)results[i]=getChannelHistogram.call(this,i,{useAlpha,maxSlots});return results}function getChannelHistogram(channel,options){let{useAlpha,maxSlots}=options;if(1===this.bitDepth){let blackWhiteCount=[0,0];for(let i=0;i<this.height;i++)for(let j=0;j<this.width;j++){let value=this.getBitXY(i,j);0===value?blackWhiteCount[0]+=1:1===value&&(blackWhiteCount[1]+=1)}return blackWhiteCount}let bitSlots=Math.log2(maxSlots);if(!is_integer_default()(bitSlots))throw RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let bitShift=0;this.bitDepth>bitSlots&&(bitShift=this.bitDepth-bitSlots);let data=this.data,result=new_array_default()(Math.pow(2,Math.min(this.bitDepth,bitSlots)),0);if(useAlpha&&this.alpha){let alphaChannelDiff=this.channels-channel-1;for(let i1=channel;i1<data.length;i1+=this.channels)result[data[i1]>>bitShift]+=data[i1+alphaChannelDiff]/this.maxValue}else for(let i2=channel;i2<data.length;i2+=this.channels)result[data[i2]>>bitShift]++;return result}function getColorHistogram(options={}){let{useAlpha=!0,nbSlots=512}=options;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let nbSlotsCheck=Math.log(nbSlots)/Math.log(8);if(nbSlotsCheck!==Math.floor(nbSlotsCheck))throw RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let bitShift=this.bitDepth-nbSlotsCheck,data=this.data,result=new_array_default()(Math.pow(8,nbSlotsCheck),0),factor2=Math.pow(2,2*nbSlotsCheck),factor1=Math.pow(2,nbSlotsCheck);for(let i=0;i<data.length;i+=this.channels){let slot=(data[i]>>bitShift)*factor2+(data[i+1]>>bitShift)*factor1+(data[i+2]>>bitShift);useAlpha&&this.alpha?result[slot]+=data[i+this.channels-1]/this.maxValue:result[slot]++}return result}function min_min(){this.checkProcessable("min",{bitDepth:[8,16,32]});let result=new_array_default()(this.channels,Infinity);for(let i=0;i<this.data.length;i+=this.channels)for(let c=0;c<this.channels;c++)this.data[i+c]<result[c]&&(result[c]=this.data[i+c]);return result}function max_max(){this.checkProcessable("max",{bitDepth:[8,16,32]});let result=new_array_default()(this.channels,-1/0);for(let i=0;i<this.data.length;i+=this.channels)for(let c=0;c<this.channels;c++)this.data[i+c]>result[c]&&(result[c]=this.data[i+c]);return result}function sum(){this.checkProcessable("sum",{bitDepth:[8,16]});let result=new_array_default()(this.channels,0);for(let i=0;i<this.data.length;i+=this.channels)for(let c=0;c<this.channels;c++)result[c]+=this.data[i+c];return result}function getMoment(xPower=0,yPower=0){this.checkProcessable("getMoment",{bitDepth:[1]});let m=0;for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)1===this.getBitXY(x,y)&&(m+=x**xPower*y**yPower);return m}function localMaxima(options={}){let{mask,region=3,removeClosePoints=0,invert=!1,maxEquals=2}=options,image=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1});let maskExpectedValue=invert?0:1,dx=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],dy=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],shift=(region*=4)<=8?1:2,points=[];for(let currentY=shift;currentY<image.height-shift;currentY++)for(let currentX=shift;currentX<image.width-shift;currentX++){if(mask&&mask.getBitXY(currentX,currentY)!==maskExpectedValue)continue;let counter=0,nbEquals=0,currentValue=image.data[currentX+currentY*image.width];for(let dir=0;dir<region;dir++)invert?image.data[currentX+dx[dir]+(currentY+dy[dir])*image.width]>currentValue&&counter++:image.data[currentX+dx[dir]+(currentY+dy[dir])*image.width]<currentValue&&counter++,image.data[currentX+dx[dir]+(currentY+dy[dir])*image.width]===currentValue&&nbEquals++;counter+nbEquals===region&&nbEquals<=maxEquals&&points.push([currentX,currentY])}if(removeClosePoints>0)for(let i=0;i<points.length;i++)for(let j=i+1;j<points.length;j++)Math.sqrt(Math.pow(points[i][0]-points[j][0],2)+Math.pow(points[i][1]-points[j][1],2))<removeClosePoints&&(points[i][0]=points[i][0]+points[j][0]>>1,points[i][1]=points[i][1]+points[j][1]>>1,points.splice(j,1),j--);return points}function compute_mean_mean(){let histograms=this.getHistograms({maxSlots:this.maxValue+1}),result=Array(histograms.length);for(let c=0;c<histograms.length;c++){let histogram=histograms[c];result[c]=mean(histogram)}return result}function compute_median_median(){let histograms=this.getHistograms({maxSlots:this.maxValue+1}),result=Array(histograms.length);for(let c=0;c<histograms.length;c++){let histogram=histograms[c];result[c]=histogram_median(histogram)}return result}function points(){this.checkProcessable("points",{bitDepth:[1]});let pixels=[];for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)1===this.getBitXY(x,y)&&pixels.push([x,y]);return pixels}function extendedPoints(){this.checkProcessable("extendedPoints",{bitDepth:[1]});let pixels=[];for(let y=0;y<this.height;y++)for(let x=0;x<this.width;x++)if(1===this.getBitXY(x,y))for(pixels.push([x,y]),1!==this.getBitXY(x+1,y)?(pixels.push([x+1,y]),pixels.push([x+1,y+1]),1!==this.getBitXY(x,y+1)&&pixels.push([x,y+1])):1!==this.getBitXY(x,y+1)&&(pixels.push([x,y+1]),pixels.push([x+1,y+1]));x<this.width-2&&1===this.getBitXY(x+1,y)&&1===this.getBitXY(x+2,y);)x++;return pixels}function getRelativePosition(targetImage,options={}){if(this===targetImage)return[0,0];let position=[0,0],currentImage=this;for(;currentImage;){if(currentImage===targetImage)return position;currentImage.position&&(position[0]+=currentImage.position[0],position[1]+=currentImage.position[1]),currentImage=currentImage.parent}return!!options.defaultFurther&&position}function countAlphaPixels(options={}){let{alpha=1}=options;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let count=0;if(void 0===alpha)return this.size;for(let i=this.components;i<this.data.length;i+=this.channels)this.data[i]===alpha&&count++;return count}function monotoneChainConvexHull(points,options={}){let{sorted}=options;sorted||(points=points.slice().sort(byXThenY));let n=points.length,result=Array(2*n),k=0;for(let i=0;i<n;i++){let point=points[i];for(;k>=2&&0>=cw(result[k-2],result[k-1],point);)k--;result[k++]=point}let t=k+1;for(let i1=n-2;i1>=0;i1--){let point1=points[i1];for(;k>=t&&0>=cw(result[k-2],result[k-1],point1);)k--;result[k++]=point1}return result.slice(0,k-1)}function cw(p1,p2,p3){return(p2[1]-p1[1])*(p3[0]-p1[0])-(p2[0]-p1[0])*(p3[1]-p1[1])}function byXThenY(point1,point2){return point1[0]===point2[0]?point1[1]-point2[1]:point1[0]-point2[0]}function monotoneChainConvexHull_monotoneChainConvexHull(){return monotoneChainConvexHull(this.extendedPoints,{sorted:!1})}function round(points){for(let i=0;i<points.length;i++)points[i][0]=Math.round(points[i][0]),points[i][1]=Math.round(points[i][1]);return points}function difference(p1,p2){return[p1[0]-p2[0],p1[1]-p2[1]]}function normalize(p){let length=Math.sqrt(p[0]**2+p[1]**2);return[p[0]/length,p[1]/length]}function points_rotate(radians,srcPoints,destPoints){void 0===destPoints&&(destPoints=Array(srcPoints.length));let cos=Math.cos(radians),sin=Math.sin(radians);for(let i=0;i<destPoints.length;++i)destPoints[i]=[cos*srcPoints[i][0]-sin*srcPoints[i][1],sin*srcPoints[i][0]+cos*srcPoints[i][1]];return destPoints}function perimeter(vertices){let total=0;for(let i=0;i<vertices.length;i++){let fromX=vertices[i][0],fromY=vertices[i][1];total+=Math.sqrt((vertices[i===vertices.length-1?0:i+1][0]-fromX)**2+(vertices[i===vertices.length-1?0:i+1][1]-fromY)**2)}return total}function surface(vertices){let total=0;for(let i=0;i<vertices.length;i++){let addX=vertices[i][0],addY=vertices[i===vertices.length-1?0:i+1][1],subX=vertices[i===vertices.length-1?0:i+1][0],subY=vertices[i][1];total+=addX*addY*.5,total-=subX*subY*.5}return Math.abs(total)}function points_minMax(points){let xMin=Infinity,yMin=Infinity,xMax=-1/0,yMax=-1/0;for(let i=0;i<points.length;i++)points[i][0]<xMin&&(xMin=points[i][0]),points[i][0]>xMax&&(xMax=points[i][0]),points[i][1]<yMin&&(yMin=points[i][1]),points[i][1]>yMax&&(yMax=points[i][1]);return[[xMin,yMin],[xMax,yMax]]}function moveToZeroZero(srcPoints,destPoints){void 0===destPoints&&(destPoints=Array(srcPoints.length).fill(0).map(()=>[]));let minMaxValues=points_minMax(srcPoints),xMin=minMaxValues[0][0],yMin=minMaxValues[0][1];for(let i=0;i<srcPoints.length;i++)destPoints[i][0]=srcPoints[i][0]-xMin,destPoints[i][1]=srcPoints[i][1]-yMin;return destPoints}function minimalBoundingRectangle(options={}){let mbr;let{originalPoints=monotoneChainConvexHull_monotoneChainConvexHull.call(this)}=options;if(0===originalPoints.length)return[];if(1===originalPoints.length)return[originalPoints[0],originalPoints[0],originalPoints[0],originalPoints[0]];let p=Array(originalPoints.length),minSurface=Infinity,minSurfaceAngle=0;for(let i=0;i<p.length;i++){let angle=getAngle(originalPoints[i],originalPoints[(i+1)%p.length]);points_rotate(-angle,originalPoints,p);let aX=p[i][0],aY=p[i][1],bX=p[(i+1)%p.length][0],bY=p[(i+1)%p.length][1],tUndefined=!0,tMin=0,tMax=0,maxWidth=0;for(let j=0;j<p.length;j++){let cX=p[j][0],cY=p[j][1],t=(cX-aX)/(bX-aX);!0===tUndefined?(tUndefined=!1,tMin=t,tMax=t):(t<tMin&&(tMin=t),t>tMax&&(tMax=t));let width=(-(bX-aX)*cY+bX*aY-bY*aX)/(bX-aX);Math.abs(width)>Math.abs(maxWidth)&&(maxWidth=width)}let pMin=[aX+tMin*(bX-aX),aY],pMax=[aX+tMax*(bX-aX),aY],currentSurface=Math.abs(maxWidth*(tMin-tMax)*(bX-aX));currentSurface<minSurface&&(minSurfaceAngle=angle,minSurface=currentSurface,mbr=[pMin,pMax,[pMax[0],pMax[1]-maxWidth],[pMin[0],pMin[1]-maxWidth]])}return points_rotate(minSurfaceAngle,mbr,mbr),mbr}function getAngle(p1,p2){let vector=normalize(difference(p2,p1)),angle=Math.acos(vector[0]);return vector[1]<0?-angle:angle}function extend_extend(Image){let inPlace={inPlace:!0};Image.extendMethod("invert",invert),Image.extendMethod("abs",abs),Image.extendMethod("level",level,inPlace),Image.extendMethod("add",add,inPlace),Image.extendMethod("subtract",subtract,inPlace),Image.extendMethod("subtractImage",subtractImage),Image.extendMethod("multiply",multiply,inPlace),Image.extendMethod("divide",divide,inPlace),Image.extendMethod("hypotenuse",hypotenuse),Image.extendMethod("background",background),Image.extendMethod("flipX",flipX),Image.extendMethod("flipY",flipY),Image.extendMethod("blurFilter",blurFilter),Image.extendMethod("medianFilter",medianFilter),Image.extendMethod("gaussianFilter",gaussianFilter),Image.extendMethod("sobelFilter",sobelFilter),Image.extendMethod("gradientFilter",gradientFilter),Image.extendMethod("scharrFilter",scharrFilter),Image.extendMethod("dilate",dilate),Image.extendMethod("erode",erode),Image.extendMethod("open",open_open),Image.extendMethod("close",close_close),Image.extendMethod("topHat",topHat),Image.extendMethod("blackHat",blackHat),Image.extendMethod("morphologicalGradient",morphologicalGradient),Image.extendMethod("warpingFourPoints",warpingFourPoints),Image.extendMethod("crop",crop),Image.extendMethod("cropAlpha",cropAlpha),Image.extendMethod("resize",resize).extendMethod("scale",resize),Image.extendMethod("hsv",hsv),Image.extendMethod("hsl",hsl),Image.extendMethod("cmyk",cmyk),Image.extendMethod("rgba8",rgba8),Image.extendMethod("grey",grey).extendMethod("gray",grey),Image.extendMethod("mask",mask),Image.extendMethod("pad",pad),Image.extendMethod("colorDepth",colorDepth),Image.extendMethod("setBorder",setBorder,inPlace),Image.extendMethod("rotate",rotate),Image.extendMethod("rotateLeft",rotateLeft),Image.extendMethod("rotateRight",rotateRight),Image.extendMethod("insert",insert),Image.extendMethod("getRow",getRow),Image.extendMethod("getColumn",getColumn),Image.extendMethod("getMatrix",getMatrix),Image.extendMethod("setMatrix",setMatrix),Image.extendMethod("getPixelsArray",getPixelsArray),Image.extendMethod("getIntersection",getIntersection),Image.extendMethod("getClosestCommonParent",getClosestCommonParent),Image.extendMethod("getThreshold",getThreshold_getThreshold),Image.extendMethod("split",split),Image.extendMethod("getChannel",getChannel),Image.extendMethod("combineChannels",combineChannels),Image.extendMethod("setChannel",setChannel),Image.extendMethod("getSimilarity",getSimilarity),Image.extendMethod("getPixelsGrid",getPixelsGrid),Image.extendMethod("getBestMatch",getBestMatch),Image.extendMethod("cannyEdge",cannyEdge),Image.extendMethod("convolution",convolution),Image.extendMethod("extract",extract),Image.extendMethod("floodFill",floodFill),Image.extendMethod("paintLabels",paintLabels,inPlace),Image.extendMethod("paintMasks",paintMasks,inPlace),Image.extendMethod("paintPoints",paintPoints,inPlace),Image.extendMethod("paintPolyline",paintPolyline,inPlace),Image.extendMethod("paintPolylines",paintPolylines,inPlace),Image.extendMethod("paintPolygon",paintPolygon,inPlace),Image.extendMethod("paintPolygons",paintPolygons,inPlace),Image.extendMethod("countAlphaPixels",countAlphaPixels),Image.extendMethod("monotoneChainConvexHull",monotoneChainConvexHull_monotoneChainConvexHull),Image.extendMethod("minimalBoundingRectangle",minimalBoundingRectangle),Image.extendMethod("getHistogram",getHistogram).extendProperty("histogram",getHistogram),Image.extendMethod("getHistograms",getHistograms).extendProperty("histograms",getHistograms),Image.extendMethod("getColorHistogram",getColorHistogram).extendProperty("colorHistogram",getColorHistogram),Image.extendMethod("getMin",min_min).extendProperty("min",min_min),Image.extendMethod("getMax",max_max).extendProperty("max",max_max),Image.extendMethod("getSum",sum).extendProperty("sum",sum),Image.extendMethod("getMoment",getMoment).extendProperty("moment",getMoment),Image.extendMethod("getLocalMaxima",localMaxima),Image.extendMethod("getMedian",compute_median_median).extendProperty("median",compute_median_median),Image.extendMethod("getMean",compute_mean_mean).extendProperty("mean",compute_mean_mean),Image.extendMethod("getPoints",points).extendProperty("points",points),Image.extendMethod("getExtendedPoints",extendedPoints).extendProperty("extendedPoints",extendedPoints),Image.extendMethod("getRelativePosition",getRelativePosition)}var quantities=__webpack_require__(2229),quantities_default=__webpack_require__.n(quantities);function deepValue(object,path=""){for(let part of path.split(".")){if(void 0===object[part])return;object=object[part]}return object}var robust_pnp=__webpack_require__(4707),robust_pnp_default=__webpack_require__.n(robust_pnp);function feretDiameters(options={}){let{originalPoints=monotoneChainConvexHull_monotoneChainConvexHull.call(this)}=options;if(0===originalPoints.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===originalPoints.length)return{min:1,max:1,minLine:[originalPoints[0],originalPoints[0]],maxLine:[originalPoints[0],originalPoints[0]],aspectRatio:1};let temporaryPoints=Array(originalPoints.length),minWidth=Infinity,minWidthAngle=0,minLine=[];for(let i=0;i<originalPoints.length;i++){let angle=feretDiameters_getAngle(originalPoints[i],originalPoints[(i+1)%originalPoints.length]);points_rotate(-angle,originalPoints,temporaryPoints);let currentWidth=0,currentMinLine=[];for(let j=0;j<originalPoints.length;j++){let absWidth=Math.abs(temporaryPoints[i][1]-temporaryPoints[j][1]);absWidth>currentWidth&&(currentWidth=absWidth,(currentMinLine=[]).push([temporaryPoints[j][0],temporaryPoints[i][1]],[temporaryPoints[j][0],temporaryPoints[j][1]]))}currentWidth<minWidth&&(minWidth=currentWidth,minWidthAngle=angle,minLine=currentMinLine)}points_rotate(minWidthAngle,minLine,minLine);let maxWidth=0,maxLine=[],maxSquaredWidth=0;for(let i1=0;i1<originalPoints.length-1;i1++)for(let j1=i1+1;j1<originalPoints.length;j1++){let currentSquaredWidth=(originalPoints[i1][0]-originalPoints[j1][0])**2+(originalPoints[i1][1]-originalPoints[j1][1])**2;currentSquaredWidth>maxSquaredWidth&&(maxSquaredWidth=currentSquaredWidth,maxWidth=Math.sqrt(currentSquaredWidth),maxLine=[originalPoints[i1],originalPoints[j1]])}return{min:minWidth,minLine,max:maxWidth,maxLine,aspectRatio:minWidth/maxWidth}}function feretDiameters_getAngle(p1,p2){let vector=normalize(difference(p2,p1)),angle=Math.acos(vector[0]);return vector[1]<0?-angle:angle}class Roi{constructor(map,id){this.map=map,this.id=id,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(options={}){let mask;let{scale=1,kind=""}=options;switch(kind){case"contour":mask=this.contourMask;break;case"box":mask=this.boxMask;break;case"filled":mask=this.filledMask;break;case"center":mask=this.centerMask;break;case"mbr":mask=this.mbrFilledMask;break;case"hull":mask=this.convexHullFilledMask;break;case"hullContour":mask=this.convexHullMask;break;case"mbrContour":mask=this.mbrMask;break;case"feret":mask=this.feretMask;break;default:mask=this.mask}return scale<1&&((mask=mask.resize({factor:scale})).parent=this.mask.parent,mask.position[0]+=this.minX,mask.position[1]+=this.minY),mask}get mean(){throw Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let borders=this.borderIDs,lengths=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let internals=this.internalIDs;for(let i=0;i<borders.length;i++)internals.includes(borders[i])||(this.computed.externalIDs.push(borders[i]),this.computed.externalLengths.push(lengths[i]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let borders=getBorders(this);this.computed.borderIDs=borders.ids,this.computed.borderLengths=borders.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=getBoxIDs(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=getInternalIDs(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=getBox(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=getExternal(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=getHolesInfo(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=getBorder(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)this.map.data[x+this.minX+(y+this.minY)*this.map.width]===this.id&&(x>0&&x<this.width-1&&y>0&&y<this.height-1?(this.map.data[x-1+this.minX+(y+this.minY)*this.map.width]!==this.id||this.map.data[x+1+this.minX+(y+this.minY)*this.map.width]!==this.id||this.map.data[x+this.minX+(y-1+this.minY)*this.map.width]!==this.id||this.map.data[x+this.minX+(y+1+this.minY)*this.map.width]!==this.id)&&img.setBitXY(x,y):img.setBitXY(x,y));this.computed.contourMask=img}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let x=0;x<this.width;x++)img.setBitXY(x,0),img.setBitXY(x,this.height-1);for(let y=0;y<this.height;y++)img.setBitXY(0,y),img.setBitXY(this.width-1,y);this.computed.boxMask=img}return this.computed.boxMask}get mask(){if(!this.computed.mask){let img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)this.map.data[x+this.minX+(y+this.minY)*this.map.width]===this.id&&img.setBitXY(x,y);this.computed.mask=img}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++){let target=x+this.minX+(y+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[target])&&img.setBitXY(x,y)}this.computed.filledMask=img}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let img=new Shape({kind:"smallCross"}).getMask();img.parent=this.map.parent,img.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=img}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){let calculationPoints=[];for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)this.map.data[x+this.minX+(y+this.minY)*this.map.width]===this.id&&(x>0&&x<this.width-1&&y>0&&y<this.height-1?(this.map.data[x-1+this.minX+(y+this.minY)*this.map.width]!==this.id||this.map.data[x+1+this.minX+(y+this.minY)*this.map.width]!==this.id||this.map.data[x+this.minX+(y-1+this.minY)*this.map.width]!==this.id||this.map.data[x+this.minX+(y+1+this.minY)*this.map.width]!==this.id)&&(calculationPoints.push([x,y]),calculationPoints.push([x+1,y]),calculationPoints.push([x,y+1]),calculationPoints.push([x+1,y+1])):(calculationPoints.push([x,y]),calculationPoints.push([x+1,y]),calculationPoints.push([x,y+1]),calculationPoints.push([x+1,y+1])));let convexHull=monotoneChainConvexHull(calculationPoints);this.computed.convexHull={polyline:convexHull,surface:surface(convexHull),perimeter:perimeter(convexHull)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){let convexHull=this.convexHull,img=new Image_Image(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});img.paintPolyline(convexHull.polyline,{closed:!0}),this.computed.convexHullMask=img}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){let convexHull=this.convexHull,img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)1!==robust_pnp_default()(convexHull.polyline,[x,y])&&img.setBitXY(x,y);this.computed.convexHullFilledMask=img}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let mbr=minimalBoundingRectangle({originalPoints:this.convexHull.polyline});if(0===mbr.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:mbr};else{let first=mbr[0],second=mbr[1],third=mbr[2],width=Math.sqrt((first[0]-second[0])**2+(first[1]-second[1])**2),height=Math.sqrt((third[0]-second[0])**2+(third[1]-second[1])**2);this.computed.mbr={width,height,elongation:1-width/height,aspectRatio:width/height,surface:width*height,perimeter:(width+height)*2,rectangle:mbr}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=feretDiameters({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=getPerimeterInfo(this)),this.computed.perimeterInfo}get perimeter(){let info=this.perimeterInfo,delta=2-Math.sqrt(2);return info.one+2*info.two+3*info.three+4*info.four-delta*(info.two+2*info.three+info.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){let image=new Image_Image(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});image.paintPolyline(this.feretDiameters.minLine),image.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=image}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let rectangle=round(this.mbr.rectangle);if(rectangle.length>0){let minMax=points_minMax(rectangle),img=new Image_Image(minMax[1][0]-minMax[0][0]+1,minMax[1][1]-minMax[0][1]+1,{kind:BINARY,position:[this.minX+minMax[0][0],this.minY+minMax[0][1]],parent:this.map.parent});rectangle=moveToZeroZero(rectangle),img.paintPolyline(rectangle,{closed:!0}),this.computed.mbrMask=img}else this.computed.mbrMask=new Image_Image(1,1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){let img=new Image_Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent}),mbr=this.mask.minimalBoundingRectangle();for(let x=0;x<this.width;x++)for(let y=0;y<this.height;y++)1!==robust_pnp_default()(mbr,[x,y])&&img.setBitXY(x,y);this.computed.mbrFilledMask=img}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let points=[];for(let y=0;y<this.height;y++)for(let x=0;x<this.width;x++){let target=(y+this.minY)*this.map.width+x+this.minX;this.map.data[target]===this.id&&points.push([x,y])}this.computed.points=points}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let maxLengthPoints,maxLength=0,points=this.points;for(let i=0;i<points.length;i++)for(let j=i+1;j<points.length;j++){let currentML=Math.pow(points[i][0]-points[j][0],2)+Math.pow(points[i][1]-points[j][1],2);currentML>=maxLength&&(maxLength=currentML,maxLengthPoints=[points[i],points[j]])}this.computed.maxLengthPoints=maxLengthPoints}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let maxLength=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=maxLength}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let points=this.maxLengthPoints,angle=-(180*Math.atan2(points[0][1]-points[1][1],points[0][0]-points[1][0]))/Math.PI;this.computed.angle=angle}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function getBorders(roi){let roiMap=roi.map,data=roiMap.data,surroudingIDs=new Set,surroundingBorders=new Map,visitedData=new Set,dx=[1,0,-1,0],dy=[0,1,0,-1];for(let x=roi.minX;x<=roi.maxX;x++)for(let y=roi.minY;y<=roi.maxY;y++)if(data[x+y*roiMap.width]===roi.id)for(let dir=0;dir<4;dir++){let newX=x+dx[dir],newY=y+dy[dir];if(newX>=0&&newY>=0&&newX<roiMap.width&&newY<roiMap.height){let neighbour=newX+newY*roiMap.width;if(data[neighbour]!==roi.id&&!visitedData.has(neighbour)){visitedData.add(neighbour),surroudingIDs.add(data[neighbour]);let surroundingBorder=surroundingBorders.get(data[neighbour]);surroundingBorder?surroundingBorders.set(data[neighbour],++surroundingBorder):surroundingBorders.set(data[neighbour],1)}}}let ids=Array.from(surroudingIDs),borderLengths=ids.map(function(id){return surroundingBorders.get(id)});return{ids:ids,lengths:borderLengths}}function getBoxIDs(roi){let surroundingIDs=new Set,roiMap=roi.map,data=roiMap.data;for(let y of[0,roi.height-1])for(let x=0;x<roi.width;x++){let target=(y+roi.minY)*roiMap.width+x+roi.minX;if(x-roi.minX>0&&data[target]===roi.id&&data[target-1]!==roi.id){let value=data[target-1];surroundingIDs.add(value)}if(roiMap.width-x-roi.minX>1&&data[target]===roi.id&&data[target+1]!==roi.id){let value1=data[target+1];surroundingIDs.add(value1)}}for(let x1 of[0,roi.width-1])for(let y1=0;y1<roi.height;y1++){let target1=(y1+roi.minY)*roiMap.width+x1+roi.minX;if(y1-roi.minY>0&&data[target1]===roi.id&&data[target1-roiMap.width]!==roi.id){let value2=data[target1-roiMap.width];surroundingIDs.add(value2)}if(roiMap.height-y1-roi.minY>1&&data[target1]===roi.id&&data[target1+roiMap.width]!==roi.id){let value3=data[target1+roiMap.width];surroundingIDs.add(value3)}}return Array.from(surroundingIDs)}function getBox(roi){let total=0,roiMap=roi.map,data=roiMap.data,topBottom=[0];for(let y of(roi.height>1&&(topBottom[1]=roi.height-1),topBottom))for(let x=1;x<roi.width-1;x++)data[(y+roi.minY)*roiMap.width+x+roi.minX]===roi.id&&total++;let leftRight=[0];for(let x1 of(roi.width>1&&(leftRight[1]=roi.width-1),leftRight))for(let y1=0;y1<roi.height;y1++)data[(y1+roi.minY)*roiMap.width+x1+roi.minX]===roi.id&&total++;return total}function getBorder(roi){let total=0,roiMap=roi.map,data=roiMap.data;for(let x=1;x<roi.width-1;x++)for(let y=1;y<roi.height-1;y++){let target=(y+roi.minY)*roiMap.width+x+roi.minX;data[target]===roi.id&&(data[target-1]!==roi.id||data[target+1]!==roi.id||data[target-roiMap.width]!==roi.id||data[target+roiMap.width]!==roi.id)&&total++}return total+roi.box}function getPerimeterInfo(roi){let roiMap=roi.map,data=roiMap.data,one=0,two=0,three=0,four=0;for(let x=0;x<roi.width;x++)for(let y=0;y<roi.height;y++){let target=(y+roi.minY)*roiMap.width+x+roi.minX;if(data[target]===roi.id){let nbAround=0;switch(0===x?nbAround++:roi.externalIDs.includes(data[target-1])&&nbAround++,x===roi.width-1?nbAround++:roi.externalIDs.includes(data[target+1])&&nbAround++,0===y?nbAround++:roi.externalIDs.includes(data[target-roiMap.width])&&nbAround++,y===roi.height-1?nbAround++:roi.externalIDs.includes(data[target+roiMap.width])&&nbAround++,nbAround){case 1:one++;break;case 2:two++;break;case 3:three++;break;case 4:four++}}}return{one,two,three,four}}function getExternal(roi){let total=0,roiMap=roi.map,data=roiMap.data;for(let x=1;x<roi.width-1;x++)for(let y=1;y<roi.height-1;y++){let target=(y+roi.minY)*roiMap.width+x+roi.minX;data[target]===roi.id&&(roi.externalIDs.includes(data[target-1])||roi.externalIDs.includes(data[target+1])||roi.externalIDs.includes(data[target-roiMap.width])||roi.externalIDs.includes(data[target+roiMap.width]))&&total++}return total+roi.box}function getHolesInfo(roi){let surface=0,width=roi.map.width,data=roi.map.data;for(let x=1;x<roi.width-1;x++)for(let y=1;y<roi.height-1;y++){let target=(y+roi.minY)*width+x+roi.minX;roi.internalIDs.includes(data[target])&&data[target]!==roi.id&&surface++}return{number:roi.internalIDs.length-1,surface}}function getInternalIDs(roi){let internal=[roi.id],roiMap=roi.map,data=roiMap.data;if(roi.height>2)for(let x=0;x<roi.width;x++){let target=roi.minY*roiMap.width+x+roi.minX;if(internal.includes(data[target])){let id=data[target+roiMap.width];internal.includes(id)||roi.boxIDs.includes(id)||internal.push(id)}}let array=[,,,,];for(let x1=1;x1<roi.width-1;x1++)for(let y=1;y<roi.height-1;y++){let target1=(y+roi.minY)*roiMap.width+x1+roi.minX;if(internal.includes(data[target1])){array[0]=data[target1-1],array[1]=data[target1+1],array[2]=data[target1-roiMap.width],array[3]=data[target1+roiMap.width];for(let i=0;i<4;i++){let id1=array[i];internal.includes(id1)||roi.boxIDs.includes(id1)||internal.push(id1)}}}return internal}class RoiLayer{constructor(roiMap,options){this.roiMap=roiMap,this.options=options,this.roi=this.createRoi()}createRoi(){let data=this.roiMap.data,mapIDs={};this.roiMap.positive=0,this.roiMap.negative=0;for(let i=0;i<data.length;i++)data[i]&&!mapIDs[data[i]]&&(mapIDs[data[i]]=!0,data[i]>0?this.roiMap.positive++:this.roiMap.negative++);let rois={};for(let mapID in mapIDs)rois[mapID]=new Roi(this.roiMap,1*mapID);let width=this.roiMap.width,height=this.roiMap.height;for(let y=0;y<height;y++)for(let x=0;x<width;x++){let target=y*width+x;if(0!==data[target]){let mapID1=data[target],roi=rois[mapID1];x<roi.minX&&(roi.minX=x),x>roi.maxX&&(roi.maxX=x),y<roi.minY&&(roi.minY=y),y>roi.maxY&&(roi.maxY=y),roi.meanX+=x,roi.meanY+=y,roi.surface++}}let roiArray=[];for(let mapID2 in mapIDs)rois[mapID2].meanX/=rois[mapID2].surface,rois[mapID2].meanY/=rois[mapID2].surface,roiArray.push(rois[mapID2]);return roiArray}}function commonBorderLength(roiMap){let data=roiMap.data,dx=[1,0,-1,0],dy=[0,1,0,-1],minMax=roiMap.minMax,shift=-minMax.min,max=minMax.max+shift,borderInfo=[];for(let i=0;i<=max;i++)borderInfo.push(Object.create(null));for(let x=0;x<roiMap.width;x++)for(let y=0;y<roiMap.height;y++){let currentRoiID=data[x+y*roiMap.width];if(0!==currentRoiID){let used=Object.create(null),isBorder=!1;for(let dir=0;dir<4;dir++){let newX=x+dx[dir],newY=y+dy[dir];if(newX>=0&&newY>=0&&newX<roiMap.width&&newY<roiMap.height){let neighbourRoiID=data[newX+newY*roiMap.width];currentRoiID!==neighbourRoiID&&(isBorder=!0,0!==neighbourRoiID&&void 0===used[neighbourRoiID]&&(used[neighbourRoiID]=!0,borderInfo[neighbourRoiID+shift][currentRoiID]?borderInfo[neighbourRoiID+shift][currentRoiID]++:borderInfo[neighbourRoiID+shift][currentRoiID]=1))}else isBorder=!0}isBorder&&(borderInfo[currentRoiID+shift][currentRoiID]?borderInfo[currentRoiID+shift][currentRoiID]++:borderInfo[currentRoiID+shift][currentRoiID]=1)}}let result={};for(let i1=0;i1<borderInfo.length;i1++)Object.keys(borderInfo[i1]).length>0&&(result[i1-shift]=borderInfo[i1]);return result}function mergeRoi(options={}){let{algorithm="commonBorderLength",minCommonBorderLength=5,maxCommonBorderLength=100,minCommonBorderRatio=.3,maxCommonBorderRatio=1}=options,checkFunction=function(currentInfo,currentID,neighbourID){return currentInfo[neighbourID]>=minCommonBorderLength&&currentInfo[neighbourID]<=maxCommonBorderLength};"function"==typeof algorithm&&(checkFunction=algorithm),"commonborderratio"===algorithm.toLowerCase()&&(checkFunction=function(currentInfo,currentID,neighbourID){let ratio=Math.min(currentInfo[neighbourID]/currentInfo[currentID],1);return ratio>=minCommonBorderRatio&&ratio<=maxCommonBorderRatio});let roiMap=this,borderLengths=roiMap.commonBorderLength,newMap={},oldToNew={};for(let currentID of Object.keys(borderLengths)){let currentInfo=borderLengths[currentID];for(let neighbourID of Object.keys(currentInfo))if(neighbourID!==currentID&&checkFunction(currentInfo,currentID,neighbourID)){let newNeighbourID=neighbourID;oldToNew[neighbourID]&&(newNeighbourID=oldToNew[neighbourID]);let newCurrentID=currentID;if(oldToNew[currentID]&&(newCurrentID=oldToNew[currentID]),Number(newNeighbourID)!==newCurrentID){let smallerID=Math.min(newNeighbourID,newCurrentID),largerID=Math.max(newNeighbourID,newCurrentID);if(newMap[smallerID]||(newMap[smallerID]={}),newMap[smallerID][largerID]=!0,oldToNew[largerID]=smallerID,newMap[largerID]){for(let id of Object.keys(newMap[largerID]))newMap[smallerID][id]=!0,oldToNew[id]=smallerID;delete newMap[largerID]}}}}let minMax=roiMap.minMax,shift=-minMax.min,oldToNewArray=Array(minMax.max+shift+1).fill(0);for(let key of Object.keys(oldToNew))oldToNewArray[Number(key)+shift]=oldToNew[key];let data=roiMap.data;for(let i=0;i<data.length;i++){let currentValue=data[i];if(0!==currentValue){let newValue=oldToNewArray[currentValue+shift];0!==newValue&&(data[i]=newValue)}}return roiMap.computed={},roiMap}class RoiMap{constructor(parent,data){this.parent=parent,this.width=parent.width,this.height=parent.height,this.data=data,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let min=Number.MAX_SAFE_INTEGER,max=Number.MIN_SAFE_INTEGER;for(let i=0;i<this.data.length;i++)this.data[i]<min&&(min=this.data[i]),this.data[i]>max&&(max=this.data[i]);return{min,max}}get commonBorderLength(){return commonBorderLength(this)}mergeRoi(options={}){return mergeRoi.call(this,options)}mergeRois(rois){let first=rois[0],others=rois.slice(1);for(let i=0;i<this.data.length;i++)others.includes(this.data[i])&&(this.data[i]=first)}rowsInfo(){let rowsInfo=Array(this.height),currentRow=0;for(let i=0;i<this.data.length;i+=this.width){let info={row:currentRow,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};rowsInfo[currentRow++]=info;let positives={},negatives={},changes=[],previous=this.data[i],current=0;for(let j=i;j<i+this.width;j++){let value=this.data[j];previous!==value&&(previous=value,changes.push(current),current=0),current++,value>0?(info.positivePixel++,positives[value]||(positives[value]=!0)):value<0?(info.negativePixel++,negatives[value]||(negatives[value]=!0)):info.zeroPixel++}changes.push(current),info.medianChange=changes.sort((a,b)=>a-b)[Math.floor(changes.length/2)],info.positiveRoiIDs=Object.keys(positives),info.negativeRoiIDs=Object.keys(negatives),info.positiveRoi=info.positiveRoiIDs.length,info.negativeRoi=info.negativeRoiIDs.length}return rowsInfo}colsInfo(){let colsInfo=Array(this.width),currentCol=0;for(let i=0;i<this.width;i++){let info={col:currentCol,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};colsInfo[currentCol++]=info;let positives={},negatives={},changes=[],previous=this.data[i],current=0;for(let j=i;j<i+this.data.length;j+=this.width){let value=this.data[j];previous!==value&&(previous=value,changes.push(current),current=0),current++,value>0?(info.positivePixel++,positives[value]||(positives[value]=!0)):value<0?(info.negativePixel++,negatives[value]||(negatives[value]=!0)):info.zeroPixel++}changes.push(current),info.medianChange=changes.sort((a,b)=>a-b)[Math.floor(changes.length/2)],info.positiveRoiIDs=Object.keys(positives),info.negativeRoiIDs=Object.keys(negatives),info.positiveRoi=info.positiveRoiIDs.length,info.negativeRoi=info.negativeRoiIDs.length}return colsInfo}}function fromMask(mask,options={}){let{allowCorners=!1}=options,MAX_ARRAY=65535,data=new Int16Array(mask.size),positiveID=0,negativeID=0,xToProcess=new Uint16Array(MAX_ARRAY+1),yToProcess=new Uint16Array(MAX_ARRAY+1);for(let x=0;x<mask.width;x++)for(let y=0;y<mask.height;y++)0===data[y*mask.width+x]&&analyseSurface(x,y);function analyseSurface(x,y){let from=0,to=0,targetState=mask.getBitXY(x,y),id=targetState?++positiveID:--negativeID;if(positiveID>32767||negativeID<-32768)throw Error("Too many regions of interest");for(xToProcess[0]=x,yToProcess[0]=y;from<=to;){let currentX=xToProcess[from&MAX_ARRAY],currentY=yToProcess[from&MAX_ARRAY];if(data[currentY*mask.width+currentX]=id,currentX>0&&0===data[currentY*mask.width+currentX-1]&&mask.getBitXY(currentX-1,currentY)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX-1,yToProcess[to&MAX_ARRAY]=currentY,data[currentY*mask.width+currentX-1]=-32768),currentY>0&&0===data[(currentY-1)*mask.width+currentX]&&mask.getBitXY(currentX,currentY-1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX,yToProcess[to&MAX_ARRAY]=currentY-1,data[(currentY-1)*mask.width+currentX]=-32768),currentX<mask.width-1&&0===data[currentY*mask.width+currentX+1]&&mask.getBitXY(currentX+1,currentY)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX+1,yToProcess[to&MAX_ARRAY]=currentY,data[currentY*mask.width+currentX+1]=-32768),currentY<mask.height-1&&0===data[(currentY+1)*mask.width+currentX]&&mask.getBitXY(currentX,currentY+1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX,yToProcess[to&MAX_ARRAY]=currentY+1,data[(currentY+1)*mask.width+currentX]=-32768),allowCorners&&(currentX>0&&currentY>0&&0===data[(currentY-1)*mask.width+currentX-1]&&mask.getBitXY(currentX-1,currentY-1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX-1,yToProcess[to&MAX_ARRAY]=currentY-1,data[(currentY-1)*mask.width+currentX-1]=-32768),currentX<mask.width-1&&currentY>0&&0===data[(currentY-1)*mask.width+currentX+1]&&mask.getBitXY(currentX+1,currentY-1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX+1,yToProcess[to&MAX_ARRAY]=currentY-1,data[(currentY-1)*mask.width+currentX+1]=-32768),currentX>0&&currentY<mask.height-1&&0===data[(currentY+1)*mask.width+currentX-1]&&mask.getBitXY(currentX-1,currentY+1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX-1,yToProcess[to&MAX_ARRAY]=currentY+1,data[(currentY+1)*mask.width+currentX-1]=-32768),currentX<mask.width-1&&currentY<mask.height-1&&0===data[(currentY+1)*mask.width+currentX+1]&&mask.getBitXY(currentX+1,currentY+1)===targetState&&(xToProcess[++to&MAX_ARRAY]=currentX+1,yToProcess[to&MAX_ARRAY]=currentY+1,data[(currentY+1)*mask.width+currentX+1]=-32768)),to-++from>MAX_ARRAY)throw Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new RoiMap(mask,data)}var DisjointSet=__webpack_require__(530),DisjointSet_default=__webpack_require__.n(DisjointSet);let direction4X=[-1,0],direction4Y=[0,-1],neighbours4=[null,null],direction8X=[-1,-1,0,1],direction8Y=[0,-1,-1,-1],neighbours8=[null,null,null,null];function fromMaskConnectedComponentLabelingAlgorithm(mask,options={}){let directionX,directionY,neighboursList;let{allowCorners=!1}=options,neighbours=4;if(allowCorners&&(neighbours=8),8===neighbours)directionX=direction8X,directionY=direction8Y,neighboursList=neighbours8;else if(4===neighbours)directionX=direction4X,directionY=direction4Y,neighboursList=neighbours4;else throw RangeError(`unsupported neighbours count: ${neighbours}`);let size=mask.size,width=mask.width,height=mask.height,labels=Array(size),data=new Uint32Array(size),linked=new(DisjointSet_default()),currentLabel=1;for(let j=0;j<height;j++)for(let i=0;i<width;i++){let index=i+j*width;if(mask.getBit(index)){let smallestNeighbour=null;for(let k=0;k<neighboursList.length;k++){let ii=i+directionX[k],jj=j+directionY[k];if(ii>=0&&jj>=0&&ii<width&&jj<height){let index1=ii+jj*width,neighbour=labels[index1];neighbour?(neighboursList[k]=neighbour,(!smallestNeighbour||neighboursList[k].value<smallestNeighbour.value)&&(smallestNeighbour=neighboursList[k])):neighboursList[k]=null}}if(smallestNeighbour){labels[index]=smallestNeighbour;for(let k1=0;k1<neighboursList.length;k1++)neighboursList[k1]&&neighboursList[k1]!==smallestNeighbour&&linked.union(smallestNeighbour,neighboursList[k1])}else labels[index]=linked.add(currentLabel++)}}for(let j1=0;j1<height;j1++)for(let i1=0;i1<width;i1++){let index2=i1+j1*width;mask.getBit(index2)&&(data[index2]=linked.find(labels[index2]).value)}return new RoiMap(mask,data)}function fromMaxima(options={}){let{allowCorner=!0,onlyTop=!1,invert=!1}=options,image=this;image.checkProcessable("fromMaxima",{components:[1]});let PROCESS_TOP=1,PROCESS_NORMAL=2,positiveID=0,negativeID=0,data=new Int16Array(image.size),processed=new Int8Array(image.size),variations=new Float32Array(image.size),MAX_ARRAY=1048575,xToProcess=new Uint16Array(MAX_ARRAY+1),yToProcess=new Uint16Array(MAX_ARRAY+1),from=0,to=0,xToProcessTop=new Uint16Array(MAX_ARRAY+1),yToProcessTop=new Uint16Array(MAX_ARRAY+1),fromTop=0,toTop=0;for(appendMaxima(image,{maxima:!invert});from<to;)process(xToProcess[from&MAX_ARRAY],yToProcess[from&MAX_ARRAY],PROCESS_NORMAL),from++;return new RoiMap(image,data);function appendMaxima({maxima=!0}){for(let y=1;y<image.height-1;y++)for(let x=1;x<image.width-1;x++){let index=x+y*image.width;if(0===processed[index]){let currentValue=maxima?image.data[index]:-image.data[x+y*image.width];if(image.data[y*image.width+x-1]>currentValue||image.data[y*image.width+x+1]>currentValue||image.data[(y-1)*image.width+x]>currentValue||image.data[(y+1)*image.width+x]>currentValue||allowCorner&&(image.data[(y-1)*image.width+x-1]>currentValue||image.data[(y-1)*image.width+x+1]>currentValue||image.data[(y+1)*image.width+x-1]>currentValue||image.data[(y+1)*image.width+x+1]>currentValue))continue;data[index]=maxima?++positiveID:--negativeID,!processTop(x,y,PROCESS_TOP)&&(maxima?--positiveID:++negativeID)}}}function processTop(xToProcess,yToProcess){let currentTo=to;fromTop=0,toTop=1,xToProcessTop[0]=xToProcess,yToProcessTop[0]=yToProcess;let valid=!0;for(;fromTop<toTop;)valid&=process(xToProcessTop[fromTop&MAX_ARRAY],yToProcessTop[fromTop&MAX_ARRAY],PROCESS_TOP),fromTop++;if(!valid){for(let i=0;i<toTop;i++){let currentX=xToProcessTop[i&MAX_ARRAY];data[yToProcessTop[i&MAX_ARRAY]*image.width+currentX]=0}to=currentTo}return valid}function process(xCenter,yCenter,type){let currentID=data[yCenter*image.width+xCenter],currentValue=image.data[yCenter*image.width+xCenter];for(let y=yCenter-1;y<=yCenter+1;y++)for(let x=xCenter-1;x<=xCenter+1;x++){let index=y*image.width+x;if(0===processed[index])switch(processed[index]=1,variations[index]=image.data[index]-currentValue,type){case PROCESS_TOP:if(0===variations[index]){if(0===x||0===y||x===image.width-1||y===image.height-1)return!1;data[index]=currentID,xToProcessTop[toTop&MAX_ARRAY]=x,yToProcessTop[toTop&MAX_ARRAY]=y,toTop++}else{if(variations[index]>0)return!1;!onlyTop&&(data[index]=currentID,xToProcess[to&MAX_ARRAY]=x,yToProcess[to&MAX_ARRAY]=y,to++)}break;case PROCESS_NORMAL:variations[index]<=0&&(data[index]=currentID,xToProcess[to&MAX_ARRAY]=x,yToProcess[to&MAX_ARRAY]=y,to++);break;default:throw Error("unreachable")}}return!0}}function fromPoints(pointsToPaint,options={}){let shape=new Shape(options),data=new Int16Array(this.size),positiveID=0,shapePoints=shape.getPoints();for(let i=0;i<pointsToPaint.length;i++){positiveID++;let xP=pointsToPaint[i][0],yP=pointsToPaint[i][1];for(let j=0;j<shapePoints.length;j++){let xS=shapePoints[j][0],yS=shapePoints[j][1];xP+xS>=0&&yP+yS>=0&&xP+xS<this.width&&yP+yS<this.height&&(data[xP+xS+(yP+yS)*this.width]=positiveID)}}return new RoiMap(this,data)}var priority_queue=__webpack_require__(5307),priority_queue_default=__webpack_require__.n(priority_queue);let dxs=[1,0,-1,0,1,1,-1,-1],dys=[0,1,0,-1,1,-1,1,-1];function fromWaterShed(options={}){let{points,mask,image,fillMaxValue=this.maxValue,invert=!1}=options,currentImage=image||this;currentImage.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),invert=!invert,points||(points=currentImage.getLocalMaxima({invert,mask}));let maskExpectedValue=invert?0:1,data=new Int16Array(currentImage.size),width=currentImage.width,height=currentImage.height,toProcess=new(priority_queue_default())({comparator:(a,b)=>a[2]-b[2],strategy:priority_queue_default().BinaryHeapStrategy});for(let i=0;i<points.length;i++){let index=points[i][0]+points[i][1]*width;data[index]=i+1;let intensity=currentImage.data[index];(invert&&intensity<=fillMaxValue||!invert&&intensity>=fillMaxValue)&&toProcess.queue([points[i][0],points[i][1],intensity])}for(;toProcess.length>0;){let currentPoint=toProcess.dequeue(),currentValueIndex=currentPoint[0]+currentPoint[1]*width;for(let dir=0;dir<4;dir++){let newX=currentPoint[0]+dxs[dir],newY=currentPoint[1]+dys[dir];if(newX>=0&&newY>=0&&newX<width&&newY<height){let currentNeighbourIndex=newX+newY*width;if(!mask||mask.getBit(currentNeighbourIndex)===maskExpectedValue){let intensity1=currentImage.data[currentNeighbourIndex];(invert&&intensity1<=fillMaxValue||!invert&&intensity1>=fillMaxValue)&&0===data[currentNeighbourIndex]&&(data[currentNeighbourIndex]=data[currentValueIndex],toProcess.queue([currentPoint[0]+dxs[dir],currentPoint[1]+dys[dir],intensity1]))}}}}return new RoiMap(currentImage,data)}class RoiManager{constructor(image,options={}){this._image=image,this._options=options,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(options={}){let opt=Object.assign({},this._options,options),roiMap=fromMaxima.call(this._image,options);this._layers[opt.label]=new RoiLayer(roiMap,opt)}fromPoints(points,options={}){let opt=Object.assign({},this._options,options),roiMap=fromPoints.call(this._image,points,options);return this._layers[opt.label]=new RoiLayer(roiMap,opt),this}putMap(map,options={}){let roiMap=new RoiMap(this._image,map),opt=Object.assign({},this._options,options);return this._layers[opt.label]=new RoiLayer(roiMap,opt),this}fromWaterShed(options={}){let opt=Object.assign({},this._options,options),roiMap=fromWaterShed.call(this._image,options);this._layers[opt.label]=new RoiLayer(roiMap,opt)}fromMask(mask,options={}){let opt=Object.assign({},this._options,options),roiMap=fromMask.call(this._image,mask,options);return this._layers[opt.label]=new RoiLayer(roiMap,opt),this}fromMaskConnectedComponentLabelingAlgorithm(mask,options={}){let opt=Object.assign({},this._options,options),roiMap=fromMaskConnectedComponentLabelingAlgorithm.call(this._image,mask,options);return this._layers[opt.label]=new RoiLayer(roiMap,opt),this}getMap(options={}){let opt=Object.assign({},this._options,options);return this._assertLayerWithLabel(opt.label),this._layers[opt.label].roiMap}rowsInfo(options={}){return this.getMap(options).rowsInfo()}colsInfo(options={}){return this.getMap(options).rowsInfo()}getRoiIds(options={}){let rois=this.getRois(options);if(rois){let ids=Array(rois.length);for(let i=0;i<rois.length;i++)ids[i]=rois[i].id;return ids}throw Error("ROIs not found")}getRois(options={}){let{label=this._options.label,positive=!0,negative=!0,minSurface=0,maxSurface=Number.POSITIVE_INFINITY,minWidth=0,maxWidth=Number.POSITIVE_INFINITY,minHeight=0,maxHeight=Number.POSITIVE_INFINITY,minRatio=0,maxRatio=Number.POSITIVE_INFINITY}=options;if(!this._layers[label])throw Error(`this Roi layer (${label}) does not exist`);let allRois=this._layers[label].roi,rois=[];for(let roi of allRois)(roi.id<0&&negative||roi.id>0&&positive)&&roi.surface>=minSurface&&roi.surface<=maxSurface&&roi.width>=minWidth&&roi.width<=maxWidth&&roi.height>=minHeight&&roi.height<=maxHeight&&roi.ratio>=minRatio&&roi.ratio<=maxRatio&&rois.push(roi);return rois}getRoi(roiId,options={}){let{label=this._options.label}=options;if(!this._layers[label])throw Error(`this Roi layer (${label}) does not exist`);let roi=this._layers[label].roi.find(roi=>roi.id===roiId);if(!roi)throw Error(`found no Roi with id ${roiId}`);return roi}getMasks(options={}){let rois=this.getRois(options),masks=Array(rois.length);for(let i=0;i<rois.length;i++)masks[i]=rois[i].getMask(options);return masks}getAnalysisMasks(options={}){let{analysisProperty}=options,maskProperty=`${analysisProperty}Mask`,rois=this.getRois(options);return 0!==rois.length&&rois[0][maskProperty]?rois.map(roi=>roi[maskProperty]):[]}getData(options={}){let opt=Object.assign({},this._options,options);return this._assertLayerWithLabel(opt.label),this._layers[opt.label].roiMap.data}paint(options={}){let{labelProperty,analysisProperty}=options;this._painted||(this._painted=this._image.rgba8());let masks=this.getMasks(options);if(labelProperty){let rois=this.getRois(options);options.labels=rois.map(roi=>deepValue(roi,labelProperty));let max=Math.max(...options.labels),isSurface=!1,isDistance=!1;if(labelProperty.includes("surface")?isSurface=!0:/(?:perimeter|min|max|external|width|height|length)/.test(labelProperty)&&(isDistance=!0),isFinite(max)){let unitLabel="";if("pixel"!==options.unit&&options.pixelSize&&(isDistance||isSurface)){unitLabel=isSurface?`${options.unit}^2`:options.unit;let siLabel=isSurface?"m^2":"m",factor=isSurface?options.pixelSize**2:options.pixelSize,convert=quantities_default().swiftConverter(siLabel,unitLabel);options.labels=options.labels.map(value=>convert(factor*value))}max>50?options.labels=options.labels.map(number=>Math.round(number)+unitLabel):max>10?options.labels=options.labels.map(number=>number.toFixed(1)+unitLabel):options.labels=options.labels.map(number=>number.toFixed(2)+unitLabel)}options.labelsPosition=rois.map(roi=>[roi.meanX,roi.meanY])}if(this._painted.paintMasks(masks,options),analysisProperty){let analysisMasks=this.getAnalysisMasks(options);this._painted.paintMasks(analysisMasks,{color:options.analysisColor,alpha:options.analysisAlpha})}return this._painted}getMask(options={}){let mask=new Image_Image(this._image.width,this._image.height,{kind:"BINARY"}),masks=this.getMasks(options);for(let i=0;i<masks.length;i++){let roi=masks[i];for(let x=0;x<roi.width;x++)for(let y=0;y<roi.height;y++)roi.getBitXY(x,y)&&mask.setBitXY(x+roi.position[0],y+roi.position[1])}return mask}resetPainted(options={}){let{image}=options;image?this._painted=this.image.rgba8():this._painted=this._image.rgba8()}mergeRoi(options={}){let roiMap=this.getMap(options);return roiMap.mergeRoi(options),this.putMap(roiMap.data,options),this}mergeRois(roiIds,options={}){if(!Array.isArray(roiIds)||roiIds.some(id=>!Number.isInteger(id)))throw Error("Roi ids must be an array of integers");if(roiIds.length<2)throw Error("Roi ids must have at least two elements");if(new Set(roiIds).size!==roiIds.length)throw Error("Roi ids must be all different");roiIds.forEach(roiId=>this.getRoi(roiId));let roiMap=this.getMap(options);return roiMap.mergeRois(roiIds),this.putMap(roiMap.data,options),this}findCorrespondingRoi(roiMap,options={}){let allRois=this.getRois(options),allRelated=[];for(let i=0;i<allRois.length;i++){let currentRoi=allRois[i],currentRelated=correspondingRoisInformation(currentRoi.minX,currentRoi.minY,currentRoi.points,roiMap,Math.sign(currentRoi.id));allRelated.push(currentRelated)}return allRelated}_assertLayerWithLabel(label){if(!this._layers[label])throw Error(`no layer with label ${label}`)}}function correspondingRoisInformation(x,y,points,roiMap,roiSign){let correspondingRois={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let i=0;i<points.length;i++){let currentPoint=points[i],correspondingRoiMapIndex=currentPoint[0]+x+(currentPoint[1]+y)*roiMap.width,value=roiMap.data[correspondingRoiMapIndex];(value>0||value<0)&&(correspondingRois.id.includes(value)?correspondingRois.surface[correspondingRois.id.indexOf(value)]+=1:(correspondingRois.id.push(value),correspondingRois.surface.push(1)))}for(let i1=0;i1<correspondingRois.id.length;i1++)Math.sign(correspondingRois.id[i1])===roiSign?correspondingRois.same+=correspondingRois.surface[i1]:correspondingRois.opposite+=correspondingRois.surface[i1],correspondingRois.roiSurfaceCovered[i1]=correspondingRois.surface[i1]/points.length;return correspondingRois.total=correspondingRois.opposite+correspondingRois.same,correspondingRois}let objectToString=Object.prototype.toString;class Image_Image{constructor(width,height,data,options){if(1==arguments.length?(options=width,{width,height,data}=options):data&&!data.length&&(options=data,{data}=options),void 0===width&&(width=1),void 0===height&&(height=1),void 0===options&&(options={}),"object"!=typeof options||null===options)throw TypeError("options must be an object");if(!Number.isInteger(width)||width<=0)throw RangeError("width must be a positive integer");if(!Number.isInteger(height)||height<=0)throw RangeError("height must be a positive integer");let{kind=RGBA}=options;if("string"!=typeof kind)throw TypeError("kind must be a string");let theKind=getKind(kind),kindDefinition=Object.assign({},options);for(let prop in theKind)void 0===kindDefinition[prop]&&(kindDefinition[prop]=theKind[prop]);verifyKindDefinition(kindDefinition);let{components,bitDepth,colorModel}=kindDefinition,alpha=kindDefinition.alpha+0,size=width*height,channels=components+alpha,maxValue=32===bitDepth?Number.MAX_VALUE:2**bitDepth-1;if(void 0===data)data=createPixelArray(size,components,alpha,channels,bitDepth,maxValue);else{let expectedLength=getTheoreticalPixelArraySize(size,channels,bitDepth);if(data.length!==expectedLength)throw RangeError(`incorrect data size: ${data.length}. Should be ${expectedLength}`)}this.width=width,this.height=height,this.data=data,this.size=size,this.components=components,this.alpha=alpha,this.bitDepth=bitDepth,this.maxValue=maxValue,this.colorModel=colorModel,this.channels=channels,this.meta=options.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:options.parent||null}),this.position=options.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(object){return"[object IJSImage]"===objectToString.call(object)}static fromCanvas(canvas){let ctx=canvas.getContext("2d"),imageData=ctx.getImageData(0,0,canvas.width,canvas.height);return new Image_Image(imageData.width,imageData.height,imageData.data)}static createFrom(other,options){let newOptions=getImageParameters(other);return Object.assign(newOptions,{parent:other,position:[0,0]},options),new Image_Image(newOptions)}getRoiManager(options){return new RoiManager(this,options)}clone(){let newData=this.data.slice();return new Image_Image(this.width,this.height,newData,this)}apply(filter){for(let y=0;y<this.height;y++)for(let x=0;x<this.width;x++){let index=(y*this.width+x)*this.channels;filter.call(this,index)}}}setValueMethods(Image_Image),setBitMethods(Image_Image),setExportMethods(Image_Image),Image_Image.prototype.checkProcessable=checkProcessable,Image_Image.prototype.getRGBAData=getRGBAData,Image_Image.load=load,Image_Image.extendMethod=extendMethod,Image_Image.extendProperty=extendProperty,extend_extend(Image_Image);var web_worker_manager_src=__webpack_require__(6732),web_worker_manager_src_default=__webpack_require__.n(web_worker_manager_src);let background_defaultOptions={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function run(image,options,onStep){options=Object.assign({},background_defaultOptions,options);let manager=this.manager;return Array.isArray(image)?Promise.all(image.map(function(img){let run=runOnce(manager,img,options);return"function"==typeof onStep&&run.then(onStep),run})):runOnce(manager,image,options)}function runOnce(manager,image,options){return manager.post("data",[image,options]).then(function(response){for(let i in response)response[i]=new Image_Image(response[i]);return response})}function work(){worker.on("data",function(send,image,options){image=new IJS(image);let result={},toTransfer=[],grey=image.grey(),sobel=grey.sobelFilter();maybeInclude("sobel",sobel);let mask=sobel.level().mask({threshold:options.threshold});maybeInclude("mask",mask);let roiManager=sobel.getRoiManager();roiManager.fromMask(mask);let realMask=roiManager.getMask(options.roi);maybeInclude("realMask",realMask);let pixels=grey.getPixelsGrid({sampling:options.sampling,mask:realMask}),background=image.getBackground(pixels.xyS,pixels.zS,options.regression);maybeInclude("background",background);let corrected=image.subtract(background);function maybeInclude(name,image){options.include.includes(name)&&(result[name]=image,toTransfer.push(image.data.buffer))}result.result=corrected,toTransfer.push(corrected.data.buffer),send(result,toTransfer)})}let background_background={run,work};var process_background=background_background;function worker_extend_extend(Worker1){Worker1.extendMethod("background",process_background)}class Worker1{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw Error("image worker must be initialized with an URL")}get url(){return this._url}set url(value){if("string"!=typeof value)throw TypeError("worker URL must be a string");this._url=value,this._deps[0]=value}static extendMethod(name,method){let manager,url;let runner={};function run(...args){return manager||(this.checkUrl(),url=this.url,manager=new(web_worker_manager_src_default())(method.work,{deps:url}),runner.manager=manager),method.run.call(runner,...args)}run.reset=function(){manager&&(manager.terminate(),manager=new(web_worker_manager_src_default())(method.work,{deps:url}),runner.manager=manager)},Worker1.prototype[name]=run}}worker_extend_extend(Worker1),new Worker1},9184:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let fileType=__webpack_require__(7769),imageExts=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),imageType=input=>{let ret=fileType(input);return imageExts.has(ret&&ret.ext)?ret:null};module.exports=imageType,module.exports.default=imageType,Object.defineProperty(imageType,"minimumBytes",{value:fileType.minimumBytes})},4495:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";function decode(bytes,encoding="utf8"){let decoder=new TextDecoder(encoding);return decoder.decode(bytes)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IOBuffer:function(){return IOBuffer}});let encoder=new TextEncoder;function encode(str){return encoder.encode(str)}let defaultByteLength=8192,hostBigEndian=(()=>{let array=new Uint8Array(4),view=new Uint32Array(array.buffer);return!((view[0]=1)&array[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(data=defaultByteLength,options={}){let dataIsGiven=!1;"number"==typeof data?data=new ArrayBuffer(data):(dataIsGiven=!0,this.lastWrittenByte=data.byteLength);let offset=options.offset?options.offset>>>0:0,byteLength=data.byteLength-offset,dvOffset=offset;(ArrayBuffer.isView(data)||data instanceof IOBuffer)&&(data.byteLength!==data.buffer.byteLength&&(dvOffset=data.byteOffset+offset),data=data.buffer),dataIsGiven?this.lastWrittenByte=byteLength:this.lastWrittenByte=0,this.buffer=data,this.length=byteLength,this.byteLength=byteLength,this.byteOffset=dvOffset,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,dvOffset,byteLength),this._mark=0,this._marks=[]}available(byteLength=1){return this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(n=1){return this.offset+=n,this}back(n=1){return this.offset-=n,this}seek(offset){return this.offset=offset,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){let offset=this._marks.pop();if(void 0===offset)throw Error("Mark stack empty");return this.seek(offset),this}rewind(){return this.offset=0,this}ensureAvailable(byteLength=1){if(!this.available(byteLength)){let lengthNeeded=this.offset+byteLength,newLength=2*lengthNeeded,newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=newLength,this.byteLength=newLength,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n=1){return this.readArray(n,"uint8")}readArray(size,type){let bytes=typedArrays[type].BYTES_PER_ELEMENT*size,offset=this.byteOffset+this.offset,slice=this.buffer.slice(offset,offset+bytes);if(this.littleEndian===hostBigEndian&&"uint8"!==type&&"int8"!==type){let slice1=new Uint8Array(this.buffer.slice(offset,offset+bytes));slice1.reverse();let returnArray=new typedArrays[type](slice1.buffer);return this.offset+=bytes,returnArray.reverse(),returnArray}let returnArray1=new typedArrays[type](slice);return this.offset+=bytes,returnArray1}readInt16(){let value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){let value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){let value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){let value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){let value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){let value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readBigInt64(){let value=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,value}readBigUint64(){let value=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n=1){let result="";for(let i=0;i<n;i++)result+=this.readChar();return result}readUtf8(n=1){return decode(this.readBytes(n))}decodeText(n=1,encoding="utf8"){return decode(this.readBytes(n),encoding)}writeBoolean(value){return this.writeUint8(value?255:0),this}writeInt8(value){return this.ensureAvailable(1),this._data.setInt8(this.offset++,value),this._updateLastWrittenByte(),this}writeUint8(value){return this.ensureAvailable(1),this._data.setUint8(this.offset++,value),this._updateLastWrittenByte(),this}writeByte(value){return this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(let i=0;i<bytes.length;i++)this._data.setUint8(this.offset++,bytes[i]);return this._updateLastWrittenByte(),this}writeInt16(value){return this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(value){return this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(value){return this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(value){return this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(value){return this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(value){return this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(value){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(value){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(str){return this.writeUint8(str.charCodeAt(0))}writeChars(str){for(let i=0;i<str.length;i++)this.writeUint8(str.charCodeAt(i));return this}writeUtf8(str){return this.writeBytes(encode(str))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},4091:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{isAnyArray:function(){return isAnyArray}});let toString=Object.prototype.toString;function isAnyArray(value){let tag=toString.call(value);return tag.endsWith("Array]")&&!tag.includes("Big")}},7811:function(module){"use strict";var toString=Object.prototype.toString;module.exports=function(value){return"Array"===toString.call(value).substr(-6,5)}},1867:function(module){"use strict";module.exports=Number.isFinite||function(value){return!("number"!=typeof value||value!=value||value===1/0||value===-1/0)}},8336:function(module,__unused_webpack_exports,__webpack_require__){var isFinite1=__webpack_require__(1867);module.exports=Number.isInteger||function(val){return"number"==typeof val&&isFinite1(val)&&Math.floor(val)===val}},7870:function(module,__unused_webpack_exports,__webpack_require__){var encode=__webpack_require__(587),decode=__webpack_require__(914);module.exports={encode:encode,decode:decode}},914:function(module,__unused_webpack_exports,__webpack_require__){var Buffer=__webpack_require__(1876).Buffer,JpegImage=function(){"use strict";var dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),dctCos1=4017,dctSin1=799,dctCos3=3406,dctSin3=2276,dctCos6=1567,dctSin6=3784,dctSqrt2=5793,dctSqrt1d2=2896;function constructor(){}function buildHuffmanTable(codeLengths,values){for(var i,j,k=0,code=[],length=16;length>0&&!codeLengths[length-1];)length--;code.push({children:[],index:0});var q,p=code[0];for(i=0;i<length;i++){for(j=0;j<codeLengths[i];j++){for((p=code.pop()).children[p.index]=values[k];p.index>0;){if(0===code.length)throw Error("Could not recreate Huffman Table");p=code.pop()}for(p.index++,code.push(p);code.length<=i;)code.push(q={children:[],index:0}),p.children[p.index]=q.children,p=q;k++}i+1<length&&(code.push(q={children:[],index:0}),p.children[p.index]=q.children,p=q)}return code[0].children}function decodeScan(data,offset,frame,components,resetInterval,spectralStart,spectralEnd,successivePrev,successive,opts){frame.precision,frame.samplesPerLine,frame.scanLines;var mcuExpected,h,v,mcusPerLine=frame.mcusPerLine,progressive=frame.progressive;frame.maxH,frame.maxV;var startOffset=offset,bitsData=0,bitsCount=0;function readBit(){if(bitsCount>0)return bitsData>>--bitsCount&1;if(255==(bitsData=data[offset++])){var nextByte=data[offset++];if(nextByte)throw Error("unexpected marker: "+(bitsData<<8|nextByte).toString(16))}return bitsCount=7,bitsData>>>7}function decodeHuffman(tree){for(var bit,node=tree;null!==(bit=readBit());){if("number"==typeof(node=node[bit]))return node;if("object"!=typeof node)throw Error("invalid huffman sequence")}return null}function receive(length){for(var n=0;length>0;){var bit=readBit();if(null===bit)return;n=n<<1|bit,length--}return n}function receiveAndExtend(length){var n=receive(length);return n>=1<<length-1?n:n+(-1<<length)+1}function decodeBaseline(component,zz){var t=decodeHuffman(component.huffmanTableDC),diff=0===t?0:receiveAndExtend(t);zz[0]=component.pred+=diff;for(var k=1;k<64;){var rs=decodeHuffman(component.huffmanTableAC),s=15&rs,r=rs>>4;if(0===s){if(r<15)break;k+=16;continue}zz[dctZigZag[k+=r]]=receiveAndExtend(s),k++}}function decodeDCFirst(component,zz){var t=decodeHuffman(component.huffmanTableDC),diff=0===t?0:receiveAndExtend(t)<<successive;zz[0]=component.pred+=diff}function decodeDCSuccessive(component,zz){zz[0]|=readBit()<<successive}var eobrun=0;function decodeACFirst(component,zz){if(eobrun>0){eobrun--;return}for(var k=spectralStart,e=spectralEnd;k<=e;){var rs=decodeHuffman(component.huffmanTableAC),s=15&rs,r=rs>>4;if(0===s){if(r<15){eobrun=receive(r)+(1<<r)-1;break}k+=16;continue}zz[dctZigZag[k+=r]]=receiveAndExtend(s)*(1<<successive),k++}}var successiveACNextValue,successiveACState=0;function decodeACSuccessive(component,zz){for(var k=spectralStart,e=spectralEnd,r=0;k<=e;){var z=dctZigZag[k],direction=zz[z]<0?-1:1;switch(successiveACState){case 0:var rs=decodeHuffman(component.huffmanTableAC),s=15&rs,r=rs>>4;if(0===s)r<15?(eobrun=receive(r)+(1<<r),successiveACState=4):(r=16,successiveACState=1);else{if(1!==s)throw Error("invalid ACn encoding");successiveACNextValue=receiveAndExtend(s),successiveACState=r?2:3}continue;case 1:case 2:zz[z]?zz[z]+=(readBit()<<successive)*direction:0==--r&&(successiveACState=2==successiveACState?3:0);break;case 3:zz[z]?zz[z]+=(readBit()<<successive)*direction:(zz[z]=successiveACNextValue<<successive,successiveACState=0);break;case 4:zz[z]&&(zz[z]+=(readBit()<<successive)*direction)}k++}4===successiveACState&&0==--eobrun&&(successiveACState=0)}function decodeMcu(component,decode,mcu,row,col){var mcuRow=mcu/mcusPerLine|0,mcuCol=mcu%mcusPerLine,blockRow=mcuRow*component.v+row,blockCol=mcuCol*component.h+col;void 0===component.blocks[blockRow]&&opts.tolerantDecoding||decode(component,component.blocks[blockRow][blockCol])}function decodeBlock(component,decode,mcu){var blockRow=mcu/component.blocksPerLine|0,blockCol=mcu%component.blocksPerLine;void 0===component.blocks[blockRow]&&opts.tolerantDecoding||decode(component,component.blocks[blockRow][blockCol])}var componentsLength=components.length;decodeFn=progressive?0===spectralStart?0===successivePrev?decodeDCFirst:decodeDCSuccessive:0===successivePrev?decodeACFirst:decodeACSuccessive:decodeBaseline;var component,i,j,k,n,decodeFn,marker,mcu=0;for(mcuExpected=1==componentsLength?components[0].blocksPerLine*components[0].blocksPerColumn:mcusPerLine*frame.mcusPerColumn,resetInterval||(resetInterval=mcuExpected);mcu<mcuExpected;){for(i=0;i<componentsLength;i++)components[i].pred=0;if(eobrun=0,1==componentsLength)for(n=0,component=components[0];n<resetInterval;n++)decodeBlock(component,decodeFn,mcu),mcu++;else for(n=0;n<resetInterval;n++){for(i=0;i<componentsLength;i++)for(j=0,h=(component=components[i]).h,v=component.v;j<v;j++)for(k=0;k<h;k++)decodeMcu(component,decodeFn,mcu,j,k);if(++mcu===mcuExpected)break}if(mcu===mcuExpected)do{if(255===data[offset]&&0!==data[offset+1])break;offset+=1}while(offset<data.length-2);if(bitsCount=0,(marker=data[offset]<<8|data[offset+1])<65280)throw Error("marker was not found");if(marker>=65488&&marker<=65495)offset+=2;else break}return offset-startOffset}function buildComponentData(frame,component){var i,j,lines=[],blocksPerLine=component.blocksPerLine,blocksPerColumn=component.blocksPerColumn,samplesPerLine=blocksPerLine<<3,R=new Int32Array(64),r=new Uint8Array(64);function quantizeAndInverse(zz,dataOut,dataIn){var v0,v1,v2,v3,v4,v5,v6,v7,t,i,qt=component.quantizationTable,p=dataIn;for(i=0;i<64;i++)p[i]=zz[i]*qt[i];for(i=0;i<8;++i){var row=8*i;if(0==p[1+row]&&0==p[2+row]&&0==p[3+row]&&0==p[4+row]&&0==p[5+row]&&0==p[6+row]&&0==p[7+row]){t=dctSqrt2*p[0+row]+512>>10,p[0+row]=t,p[1+row]=t,p[2+row]=t,p[3+row]=t,p[4+row]=t,p[5+row]=t,p[6+row]=t,p[7+row]=t;continue}v0=dctSqrt2*p[0+row]+128>>8,v1=dctSqrt2*p[4+row]+128>>8,v2=p[2+row],v3=p[6+row],v4=dctSqrt1d2*(p[1+row]-p[7+row])+128>>8,v7=dctSqrt1d2*(p[1+row]+p[7+row])+128>>8,v5=p[3+row]<<4,v6=p[5+row]<<4,t=v0-v1+1>>1,v0=v0+v1+1>>1,v1=t,t=v2*dctSin6+v3*dctCos6+128>>8,v2=v2*dctCos6-v3*dctSin6+128>>8,v3=t,t=v4-v6+1>>1,v4=v4+v6+1>>1,v6=t,t=v7+v5+1>>1,v5=v7-v5+1>>1,v7=t,t=v0-v3+1>>1,v0=v0+v3+1>>1,v3=t,t=v1-v2+1>>1,v1=v1+v2+1>>1,v2=t,t=v4*dctSin3+v7*dctCos3+2048>>12,v4=v4*dctCos3-v7*dctSin3+2048>>12,v7=t,t=v5*dctSin1+v6*dctCos1+2048>>12,v5=v5*dctCos1-v6*dctSin1+2048>>12,v6=t,p[0+row]=v0+v7,p[7+row]=v0-v7,p[1+row]=v1+v6,p[6+row]=v1-v6,p[2+row]=v2+v5,p[5+row]=v2-v5,p[3+row]=v3+v4,p[4+row]=v3-v4}for(i=0;i<8;++i){var col=i;if(0==p[8+col]&&0==p[16+col]&&0==p[24+col]&&0==p[32+col]&&0==p[40+col]&&0==p[48+col]&&0==p[56+col]){t=dctSqrt2*dataIn[i+0]+8192>>14,p[0+col]=t,p[8+col]=t,p[16+col]=t,p[24+col]=t,p[32+col]=t,p[40+col]=t,p[48+col]=t,p[56+col]=t;continue}v0=dctSqrt2*p[0+col]+2048>>12,v1=dctSqrt2*p[32+col]+2048>>12,v2=p[16+col],v3=p[48+col],v4=dctSqrt1d2*(p[8+col]-p[56+col])+2048>>12,v7=dctSqrt1d2*(p[8+col]+p[56+col])+2048>>12,v5=p[24+col],v6=p[40+col],t=v0-v1+1>>1,v0=v0+v1+1>>1,v1=t,t=v2*dctSin6+v3*dctCos6+2048>>12,v2=v2*dctCos6-v3*dctSin6+2048>>12,v3=t,t=v4-v6+1>>1,v4=v4+v6+1>>1,v6=t,t=v7+v5+1>>1,v5=v7-v5+1>>1,v7=t,t=v0-v3+1>>1,v0=v0+v3+1>>1,v3=t,t=v1-v2+1>>1,v1=v1+v2+1>>1,v2=t,t=v4*dctSin3+v7*dctCos3+2048>>12,v4=v4*dctCos3-v7*dctSin3+2048>>12,v7=t,t=v5*dctSin1+v6*dctCos1+2048>>12,v5=v5*dctCos1-v6*dctSin1+2048>>12,v6=t,p[0+col]=v0+v7,p[56+col]=v0-v7,p[8+col]=v1+v6,p[48+col]=v1-v6,p[16+col]=v2+v5,p[40+col]=v2-v5,p[24+col]=v3+v4,p[32+col]=v3-v4}for(i=0;i<64;++i){var sample=128+(p[i]+8>>4);dataOut[i]=sample<0?0:sample>255?255:sample}}requestMemoryAllocation(samplesPerLine*blocksPerColumn*8);for(var blockRow=0;blockRow<blocksPerColumn;blockRow++){var scanLine=blockRow<<3;for(i=0;i<8;i++)lines.push(new Uint8Array(samplesPerLine));for(var blockCol=0;blockCol<blocksPerLine;blockCol++){quantizeAndInverse(component.blocks[blockRow][blockCol],r,R);var offset=0,sample=blockCol<<3;for(j=0;j<8;j++){var line=lines[scanLine+j];for(i=0;i<8;i++)line[sample+i]=r[offset++]}}}return lines}function clampTo8bit(a){return a<0?0:a>255?255:a}constructor.prototype={load:function(path){var xhr=new XMLHttpRequest;xhr.open("GET",path,!0),xhr.responseType="arraybuffer",xhr.onload=(function(){var data=new Uint8Array(xhr.response||xhr.mozResponseArrayBuffer);this.parse(data),this.onload&&this.onload()}).bind(this),xhr.send(null)},parse:function(data){var maxResolutionInPixels=1e6*this.opts.maxResolutionInMP,offset=0;function readUint16(){var value=data[offset]<<8|data[offset+1];return offset+=2,value}function readDataBlock(){var length=readUint16(),array=data.subarray(offset,offset+length-2);return offset+=array.length,array}function prepareComponents(frame){var component,componentId,maxH=1,maxV=1;for(componentId in frame.components)frame.components.hasOwnProperty(componentId)&&(component=frame.components[componentId],maxH<component.h&&(maxH=component.h),maxV<component.v&&(maxV=component.v));var mcusPerLine=Math.ceil(frame.samplesPerLine/8/maxH),mcusPerColumn=Math.ceil(frame.scanLines/8/maxV);for(componentId in frame.components)if(frame.components.hasOwnProperty(componentId)){component=frame.components[componentId];var blocksPerLine=Math.ceil(Math.ceil(frame.samplesPerLine/8)*component.h/maxH),blocksPerColumn=Math.ceil(Math.ceil(frame.scanLines/8)*component.v/maxV),blocksPerLineForMcu=mcusPerLine*component.h,blocksPerColumnForMcu=mcusPerColumn*component.v,blocks=[];requestMemoryAllocation(256*(blocksPerColumnForMcu*blocksPerLineForMcu));for(var i=0;i<blocksPerColumnForMcu;i++){for(var row=[],j=0;j<blocksPerLineForMcu;j++)row.push(new Int32Array(64));blocks.push(row)}component.blocksPerLine=blocksPerLine,component.blocksPerColumn=blocksPerColumn,component.blocks=blocks}frame.maxH=maxH,frame.maxV=maxV,frame.mcusPerLine=mcusPerLine,frame.mcusPerColumn=mcusPerColumn}data.length;var jfif=null,adobe=null,quantizationTables=[],frames=[],huffmanTablesAC=[],huffmanTablesDC=[],fileMarker=readUint16(),malformedDataOffset=-1;if(this.comments=[],65496!=fileMarker)throw Error("SOI not found");for(fileMarker=readUint16();65497!=fileMarker;){switch(fileMarker){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var appData=readDataBlock();if(65534===fileMarker){var comment=String.fromCharCode.apply(null,appData);this.comments.push(comment)}65504===fileMarker&&74===appData[0]&&70===appData[1]&&73===appData[2]&&70===appData[3]&&0===appData[4]&&(jfif={version:{major:appData[5],minor:appData[6]},densityUnits:appData[7],xDensity:appData[8]<<8|appData[9],yDensity:appData[10]<<8|appData[11],thumbWidth:appData[12],thumbHeight:appData[13],thumbData:appData.subarray(14,14+3*appData[12]*appData[13])}),65505===fileMarker&&69===appData[0]&&120===appData[1]&&105===appData[2]&&102===appData[3]&&0===appData[4]&&(this.exifBuffer=appData.subarray(5,appData.length)),65518===fileMarker&&65===appData[0]&&100===appData[1]&&111===appData[2]&&98===appData[3]&&101===appData[4]&&0===appData[5]&&(adobe={version:appData[6],flags0:appData[7]<<8|appData[8],flags1:appData[9]<<8|appData[10],transformCode:appData[11]});break;case 65499:for(var quantizationTablesEnd=readUint16()+offset-2;offset<quantizationTablesEnd;){var quantizationTableSpec=data[offset++];requestMemoryAllocation(256);var tableData=new Int32Array(64);if(quantizationTableSpec>>4==0)for(j=0;j<64;j++){var z=dctZigZag[j];tableData[z]=data[offset++]}else if(quantizationTableSpec>>4==1)for(j=0;j<64;j++){var z=dctZigZag[j];tableData[z]=readUint16()}else throw Error("DQT: invalid table spec");quantizationTables[15&quantizationTableSpec]=tableData}break;case 65472:case 65473:case 65474:readUint16(),(frame={}).extended=65473===fileMarker,frame.progressive=65474===fileMarker,frame.precision=data[offset++],frame.scanLines=readUint16(),frame.samplesPerLine=readUint16(),frame.components={},frame.componentsOrder=[];var pixelsInFrame=frame.scanLines*frame.samplesPerLine;if(pixelsInFrame>maxResolutionInPixels)throw Error(`maxResolutionInMP limit exceeded by ${Math.ceil((pixelsInFrame-maxResolutionInPixels)/1e6)}MP`);var frame,resetInterval,i,j,componentId,componentsCount=data[offset++];for(i=0;i<componentsCount;i++){componentId=data[offset];var h=data[offset+1]>>4,v=15&data[offset+1],qId=data[offset+2];if(h<=0||v<=0)throw Error("Invalid sampling factor, expected values above 0");frame.componentsOrder.push(componentId),frame.components[componentId]={h:h,v:v,quantizationIdx:qId},offset+=3}prepareComponents(frame),frames.push(frame);break;case 65476:var huffmanLength=readUint16();for(i=2;i<huffmanLength;){var huffmanTableSpec=data[offset++],codeLengths=new Uint8Array(16),codeLengthSum=0;for(j=0;j<16;j++,offset++)codeLengthSum+=codeLengths[j]=data[offset];requestMemoryAllocation(16+codeLengthSum);var huffmanValues=new Uint8Array(codeLengthSum);for(j=0;j<codeLengthSum;j++,offset++)huffmanValues[j]=data[offset];i+=17+codeLengthSum,(huffmanTableSpec>>4==0?huffmanTablesDC:huffmanTablesAC)[15&huffmanTableSpec]=buildHuffmanTable(codeLengths,huffmanValues)}break;case 65501:readUint16(),resetInterval=readUint16();break;case 65500:readUint16(),readUint16();break;case 65498:readUint16();var component,selectorsCount=data[offset++],components=[];for(i=0;i<selectorsCount;i++){component=frame.components[data[offset++]];var tableSpec=data[offset++];component.huffmanTableDC=huffmanTablesDC[tableSpec>>4],component.huffmanTableAC=huffmanTablesAC[15&tableSpec],components.push(component)}var spectralStart=data[offset++],spectralEnd=data[offset++],successiveApproximation=data[offset++],processed=decodeScan(data,offset,frame,components,resetInterval,spectralStart,spectralEnd,successiveApproximation>>4,15&successiveApproximation,this.opts);offset+=processed;break;case 65535:255!==data[offset]&&offset--;break;default:if(255==data[offset-3]&&data[offset-2]>=192&&data[offset-2]<=254){offset-=3;break}if(224===fileMarker||225==fileMarker){if(-1!==malformedDataOffset)throw Error(`first unknown JPEG marker at offset ${malformedDataOffset.toString(16)}, second unknown JPEG marker ${fileMarker.toString(16)} at offset ${(offset-1).toString(16)}`);malformedDataOffset=offset-1;let nextOffset=readUint16();if(255===data[offset+nextOffset-2]){offset+=nextOffset-2;break}}throw Error("unknown JPEG marker "+fileMarker.toString(16))}fileMarker=readUint16()}if(1!=frames.length)throw Error("only single frame JPEGs supported");for(var i=0;i<frames.length;i++){var cp=frames[i].components;for(var j in cp)cp[j].quantizationTable=quantizationTables[cp[j].quantizationIdx],delete cp[j].quantizationIdx}this.width=frame.samplesPerLine,this.height=frame.scanLines,this.jfif=jfif,this.adobe=adobe,this.components=[];for(var i=0;i<frame.componentsOrder.length;i++){var component=frame.components[frame.componentsOrder[i]];this.components.push({lines:buildComponentData(frame,component),scaleX:component.h/frame.maxH,scaleY:component.v/frame.maxV})}},getData:function(width,height){var component1,component2,component3,component4,component1Line,component2Line,component3Line,component4Line,x,y,Y,Cb,Cr,K,C,M,Ye,R,G,B,colorTransform,scaleX=this.width/width,scaleY=this.height/height,offset=0,dataLength=width*height*this.components.length;requestMemoryAllocation(dataLength);var data=new Uint8Array(dataLength);switch(this.components.length){case 1:for(y=0,component1=this.components[0];y<height;y++)for(x=0,component1Line=component1.lines[0|y*component1.scaleY*scaleY];x<width;x++)Y=component1Line[0|x*component1.scaleX*scaleX],data[offset++]=Y;break;case 2:for(y=0,component1=this.components[0],component2=this.components[1];y<height;y++)for(x=0,component1Line=component1.lines[0|y*component1.scaleY*scaleY],component2Line=component2.lines[0|y*component2.scaleY*scaleY];x<width;x++)Y=component1Line[0|x*component1.scaleX*scaleX],data[offset++]=Y,Y=component2Line[0|x*component2.scaleX*scaleX],data[offset++]=Y;break;case 3:for(colorTransform=!0,this.adobe&&this.adobe.transformCode?colorTransform=!0:void 0!==this.opts.colorTransform&&(colorTransform=!!this.opts.colorTransform),component1=this.components[0],component2=this.components[1],component3=this.components[2],y=0;y<height;y++)for(x=0,component1Line=component1.lines[0|y*component1.scaleY*scaleY],component2Line=component2.lines[0|y*component2.scaleY*scaleY],component3Line=component3.lines[0|y*component3.scaleY*scaleY];x<width;x++)colorTransform?(Y=component1Line[0|x*component1.scaleX*scaleX],Cb=component2Line[0|x*component2.scaleX*scaleX],R=clampTo8bit(Y+1.402*((Cr=component3Line[0|x*component3.scaleX*scaleX])-128)),G=clampTo8bit(Y-.3441363*(Cb-128)-.71413636*(Cr-128)),B=clampTo8bit(Y+1.772*(Cb-128))):(R=component1Line[0|x*component1.scaleX*scaleX],G=component2Line[0|x*component2.scaleX*scaleX],B=component3Line[0|x*component3.scaleX*scaleX]),data[offset++]=R,data[offset++]=G,data[offset++]=B;break;case 4:if(!this.adobe)throw Error("Unsupported color mode (4 components)");for(colorTransform=!1,this.adobe&&this.adobe.transformCode?colorTransform=!0:void 0!==this.opts.colorTransform&&(colorTransform=!!this.opts.colorTransform),component1=this.components[0],component2=this.components[1],component3=this.components[2],component4=this.components[3],y=0;y<height;y++)for(x=0,component1Line=component1.lines[0|y*component1.scaleY*scaleY],component2Line=component2.lines[0|y*component2.scaleY*scaleY],component3Line=component3.lines[0|y*component3.scaleY*scaleY],component4Line=component4.lines[0|y*component4.scaleY*scaleY];x<width;x++)colorTransform?(Y=component1Line[0|x*component1.scaleX*scaleX],Cb=component2Line[0|x*component2.scaleX*scaleX],Cr=component3Line[0|x*component3.scaleX*scaleX],K=component4Line[0|x*component4.scaleX*scaleX],C=255-clampTo8bit(Y+1.402*(Cr-128)),M=255-clampTo8bit(Y-.3441363*(Cb-128)-.71413636*(Cr-128)),Ye=255-clampTo8bit(Y+1.772*(Cb-128))):(C=component1Line[0|x*component1.scaleX*scaleX],M=component2Line[0|x*component2.scaleX*scaleX],Ye=component3Line[0|x*component3.scaleX*scaleX],K=component4Line[0|x*component4.scaleX*scaleX]),data[offset++]=255-C,data[offset++]=255-M,data[offset++]=255-Ye,data[offset++]=255-K;break;default:throw Error("Unsupported color mode")}return data},copyToImageData:function(imageData,formatAsRGBA){var Y,K,C,M,R,G,B,x,y,width=imageData.width,height=imageData.height,imageDataArray=imageData.data,data=this.getData(width,height),i=0,j=0;switch(this.components.length){case 1:for(y=0;y<height;y++)for(x=0;x<width;x++)Y=data[i++],imageDataArray[j++]=Y,imageDataArray[j++]=Y,imageDataArray[j++]=Y,formatAsRGBA&&(imageDataArray[j++]=255);break;case 3:for(y=0;y<height;y++)for(x=0;x<width;x++)R=data[i++],G=data[i++],B=data[i++],imageDataArray[j++]=R,imageDataArray[j++]=G,imageDataArray[j++]=B,formatAsRGBA&&(imageDataArray[j++]=255);break;case 4:for(y=0;y<height;y++)for(x=0;x<width;x++)C=data[i++],M=data[i++],Y=data[i++],R=255-clampTo8bit(C*(1-(K=data[i++])/255)+K),G=255-clampTo8bit(M*(1-K/255)+K),B=255-clampTo8bit(Y*(1-K/255)+K),imageDataArray[j++]=R,imageDataArray[j++]=G,imageDataArray[j++]=B,formatAsRGBA&&(imageDataArray[j++]=255);break;default:throw Error("Unsupported color mode")}}};var totalBytesAllocated=0,maxMemoryUsageBytes=0;function requestMemoryAllocation(increaseAmount=0){var totalMemoryImpactBytes=totalBytesAllocated+increaseAmount;if(totalMemoryImpactBytes>maxMemoryUsageBytes)throw Error(`maxMemoryUsageInMB limit exceeded by at least ${Math.ceil((totalMemoryImpactBytes-maxMemoryUsageBytes)/1024/1024)}MB`);totalBytesAllocated=totalMemoryImpactBytes}return constructor.resetMaxMemoryUsage=function(maxMemoryUsageBytes_){totalBytesAllocated=0,maxMemoryUsageBytes=maxMemoryUsageBytes_},constructor.getBytesAllocated=function(){return totalBytesAllocated},constructor.requestMemoryAllocation=requestMemoryAllocation,constructor}();function decode(jpegData,userOpts={}){var opts={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...userOpts},arr=new Uint8Array(jpegData),decoder=new JpegImage;decoder.opts=opts,JpegImage.resetMaxMemoryUsage(1048576*opts.maxMemoryUsageInMB),decoder.parse(arr);var channels=opts.formatAsRGBA?4:3,bytesNeeded=decoder.width*decoder.height*channels;try{JpegImage.requestMemoryAllocation(bytesNeeded);var image={width:decoder.width,height:decoder.height,exifBuffer:decoder.exifBuffer,data:opts.useTArray?new Uint8Array(bytesNeeded):Buffer.alloc(bytesNeeded)};decoder.comments.length>0&&(image.comments=decoder.comments)}catch(err){if(err instanceof RangeError)throw Error("Could not allocate enough memory for the image. Required: "+bytesNeeded);if(err instanceof ReferenceError&&"Buffer is not defined"===err.message)throw Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw err}return decoder.copyToImageData(image,opts.formatAsRGBA),image}module.exports=decode},587:function(module,__unused_webpack_exports,__webpack_require__){var Buffer=__webpack_require__(1876).Buffer,btoa=btoa||function(buf){return Buffer.from(buf).toString("base64")};function JPEGEncoder(quality){var YDC_HT,UVDC_HT,YAC_HT,UVAC_HT,currentQuality,ffloor=Math.floor,YTable=Array(64),UVTable=Array(64),fdtbl_Y=Array(64),fdtbl_UV=Array(64),bitcode=Array(65535),category=Array(65535),outputfDCTQuant=Array(64),DU=Array(64),byteout=[],bytenew=0,bytepos=7,YDU=Array(64),UDU=Array(64),VDU=Array(64),clt=Array(256),RGB_YUV_TABLE=Array(2048),ZigZag=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],std_dc_luminance_nrcodes=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],std_dc_luminance_values=[0,1,2,3,4,5,6,7,8,9,10,11],std_ac_luminance_nrcodes=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],std_ac_luminance_values=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],std_dc_chrominance_nrcodes=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],std_dc_chrominance_values=[0,1,2,3,4,5,6,7,8,9,10,11],std_ac_chrominance_nrcodes=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],std_ac_chrominance_values=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function initQuantTables(sf){for(var YQT=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var t=ffloor((YQT[i]*sf+50)/100);t<1?t=1:t>255&&(t=255),YTable[ZigZag[i]]=t}for(var UVQT=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],j=0;j<64;j++){var u=ffloor((UVQT[j]*sf+50)/100);u<1?u=1:u>255&&(u=255),UVTable[ZigZag[j]]=u}for(var aasf=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],k=0,row=0;row<8;row++)for(var col=0;col<8;col++)fdtbl_Y[k]=1/(YTable[ZigZag[k]]*aasf[row]*aasf[col]*8),fdtbl_UV[k]=1/(UVTable[ZigZag[k]]*aasf[row]*aasf[col]*8),k++}function computeHuffmanTbl(nrcodes,std_table){for(var codevalue=0,pos_in_table=0,HT=[],k=1;k<=16;k++){for(var j=1;j<=nrcodes[k];j++)HT[std_table[pos_in_table]]=[],HT[std_table[pos_in_table]][0]=codevalue,HT[std_table[pos_in_table]][1]=k,pos_in_table++,codevalue++;codevalue*=2}return HT}function initHuffmanTbl(){YDC_HT=computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values),UVDC_HT=computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values),YAC_HT=computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values),UVAC_HT=computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values)}function initCategoryNumber(){for(var nrlower=1,nrupper=2,cat=1;cat<=15;cat++){for(var nr=nrlower;nr<nrupper;nr++)category[32767+nr]=cat,bitcode[32767+nr]=[],bitcode[32767+nr][1]=cat,bitcode[32767+nr][0]=nr;for(var nrneg=-(nrupper-1);nrneg<=-nrlower;nrneg++)category[32767+nrneg]=cat,bitcode[32767+nrneg]=[],bitcode[32767+nrneg][1]=cat,bitcode[32767+nrneg][0]=nrupper-1+nrneg;nrlower<<=1,nrupper<<=1}}function initRGBYUVTable(){for(var i=0;i<256;i++)RGB_YUV_TABLE[i]=19595*i,RGB_YUV_TABLE[i+256>>0]=38470*i,RGB_YUV_TABLE[i+512>>0]=7471*i+32768,RGB_YUV_TABLE[i+768>>0]=-11059*i,RGB_YUV_TABLE[i+1024>>0]=-21709*i,RGB_YUV_TABLE[i+1280>>0]=32768*i+8421375,RGB_YUV_TABLE[i+1536>>0]=-27439*i,RGB_YUV_TABLE[i+1792>>0]=-5329*i}function writeBits(bs){for(var value=bs[0],posval=bs[1]-1;posval>=0;)value&1<<posval&&(bytenew|=1<<bytepos),posval--,--bytepos<0&&(255==bytenew?(writeByte(255),writeByte(0)):writeByte(bytenew),bytepos=7,bytenew=0)}function writeByte(value){byteout.push(value)}function writeWord(value){writeByte(value>>8&255),writeByte(255&value)}function fDCTQuant(data,fdtbl){var d0,d1,d2,d3,d4,d5,d6,d7,i,fDCTQuant,dataOff=0,I8=8,I64=64;for(i=0;i<I8;++i){d0=data[dataOff],d1=data[dataOff+1],d2=data[dataOff+2],d3=data[dataOff+3],d4=data[dataOff+4],d5=data[dataOff+5],d6=data[dataOff+6];var tmp0=d0+(d7=data[dataOff+7]),tmp7=d0-d7,tmp1=d1+d6,tmp6=d1-d6,tmp2=d2+d5,tmp5=d2-d5,tmp3=d3+d4,tmp4=d3-d4,tmp10=tmp0+tmp3,tmp13=tmp0-tmp3,tmp11=tmp1+tmp2,tmp12=tmp1-tmp2;data[dataOff]=tmp10+tmp11,data[dataOff+4]=tmp10-tmp11;var z1=(tmp12+tmp13)*.707106781;data[dataOff+2]=tmp13+z1,data[dataOff+6]=tmp13-z1,tmp10=tmp4+tmp5,tmp11=tmp5+tmp6;var z5=(tmp10-(tmp12=tmp6+tmp7))*.382683433,z2=.5411961*tmp10+z5,z4=1.306562965*tmp12+z5,z3=.707106781*tmp11,z11=tmp7+z3,z13=tmp7-z3;data[dataOff+5]=z13+z2,data[dataOff+3]=z13-z2,data[dataOff+1]=z11+z4,data[dataOff+7]=z11-z4,dataOff+=8}for(i=0,dataOff=0;i<I8;++i){d0=data[dataOff],d1=data[dataOff+8],d2=data[dataOff+16],d3=data[dataOff+24],d4=data[dataOff+32],d5=data[dataOff+40],d6=data[dataOff+48];var tmp0p2=d0+(d7=data[dataOff+56]),tmp7p2=d0-d7,tmp1p2=d1+d6,tmp6p2=d1-d6,tmp2p2=d2+d5,tmp5p2=d2-d5,tmp3p2=d3+d4,tmp4p2=d3-d4,tmp10p2=tmp0p2+tmp3p2,tmp13p2=tmp0p2-tmp3p2,tmp11p2=tmp1p2+tmp2p2,tmp12p2=tmp1p2-tmp2p2;data[dataOff]=tmp10p2+tmp11p2,data[dataOff+32]=tmp10p2-tmp11p2;var z1p2=(tmp12p2+tmp13p2)*.707106781;data[dataOff+16]=tmp13p2+z1p2,data[dataOff+48]=tmp13p2-z1p2,tmp10p2=tmp4p2+tmp5p2,tmp11p2=tmp5p2+tmp6p2;var z5p2=(tmp10p2-(tmp12p2=tmp6p2+tmp7p2))*.382683433,z2p2=.5411961*tmp10p2+z5p2,z4p2=1.306562965*tmp12p2+z5p2,z3p2=.707106781*tmp11p2,z11p2=tmp7p2+z3p2,z13p2=tmp7p2-z3p2;data[dataOff+40]=z13p2+z2p2,data[dataOff+24]=z13p2-z2p2,data[dataOff+8]=z11p2+z4p2,data[dataOff+56]=z11p2-z4p2,dataOff++}for(i=0;i<I64;++i)fDCTQuant=data[i]*fdtbl[i],outputfDCTQuant[i]=fDCTQuant>0?fDCTQuant+.5|0:fDCTQuant-.5|0;return outputfDCTQuant}function writeAPP0(){writeWord(65504),writeWord(16),writeByte(74),writeByte(70),writeByte(73),writeByte(70),writeByte(0),writeByte(1),writeByte(1),writeByte(0),writeWord(1),writeWord(1),writeByte(0),writeByte(0)}function writeAPP1(exifBuffer){if(exifBuffer){writeWord(65505),69===exifBuffer[0]&&120===exifBuffer[1]&&105===exifBuffer[2]&&102===exifBuffer[3]?writeWord(exifBuffer.length+2):(writeWord(exifBuffer.length+5+2),writeByte(69),writeByte(120),writeByte(105),writeByte(102),writeByte(0));for(var i=0;i<exifBuffer.length;i++)writeByte(exifBuffer[i])}}function writeSOF0(width,height){writeWord(65472),writeWord(17),writeByte(8),writeWord(height),writeWord(width),writeByte(3),writeByte(1),writeByte(17),writeByte(0),writeByte(2),writeByte(17),writeByte(1),writeByte(3),writeByte(17),writeByte(1)}function writeDQT(){writeWord(65499),writeWord(132),writeByte(0);for(var i=0;i<64;i++)writeByte(YTable[i]);writeByte(1);for(var j=0;j<64;j++)writeByte(UVTable[j])}function writeDHT(){writeWord(65476),writeWord(418),writeByte(0);for(var i=0;i<16;i++)writeByte(std_dc_luminance_nrcodes[i+1]);for(var j=0;j<=11;j++)writeByte(std_dc_luminance_values[j]);writeByte(16);for(var k=0;k<16;k++)writeByte(std_ac_luminance_nrcodes[k+1]);for(var l=0;l<=161;l++)writeByte(std_ac_luminance_values[l]);writeByte(1);for(var m=0;m<16;m++)writeByte(std_dc_chrominance_nrcodes[m+1]);for(var n=0;n<=11;n++)writeByte(std_dc_chrominance_values[n]);writeByte(17);for(var o=0;o<16;o++)writeByte(std_ac_chrominance_nrcodes[o+1]);for(var p=0;p<=161;p++)writeByte(std_ac_chrominance_values[p])}function writeCOM(comments){void 0!==comments&&comments.constructor===Array&&comments.forEach(e=>{if("string"==typeof e){writeWord(65534);var i,l=e.length;for(writeWord(l+2),i=0;i<l;i++)writeByte(e.charCodeAt(i))}})}function writeSOS(){writeWord(65498),writeWord(12),writeByte(3),writeByte(1),writeByte(0),writeByte(2),writeByte(17),writeByte(3),writeByte(17),writeByte(0),writeByte(63),writeByte(0)}function processDU(CDU,fdtbl,DC,HTDC,HTAC){for(var pos,lng,EOB=HTAC[0],M16zeroes=HTAC[240],I16=16,I63=63,I64=64,DU_DCT=fDCTQuant(CDU,fdtbl),j=0;j<I64;++j)DU[ZigZag[j]]=DU_DCT[j];var Diff=DU[0]-DC;DC=DU[0],0==Diff?writeBits(HTDC[0]):(writeBits(HTDC[category[pos=32767+Diff]]),writeBits(bitcode[pos]));for(var end0pos=63;end0pos>0&&0==DU[end0pos];end0pos--);if(0==end0pos)return writeBits(EOB),DC;for(var i=1;i<=end0pos;){for(var startpos=i;0==DU[i]&&i<=end0pos;++i);var nrzeroes=i-startpos;if(nrzeroes>=I16){lng=nrzeroes>>4;for(var nrmarker=1;nrmarker<=lng;++nrmarker)writeBits(M16zeroes);nrzeroes&=15}writeBits(HTAC[(nrzeroes<<4)+category[pos=32767+DU[i]]]),writeBits(bitcode[pos]),i++}return end0pos!=I63&&writeBits(EOB),DC}function initCharLookupTable(){for(var sfcc=String.fromCharCode,i=0;i<256;i++)clt[i]=sfcc(i)}function setQuality(quality){if(quality<=0&&(quality=1),quality>100&&(quality=100),currentQuality!=quality){var sf=0;sf=quality<50?Math.floor(5e3/quality):Math.floor(200-2*quality),initQuantTables(sf),currentQuality=quality}}this.encode=function(image,quality){new Date().getTime(),quality&&setQuality(quality),byteout=[],bytenew=0,bytepos=7,writeWord(65496),writeAPP0(),writeCOM(image.comments),writeAPP1(image.exifBuffer),writeDQT(),writeSOF0(image.width,image.height),writeDHT(),writeSOS();var DCY=0,DCU=0,DCV=0;bytenew=0,bytepos=7,this.encode.displayName="_encode_";for(var r,g,b,start,p,col,row,pos,x,imageData=image.data,width=image.width,height=image.height,quadWidth=4*width,y=0;y<height;){for(x=0;x<quadWidth;){for(pos=0,p=start=quadWidth*y+x,col=-1,row=0;pos<64;pos++)p=start+(row=pos>>3)*quadWidth+(col=(7&pos)*4),y+row>=height&&(p-=quadWidth*(y+1+row-height)),x+col>=quadWidth&&(p-=x+col-quadWidth+4),r=imageData[p++],g=imageData[p++],b=imageData[p++],YDU[pos]=(RGB_YUV_TABLE[r]+RGB_YUV_TABLE[g+256>>0]+RGB_YUV_TABLE[b+512>>0]>>16)-128,UDU[pos]=(RGB_YUV_TABLE[r+768>>0]+RGB_YUV_TABLE[g+1024>>0]+RGB_YUV_TABLE[b+1280>>0]>>16)-128,VDU[pos]=(RGB_YUV_TABLE[r+1280>>0]+RGB_YUV_TABLE[g+1536>>0]+RGB_YUV_TABLE[b+1792>>0]>>16)-128;DCY=processDU(YDU,fdtbl_Y,DCY,YDC_HT,YAC_HT),DCU=processDU(UDU,fdtbl_UV,DCU,UVDC_HT,UVAC_HT),DCV=processDU(VDU,fdtbl_UV,DCV,UVDC_HT,UVAC_HT),x+=32}y+=8}if(bytepos>=0){var fillbits=[];fillbits[1]=bytepos+1,fillbits[0]=(1<<bytepos+1)-1,writeBits(fillbits)}return writeWord(65497),Buffer.from(byteout)},new Date().getTime(),quality||(quality=50),initCharLookupTable(),initHuffmanTbl(),initCategoryNumber(),initRGBYUVTable(),setQuality(quality),new Date().getTime()}function encode(imgData,qu){return void 0===qu&&(qu=50),{data:new JPEGEncoder(qu).encode(imgData,qu),width:imgData.width,height:imgData.height}}module.exports=encode},5307:function(module){var f;f=function(){return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=void 0;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){return s(t[o][1][e]||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i=void 0,o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){var AbstractPriorityQueue,ArrayStrategy,BHeapStrategy,BinaryHeapStrategy,PriorityQueue,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;AbstractPriorityQueue=_dereq_("./PriorityQueue/AbstractPriorityQueue"),ArrayStrategy=_dereq_("./PriorityQueue/ArrayStrategy"),BinaryHeapStrategy=_dereq_("./PriorityQueue/BinaryHeapStrategy"),BHeapStrategy=_dereq_("./PriorityQueue/BHeapStrategy"),(PriorityQueue=function(superClass){function PriorityQueue(options){options||(options={}),options.strategy||(options.strategy=BinaryHeapStrategy),options.comparator||(options.comparator=function(a,b){return(a||0)-(b||0)}),PriorityQueue.__super__.constructor.call(this,options)}return extend(PriorityQueue,superClass),PriorityQueue}(AbstractPriorityQueue)).ArrayStrategy=ArrayStrategy,PriorityQueue.BinaryHeapStrategy=BinaryHeapStrategy,PriorityQueue.BHeapStrategy=BHeapStrategy,module.exports=PriorityQueue},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(_dereq_,module,exports){var AbstractPriorityQueue;module.exports=AbstractPriorityQueue=function(){function AbstractPriorityQueue(options){var ref;if((null!=options?options.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((null!=options?options.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new options.strategy(options),this.length=(null!=options&&null!=(ref=options.initialValues)?ref.length:void 0)||0}return AbstractPriorityQueue.prototype.queue=function(value){this.length++,this.priv.queue(value)},AbstractPriorityQueue.prototype.dequeue=function(value){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},AbstractPriorityQueue.prototype.peek=function(value){if(!this.length)throw"Empty queue";return this.priv.peek()},AbstractPriorityQueue.prototype.clear=function(){return this.length=0,this.priv.clear()},AbstractPriorityQueue}()},{}],3:[function(_dereq_,module,exports){var ArrayStrategy,binarySearchForIndexReversed;binarySearchForIndexReversed=function(array,value,comparator){var high,low,mid;for(low=0,high=array.length;low<high;)comparator(array[mid=low+high>>>1],value)>=0?low=mid+1:high=mid;return low},module.exports=ArrayStrategy=function(){function ArrayStrategy(options){var ref;this.options=options,this.comparator=this.options.comparator,this.data=(null!=(ref=this.options.initialValues)?ref.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return ArrayStrategy.prototype.queue=function(value){var pos;pos=binarySearchForIndexReversed(this.data,value,this.comparator),this.data.splice(pos,0,value)},ArrayStrategy.prototype.dequeue=function(){return this.data.pop()},ArrayStrategy.prototype.peek=function(){return this.data[this.data.length-1]},ArrayStrategy.prototype.clear=function(){this.data.length=0},ArrayStrategy}()},{}],4:[function(_dereq_,module,exports){var BHeapStrategy;module.exports=BHeapStrategy=function(){function BHeapStrategy(options){var arr,i,j,k,len,ref,ref1,shift,value;for(this.comparator=(null!=options?options.comparator:void 0)||function(a,b){return a-b},this.pageSize=(null!=options?options.pageSize:void 0)||512,this.length=0,shift=0;1<<shift<this.pageSize;)shift+=1;if(1<<shift!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=shift,this._emptyMemoryPageTemplate=arr=[],i=j=0,ref=this.pageSize;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j)arr.push(null);if(this._memory=[],this._mask=this.pageSize-1,options.initialValues)for(k=0,len=(ref1=options.initialValues).length;k<len;k++)value=ref1[k],this.queue(value)}return BHeapStrategy.prototype.queue=function(value){this.length+=1,this._write(this.length,value),this._bubbleUp(this.length,value)},BHeapStrategy.prototype.dequeue=function(){var ret,val;return ret=this._read(1),val=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,val),this._bubbleDown(1,val)),ret},BHeapStrategy.prototype.peek=function(){return this._read(1)},BHeapStrategy.prototype.clear=function(){this.length=0,this._memory.length=0},BHeapStrategy.prototype._write=function(index,value){var page;for(page=index>>this._shift;page>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[page][index&this._mask]=value},BHeapStrategy.prototype._read=function(index){return this._memory[index>>this._shift][index&this._mask]},BHeapStrategy.prototype._bubbleUp=function(index,value){var compare,indexInPage,parentIndex,parentValue;for(compare=this.comparator;index>1&&(indexInPage=index&this._mask,index<this.pageSize||indexInPage>3?parentIndex=index&~this._mask|indexInPage>>1:indexInPage<2?(parentIndex=index-this.pageSize>>this._shift,parentIndex+=parentIndex&~(this._mask>>1),parentIndex|=this.pageSize>>1):parentIndex=index-2,!(0>compare(parentValue=this._read(parentIndex),value)));)this._write(parentIndex,value),this._write(index,parentValue),index=parentIndex},BHeapStrategy.prototype._bubbleDown=function(index,value){var childIndex1,childIndex2,childValue1,childValue2,compare;for(compare=this.comparator;index<this.length;)if(index>this._mask&&!(index&this._mask-1)?childIndex1=childIndex2=index+2:childIndex2=index&this.pageSize>>1?(childIndex1=(childIndex1=(index&~this._mask)>>1|index&this._mask>>1)+1<<this._shift)+1:(childIndex1=index+(index&this._mask))+1,childIndex1!==childIndex2&&childIndex2<=this.length){if(childValue1=this._read(childIndex1),childValue2=this._read(childIndex2),0>compare(childValue1,value)&&0>=compare(childValue1,childValue2))this._write(childIndex1,value),this._write(index,childValue1),index=childIndex1;else if(0>compare(childValue2,value))this._write(childIndex2,value),this._write(index,childValue2),index=childIndex2;else break}else if(childIndex1<=this.length){if(0>compare(childValue1=this._read(childIndex1),value))this._write(childIndex1,value),this._write(index,childValue1),index=childIndex1;else break}else break},BHeapStrategy}()},{}],5:[function(_dereq_,module,exports){var BinaryHeapStrategy;module.exports=BinaryHeapStrategy=function(){function BinaryHeapStrategy(options){var ref;this.comparator=(null!=options?options.comparator:void 0)||function(a,b){return a-b},this.length=0,this.data=(null!=(ref=options.initialValues)?ref.slice(0):void 0)||[],this._heapify()}return BinaryHeapStrategy.prototype._heapify=function(){var i,j,ref;if(this.data.length>0)for(i=j=1,ref=this.data.length;1<=ref?j<ref:j>ref;i=1<=ref?++j:--j)this._bubbleUp(i)},BinaryHeapStrategy.prototype.queue=function(value){this.data.push(value),this._bubbleUp(this.data.length-1)},BinaryHeapStrategy.prototype.dequeue=function(){var last,ret;return ret=this.data[0],last=this.data.pop(),this.data.length>0&&(this.data[0]=last,this._bubbleDown(0)),ret},BinaryHeapStrategy.prototype.peek=function(){return this.data[0]},BinaryHeapStrategy.prototype.clear=function(){this.length=0,this.data.length=0},BinaryHeapStrategy.prototype._bubbleUp=function(pos){for(var parent,x;pos>0;)if(parent=pos-1>>>1,0>this.comparator(this.data[pos],this.data[parent]))x=this.data[parent],this.data[parent]=this.data[pos],this.data[pos]=x,pos=parent;else break},BinaryHeapStrategy.prototype._bubbleDown=function(pos){var last,left,minIndex,right,x;for(last=this.data.length-1;;)if(right=(left=(pos<<1)+1)+1,minIndex=pos,left<=last&&0>this.comparator(this.data[left],this.data[minIndex])&&(minIndex=left),right<=last&&0>this.comparator(this.data[right],this.data[minIndex])&&(minIndex=right),minIndex!==pos)x=this.data[minIndex],this.data[minIndex]=this.data[pos],this.data[pos]=x,pos=minIndex;else break},BinaryHeapStrategy}()},{}]},{},[1])(1)},module.exports=f()},2229:function(module){var global,factory;global=0,factory=function(){"use strict";function isString(value){return"string"==typeof value||value instanceof String}var isFiniteImpl=Number.isFinite||window.isFinite;function isNumber(value){return isFiniteImpl(value)}function identity(value){return value}function uniq(strings){var seen={};return strings.filter(function(item){return!seen.hasOwnProperty(item)&&(seen[item]=!0)})}function compareArray(array1,array2){if(array2.length!==array1.length)return!1;for(var i=0;i<array1.length;i++)if(array2[i].compareArray&&!array2[i].compareArray(array1[i])||array2[i]!==array1[i])return!1;return!0}function assign(target,properties){Object.keys(properties).forEach(function(key){target[key]=properties[key]})}function mulSafe(){for(var result=1,decimals=0,i=0;i<arguments.length;i++){var arg=arguments[i];decimals+=getFractional(arg),result*=arg}return 0!==decimals?round(result,decimals):result}function divSafe(num,den){if(0===den)throw Error("Divide by zero");var factor=Math.pow(10,getFractional(den));return mulSafe(num,factor/(factor*den))}function round(val,decimals){return Math.round(val*Math.pow(10,decimals))/Math.pow(10,decimals)}function getFractional(num){if(!isFinite(num))return 0;for(var count=0;num%1!=0;)num*=10,count++;return count}function QtyError(){var err;if(!this)return err=Object.create(QtyError.prototype),QtyError.apply(err,arguments),err;err=Error.apply(this,arguments),this.name="QtyError",this.message=err.message,this.stack=err.stack}function throwIncompatibleUnits(left,right){throw new QtyError("Incompatible units: "+left+" and "+right)}QtyError.prototype=Object.create(Error.prototype,{constructor:{value:QtyError}});var UNITS={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],1024,"prefix"],"<mebi>":[["Mi","Mebi","mebi"],1048576,"prefix"],"<gibi>":[["Gi","Gibi","gibi"],1073741824,"prefix"],"<tebi>":[["Ti","Tebi","tebi"],1099511627776,"prefix"],"<pebi>":[["Pi","Pebi","pebi"],0x4000000000000,"prefix"],"<exi>":[["Ei","Exi","exi"],0x1000000000000000,"prefix"],"<zebi>":[["Zi","Zebi","zebi"],11805916207174113e5,"prefix"],"<yebi>":[["Yi","Yebi","yebi"],12089258196146292e8,"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","\xb5","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],352777778e-12,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],94635295e-11,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],473176475e-12,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],56826125e-11,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],236588238e-12,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},BASE_UNITS=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],UNITY="<1>",UNITY_ARRAY=[UNITY];function validateUnitDefinition(unitDef,definition){var scalar=definition[1],numerator=definition[3]||[],denominator=definition[4]||[];if(!isNumber(scalar))throw new QtyError(unitDef+": Invalid unit definition. 'scalar' must be a number");numerator.forEach(function(unit){if(void 0===UNITS[unit])throw new QtyError(unitDef+": Invalid unit definition. Unit "+unit+" in 'numerator' is not recognized")}),denominator.forEach(function(unit){if(void 0===UNITS[unit])throw new QtyError(unitDef+": Invalid unit definition. Unit "+unit+" in 'denominator' is not recognized")})}var PREFIX_VALUES={},PREFIX_MAP={},UNIT_VALUES={},UNIT_MAP={},OUTPUT_MAP={};for(var unitDef in UNITS)if(UNITS.hasOwnProperty(unitDef)){var definition=UNITS[unitDef];if("prefix"===definition[2]){PREFIX_VALUES[unitDef]=definition[1];for(var i=0;i<definition[0].length;i++)PREFIX_MAP[definition[0][i]]=unitDef}else{validateUnitDefinition(unitDef,definition),UNIT_VALUES[unitDef]={scalar:definition[1],numerator:definition[3],denominator:definition[4]};for(var j=0;j<definition[0].length;j++)UNIT_MAP[definition[0][j]]=unitDef}OUTPUT_MAP[unitDef]=definition[0][0]}function getUnits(kind){var i,units=[],unitKeys=Object.keys(UNITS);if(void 0===kind)for(i=0;i<unitKeys.length;i++)-1===["","prefix"].indexOf(UNITS[unitKeys[i]][2])&&units.push(unitKeys[i].substr(1,unitKeys[i].length-2));else if(-1===this.getKinds().indexOf(kind))throw new QtyError("Kind not recognized");else for(i=0;i<unitKeys.length;i++)UNITS[unitKeys[i]][2]===kind&&units.push(unitKeys[i].substr(1,unitKeys[i].length-2));return units.sort(function(a,b){return a.toLowerCase()<b.toLowerCase()?-1:a.toLowerCase()>b.toLowerCase()?1:0})}function getAliases(unitName){if(!UNIT_MAP[unitName])throw new QtyError("Unit not recognized");return UNITS[UNIT_MAP[unitName]][0]}var SIGNATURE_VECTOR=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function unitSignature(){if(this.signature)return this.signature;for(var vector=unitSignatureVector.call(this),i=0;i<vector.length;i++)vector[i]*=Math.pow(20,i);return vector.reduce(function(previous,current){return previous+current},0)}function unitSignatureVector(){if(!this.isBase())return unitSignatureVector.call(this.toBase());for(var r,n,vector=Array(SIGNATURE_VECTOR.length),i=0;i<vector.length;i++)vector[i]=0;for(var j=0;j<this.numerator.length;j++)(r=UNITS[this.numerator[j]])&&(n=SIGNATURE_VECTOR.indexOf(r[2]))>=0&&(vector[n]=vector[n]+1);for(var k=0;k<this.denominator.length;k++)(r=UNITS[this.denominator[k]])&&(n=SIGNATURE_VECTOR.indexOf(r[2]))>=0&&(vector[n]=vector[n]-1);return vector}var SIGN="[+-]",INTEGER="\\d+",SIGNED_INTEGER=SIGN+"?"+INTEGER,FRACTION="\\."+INTEGER,QTY_STRING_REGEX=RegExp("^"+("("+(SIGN+"?\\s*"+("(?:"+("(?:"+INTEGER+"(?:"+FRACTION+")?)|(?:")+FRACTION+"))(?:[Ee]"))+SIGNED_INTEGER)+")?)?\\s*([^/]*)(?:/(.+))?$"),POWER_OP="\\^|\\*{2}",SAFE_POWER="[01234]",TOP_REGEX=RegExp("([^ \\*\\d]+?)(?:"+POWER_OP+")?(-?"+SAFE_POWER+"(?![a-zA-Z]))"),BOTTOM_REGEX=RegExp("([^ \\*\\d]+?)(?:"+POWER_OP+")?("+SAFE_POWER+"(?![a-zA-Z]))");function parse(val){isString(val)||(val=val.toString()),val=val.trim();var n,x,nx,result=QTY_STRING_REGEX.exec(val);if(!result)throw new QtyError(val+": Quantity not recognized");var scalarMatch=result[1];scalarMatch?(scalarMatch=scalarMatch.replace(/\s/g,""),this.scalar=parseFloat(scalarMatch)):this.scalar=1;for(var top=result[2],bottom=result[3];result=TOP_REGEX.exec(top);){if(isNaN(n=parseFloat(result[2])))throw new QtyError("Unit exponent is not a number");if(0===n&&!UNIT_TEST_REGEX.test(result[1]))throw new QtyError("Unit not recognized");x=result[1]+" ",nx="";for(var i=0;i<Math.abs(n);i++)nx+=x;n>=0?top=top.replace(result[0],nx):(bottom=bottom?bottom+nx:nx,top=top.replace(result[0],""))}for(;result=BOTTOM_REGEX.exec(bottom);){if(isNaN(n=parseFloat(result[2])))throw new QtyError("Unit exponent is not a number");if(0===n&&!UNIT_TEST_REGEX.test(result[1]))throw new QtyError("Unit not recognized");x=result[1]+" ",nx="";for(var j=0;j<n;j++)nx+=x;bottom=bottom.replace(result[0],nx)}top&&(this.numerator=parseUnits(top.trim())),bottom&&(this.denominator=parseUnits(bottom.trim()))}var UNIT_MATCH="("+Object.keys(PREFIX_MAP).sort(function(a,b){return b.length-a.length}).join("|")+")??("+Object.keys(UNIT_MAP).sort(function(a,b){return b.length-a.length}).join("|")+")(?:\\b|$)",UNIT_TEST_REGEX=RegExp("^\\s*("+UNIT_MATCH+"[\\s\\*]*)+$"),UNIT_MATCH_REGEX=RegExp(UNIT_MATCH,"g"),parsedUnitsCache={};function parseUnits(units){var cached=parsedUnitsCache[units];if(cached)return cached;var unitMatch,normalizedUnits=[];if(!UNIT_TEST_REGEX.test(units))throw new QtyError("Unit not recognized");for(;unitMatch=UNIT_MATCH_REGEX.exec(units);)normalizedUnits.push(unitMatch.slice(1));return normalizedUnits=(normalizedUnits=(normalizedUnits=normalizedUnits.map(function(item){return PREFIX_MAP[item[0]]?[PREFIX_MAP[item[0]],UNIT_MAP[item[1]]]:[UNIT_MAP[item[1]]]})).reduce(function(a,b){return a.concat(b)},[])).filter(function(item){return item}),parsedUnitsCache[units]=normalizedUnits,normalizedUnits}function globalParse(value){if(!isString(value))throw new QtyError("Argument should be a string");try{return this(value)}catch(e){return null}}function isQty(value){return value instanceof Qty}function Qty(initValue,initUnits){if(assertValidConstructorArgs.apply(null,arguments),!isQty(this))return new Qty(initValue,initUnits);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=UNITY_ARRAY,this.denominator=UNITY_ARRAY,isDefinitionObject(initValue)?(this.scalar=initValue.scalar,this.numerator=initValue.numerator&&0!==initValue.numerator.length?initValue.numerator:UNITY_ARRAY,this.denominator=initValue.denominator&&0!==initValue.denominator.length?initValue.denominator:UNITY_ARRAY):initUnits?(parse.call(this,initUnits),this.scalar=initValue):parse.call(this,initValue),this.denominator.join("*").indexOf("temp")>=0)throw new QtyError("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new QtyError("Cannot multiply by temperatures");if(!compareArray(this.denominator,UNITY_ARRAY))throw new QtyError("Cannot divide with temperatures")}if(this.initValue=initValue,updateBaseScalar.call(this),this.isTemperature()&&this.baseScalar<0)throw new QtyError("Temperatures must not be less than absolute zero")}function assertValidConstructorArgs(value,units){if(units){if(!(isNumber(value)&&isString(units)))throw new QtyError("Only number accepted as initialization value when units are explicitly provided")}else if(!(isString(value)||isNumber(value)||isQty(value)||isDefinitionObject(value)))throw new QtyError("Only string, number or quantity accepted as single initialization value")}function isDefinitionObject(value){return value&&"object"==typeof value&&value.hasOwnProperty("scalar")}function updateBaseScalar(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=unitSignature.call(this);else{var base=this.toBase();this.baseScalar=base.scalar,this.signature=base.signature}}Qty.prototype={constructor:Qty};var KINDS={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency","25599999980":"information_rate","25600000000":"information","511999999980":"angular_velocity","512000000000":"angle"};function getKinds(){return uniq(Object.keys(KINDS).map(function(knownSignature){return KINDS[knownSignature]}))}function subtractTemperatures(lhs,rhs){var lhsUnits=lhs.units(),rhsConverted=rhs.to(lhsUnits),dstDegrees=Qty(getDegreeUnits(lhsUnits));return Qty({scalar:lhs.scalar-rhsConverted.scalar,numerator:dstDegrees.numerator,denominator:dstDegrees.denominator})}function subtractTempDegrees(temp,deg){var tempDegrees=deg.to(getDegreeUnits(temp.units()));return Qty({scalar:temp.scalar-tempDegrees.scalar,numerator:temp.numerator,denominator:temp.denominator})}function addTempDegrees(temp,deg){var tempDegrees=deg.to(getDegreeUnits(temp.units()));return Qty({scalar:temp.scalar+tempDegrees.scalar,numerator:temp.numerator,denominator:temp.denominator})}function getDegreeUnits(units){if("tempK"===units)return"degK";if("tempC"===units)return"degC";if("tempF"===units)return"degF";if("tempR"===units)return"degR";throw new QtyError("Unknown type for temp conversion from: "+units)}function toDegrees(src,dst){var dstScalar,srcDegK=toDegK(src),dstUnits=dst.units();if("degK"===dstUnits)dstScalar=srcDegK.scalar;else if("degC"===dstUnits)dstScalar=srcDegK.scalar;else if("degF"===dstUnits)dstScalar=9*srcDegK.scalar/5;else if("degR"===dstUnits)dstScalar=9*srcDegK.scalar/5;else throw new QtyError("Unknown type for degree conversion to: "+dstUnits);return Qty({scalar:dstScalar,numerator:dst.numerator,denominator:dst.denominator})}function toDegK(qty){var q,units=qty.units();if(units.match(/(deg)[CFRK]/))q=qty.baseScalar;else if("tempK"===units)q=qty.scalar;else if("tempC"===units)q=qty.scalar;else if("tempF"===units)q=5*qty.scalar/9;else if("tempR"===units)q=5*qty.scalar/9;else throw new QtyError("Unknown type for temp conversion from: "+units);return Qty({scalar:q,numerator:["<kelvin>"],denominator:UNITY_ARRAY})}function toTemp(src,dst){var dstScalar,dstUnits=dst.units();if("tempK"===dstUnits)dstScalar=src.baseScalar;else if("tempC"===dstUnits)dstScalar=src.baseScalar-273.15;else if("tempF"===dstUnits)dstScalar=9*src.baseScalar/5-459.67;else if("tempR"===dstUnits)dstScalar=9*src.baseScalar/5;else throw new QtyError("Unknown type for temp conversion to: "+dstUnits);return Qty({scalar:dstScalar,numerator:dst.numerator,denominator:dst.denominator})}function toTempK(qty){var q,units=qty.units();if(units.match(/(deg)[CFRK]/))q=qty.baseScalar;else if("tempK"===units)q=qty.scalar;else if("tempC"===units)q=qty.scalar+273.15;else if("tempF"===units)q=(qty.scalar+459.67)*5/9;else if("tempR"===units)q=5*qty.scalar/9;else throw new QtyError("Unknown type for temp conversion from: "+units);return Qty({scalar:q,numerator:["<temp-K>"],denominator:UNITY_ARRAY})}function swiftConverter(srcUnits,dstUnits){var convert,srcQty=Qty(srcUnits),dstQty=Qty(dstUnits);return srcQty.eq(dstQty)?identity:(convert=srcQty.isTemperature()?function(value){return srcQty.mul(value).to(dstQty).scalar}:function(value){return value*srcQty.baseScalar/dstQty.baseScalar},function(value){var i,length,result;if(!Array.isArray(value))return convert(value);for(i=0,length=value.length,result=[];i<length;i++)result.push(convert(value[i]));return result})}Qty.prototype.kind=function(){return KINDS[this.signature.toString()]},assign(Qty.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&compareArray(this.denominator,UNITY_ARRAY)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),assign(Qty.prototype,{to:function(other){var cached,target;return null==other?this:isString(other)?(cached=this._conversionCache[other])?cached:(target=Qty(other)).units()===this.units()?this:(this.isCompatible(target)?target=target.isTemperature()?toTemp(this,target):target.isDegrees()?toDegrees(this,target):Qty({scalar:divSafe(this.baseScalar,target.baseScalar),numerator:target.numerator,denominator:target.denominator}):this.isInverse(target)?target=this.inverse().to(other):throwIncompatibleUnits(this.units(),target.units()),this._conversionCache[other]=target,target):this.to(other.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return toTempK(this);var cached=baseUnitCache[this.units()];return cached||(cached=toBaseUnits(this.numerator,this.denominator),baseUnitCache[this.units()]=cached),cached.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new QtyError("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(precQuantity){if(isString(precQuantity)&&(precQuantity=Qty(precQuantity)),isNumber(precQuantity)&&(precQuantity=Qty(precQuantity+" "+this.units())),this.isUnitless()?precQuantity.isUnitless()||throwIncompatibleUnits(this.units(),precQuantity.units()):precQuantity=precQuantity.to(this.units()),0===precQuantity.scalar)throw new QtyError("Divide by zero");return Qty(mulSafe(Math.round(this.scalar/precQuantity.scalar),precQuantity.scalar)+this.units())}});var baseUnitCache={};function toBaseUnits(numerator,denominator){for(var unit,num=[],den=[],q=1,i=0;i<numerator.length;i++)PREFIX_VALUES[unit=numerator[i]]?q=mulSafe(q,PREFIX_VALUES[unit]):UNIT_VALUES[unit]&&(q*=UNIT_VALUES[unit].scalar,UNIT_VALUES[unit].numerator&&num.push(UNIT_VALUES[unit].numerator),UNIT_VALUES[unit].denominator&&den.push(UNIT_VALUES[unit].denominator));for(var j=0;j<denominator.length;j++)PREFIX_VALUES[unit=denominator[j]]?q/=PREFIX_VALUES[unit]:UNIT_VALUES[unit]&&(q/=UNIT_VALUES[unit].scalar,UNIT_VALUES[unit].numerator&&den.push(UNIT_VALUES[unit].numerator),UNIT_VALUES[unit].denominator&&num.push(UNIT_VALUES[unit].denominator));return Qty({scalar:q,numerator:num=num.reduce(function(a,b){return a.concat(b)},[]),denominator:den=den.reduce(function(a,b){return a.concat(b)},[])})}function cleanTerms(num1,den1,num2,den2){function notUnity(val){return val!==UNITY}num1=num1.filter(notUnity),num2=num2.filter(notUnity),den1=den1.filter(notUnity),den2=den2.filter(notUnity);var combined={};function combineTerms(terms,direction){for(var k,prefix,prefixValue,i=0;i<terms.length;i++)if(PREFIX_VALUES[terms[i]]?(k=terms[i+1],prefixValue=PREFIX_VALUES[prefix=terms[i]],i++):(k=terms[i],prefix=null,prefixValue=1),k&&k!==UNITY){if(combined[k]){combined[k][0]+=direction;var combinedPrefixValue=combined[k][2]?PREFIX_VALUES[combined[k][2]]:1;combined[k][1===direction?3:4]*=divSafe(prefixValue,combinedPrefixValue)}else combined[k]=[direction,k,prefix,1,1]}}combineTerms(num1,1),combineTerms(den1,-1),combineTerms(num2,1),combineTerms(den2,-1);var num=[],den=[],scale=1;for(var prop in combined)if(combined.hasOwnProperty(prop)){var n,item=combined[prop];if(item[0]>0)for(n=0;n<item[0];n++)num.push(null===item[2]?item[1]:[item[2],item[1]]);else if(item[0]<0)for(n=0;n<-item[0];n++)den.push(null===item[2]?item[1]:[item[2],item[1]]);scale*=divSafe(item[3],item[4])}return 0===num.length&&(num=UNITY_ARRAY),0===den.length&&(den=UNITY_ARRAY),[num=num.reduce(function(a,b){return a.concat(b)},[]),den=den.reduce(function(a,b){return a.concat(b)},[]),scale]}function NestedMap(){}function defaultFormatter(scalar,units){return(scalar+" "+units).trim()}Qty.parse=globalParse,Qty.getUnits=getUnits,Qty.getAliases=getAliases,Qty.mulSafe=mulSafe,Qty.divSafe=divSafe,Qty.getKinds=getKinds,Qty.swiftConverter=swiftConverter,Qty.Error=QtyError,assign(Qty.prototype,{add:function(other){if(isString(other)&&(other=Qty(other)),this.isCompatible(other)||throwIncompatibleUnits(this.units(),other.units()),this.isTemperature()&&other.isTemperature())throw new QtyError("Cannot add two temperatures");return this.isTemperature()?addTempDegrees(this,other):other.isTemperature()?addTempDegrees(other,this):Qty({scalar:this.scalar+other.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(other){if(isString(other)&&(other=Qty(other)),this.isCompatible(other)||throwIncompatibleUnits(this.units(),other.units()),this.isTemperature()&&other.isTemperature())return subtractTemperatures(this,other);if(this.isTemperature())return subtractTempDegrees(this,other);if(other.isTemperature())throw new QtyError("Cannot subtract a temperature from a differential degree unit");return Qty({scalar:this.scalar-other.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(other){if(isNumber(other))return Qty({scalar:mulSafe(this.scalar,other),numerator:this.numerator,denominator:this.denominator});if(isString(other)&&(other=Qty(other)),(this.isTemperature()||other.isTemperature())&&!(this.isUnitless()||other.isUnitless()))throw new QtyError("Cannot multiply by temperatures");var op1=this,op2=other;op1.isCompatible(op2)&&400!==op1.signature&&(op2=op2.to(op1));var numdenscale=cleanTerms(op1.numerator,op1.denominator,op2.numerator,op2.denominator);return Qty({scalar:mulSafe(op1.scalar,op2.scalar,numdenscale[2]),numerator:numdenscale[0],denominator:numdenscale[1]})},div:function(other){if(isNumber(other)){if(0===other)throw new QtyError("Divide by zero");return Qty({scalar:this.scalar/other,numerator:this.numerator,denominator:this.denominator})}if(isString(other)&&(other=Qty(other)),0===other.scalar)throw new QtyError("Divide by zero");if(other.isTemperature()||this.isTemperature()&&!other.isUnitless())throw new QtyError("Cannot divide with temperatures");var op1=this,op2=other;op1.isCompatible(op2)&&400!==op1.signature&&(op2=op2.to(op1));var numdenscale=cleanTerms(op1.numerator,op1.denominator,op2.denominator,op2.numerator);return Qty({scalar:mulSafe(op1.scalar,numdenscale[2])/op2.scalar,numerator:numdenscale[0],denominator:numdenscale[1]})},inverse:function(){if(this.isTemperature())throw new QtyError("Cannot divide with temperatures");if(0===this.scalar)throw new QtyError("Divide by zero");return Qty({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),assign(Qty.prototype,{eq:function(other){return 0===this.compareTo(other)},lt:function(other){return -1===this.compareTo(other)},lte:function(other){return this.eq(other)||this.lt(other)},gt:function(other){return 1===this.compareTo(other)},gte:function(other){return this.eq(other)||this.gt(other)},compareTo:function(other){return isString(other)?this.compareTo(Qty(other)):(this.isCompatible(other)||throwIncompatibleUnits(this.units(),other.units()),this.baseScalar<other.baseScalar)?-1:this.baseScalar===other.baseScalar?0:this.baseScalar>other.baseScalar?1:void 0},same:function(other){return this.scalar===other.scalar&&this.units()===other.units()}}),assign(Qty.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every(function(item){return compareArray(item,UNITY_ARRAY)})},isCompatible:function(other){return isString(other)?this.isCompatible(Qty(other)):!!isQty(other)&&void 0!==other.signature&&this.signature===other.signature},isInverse:function(other){return this.inverse().isCompatible(other)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach(function(item){item!==UNITY&&-1===BASE_UNITS.indexOf(item)&&(this._isBase=!1)},this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),NestedMap.prototype.get=function(keys){return arguments.length>1&&(keys=Array.apply(null,arguments)),keys.reduce(function(map,key,index){if(map){var childMap=map[key];return index===keys.length-1?childMap?childMap.data:void 0:childMap}},this)},NestedMap.prototype.set=function(keys,value){return arguments.length>2&&(keys=Array.prototype.slice.call(arguments,0,-1),value=arguments[arguments.length-1]),keys.reduce(function(map,key,index){var childMap=map[key];return(void 0===childMap&&(childMap=map[key]={}),index===keys.length-1)?(childMap.data=value,value):childMap},this)},Qty.formatter=defaultFormatter,assign(Qty.prototype,{units:function(){if(void 0!==this._units)return this._units;var numIsUnity=compareArray(this.numerator,UNITY_ARRAY),denIsUnity=compareArray(this.denominator,UNITY_ARRAY);if(numIsUnity&&denIsUnity)return this._units="",this._units;var numUnits=stringifyUnits(this.numerator),denUnits=stringifyUnits(this.denominator);return this._units=numUnits+(denIsUnity?"":"/"+denUnits),this._units},toString:function(targetUnitsOrMaxDecimalsOrPrec,maxDecimals){if(isNumber(targetUnitsOrMaxDecimalsOrPrec))targetUnits=this.units(),maxDecimals=targetUnitsOrMaxDecimalsOrPrec;else if(isString(targetUnitsOrMaxDecimalsOrPrec))targetUnits=targetUnitsOrMaxDecimalsOrPrec;else if(isQty(targetUnitsOrMaxDecimalsOrPrec))return this.toPrec(targetUnitsOrMaxDecimalsOrPrec).toString(maxDecimals);var targetUnits,out=this.to(targetUnits);return((void 0!==maxDecimals?round(out.scalar,maxDecimals):out.scalar)+" "+out.units()).trim()},format:function(targetUnits,formatter){1==arguments.length&&"function"==typeof targetUnits&&(formatter=targetUnits,targetUnits=void 0),formatter=formatter||Qty.formatter;var targetQty=this.to(targetUnits);return formatter.call(this,targetQty.scalar,targetQty.units())}});var stringifiedUnitsCache=new NestedMap;function stringifyUnits(units){var stringified=stringifiedUnitsCache.get(units);return stringified||(stringified=compareArray(units,UNITY_ARRAY)?"1":simplify(getOutputNames(units)).join("*"),stringifiedUnitsCache.set(units,stringified)),stringified}function getOutputNames(units){for(var token,tokenNext,unitNames=[],i=0;i<units.length;i++)token=units[i],tokenNext=units[i+1],PREFIX_VALUES[token]?(unitNames.push(OUTPUT_MAP[token]+OUTPUT_MAP[tokenNext]),i++):unitNames.push(OUTPUT_MAP[token]);return unitNames}function simplify(units){return units.reduce(function(acc,unit){var unitCounter=acc[unit];return unitCounter||acc.push(unitCounter=acc[unit]=[unit,0]),unitCounter[1]++,acc},[]).map(function(unitCount){return unitCount[0]+(unitCount[1]>1?unitCount[1]:"")})}return Qty.version="1.8.0",Qty},module.exports=factory()},5520:function(module){!function(){function a(d){for(var e=0,f=d.length-1,g=void 0,h=void 0,i=void 0,j=c(e,f);;){if(f<=e)return d[j];if(f==e+1)return d[e]>d[f]&&b(d,e,f),d[j];for(d[g=c(e,f)]>d[f]&&b(d,g,f),d[e]>d[f]&&b(d,e,f),d[g]>d[e]&&b(d,g,e),b(d,g,e+1),h=e+1,i=f;;){do h++;while(d[e]>d[h]);do i--;while(d[i]>d[e]);if(i<h)break;b(d,h,i)}b(d,e,i),i<=j&&(e=h),i>=j&&(f=i-1)}}var b=function(d,e,f){var _ref;return _ref=[d[f],d[e]],d[e]=_ref[0],d[f]=_ref[1],_ref},c=function(d,e){return~~((d+e)/2)};module.exports?module.exports=a:window.median=a}()},5823:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return rescale}});var lib_esm=__webpack_require__(4091);function max(input){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,lib_esm.isAnyArray)(input))throw TypeError("input must be an array");if(0===input.length)throw TypeError("input must not be empty");var _options$fromIndex=options.fromIndex,fromIndex=void 0===_options$fromIndex?0:_options$fromIndex,_options$toIndex=options.toIndex,toIndex=void 0===_options$toIndex?input.length:_options$toIndex;if(fromIndex<0||fromIndex>=input.length||!Number.isInteger(fromIndex))throw Error("fromIndex must be a positive integer smaller than length");if(toIndex<=fromIndex||toIndex>input.length||!Number.isInteger(toIndex))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var maxValue=input[fromIndex],i=fromIndex+1;i<toIndex;i++)input[i]>maxValue&&(maxValue=input[i]);return maxValue}function min(input){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,lib_esm.isAnyArray)(input))throw TypeError("input must be an array");if(0===input.length)throw TypeError("input must not be empty");var _options$fromIndex=options.fromIndex,fromIndex=void 0===_options$fromIndex?0:_options$fromIndex,_options$toIndex=options.toIndex,toIndex=void 0===_options$toIndex?input.length:_options$toIndex;if(fromIndex<0||fromIndex>=input.length||!Number.isInteger(fromIndex))throw Error("fromIndex must be a positive integer smaller than length");if(toIndex<=fromIndex||toIndex>input.length||!Number.isInteger(toIndex))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var minValue=input[fromIndex],i=fromIndex+1;i<toIndex;i++)input[i]<minValue&&(minValue=input[i]);return minValue}function rescale(input){var output,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,lib_esm.isAnyArray)(input)){if(0===input.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==options.output){if(!(0,lib_esm.isAnyArray)(options.output))throw TypeError("output option must be an array if specified");output=options.output}else output=Array(input.length);var currentMin=min(input),currentMax=max(input);if(currentMin===currentMax)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var _options$min=options.min,minValue=void 0===_options$min?options.autoMinMax?currentMin:0:_options$min,_options$max=options.max,maxValue=void 0===_options$max?options.autoMinMax?currentMax:1:_options$max;if(minValue>=maxValue)throw RangeError("min option must be smaller than max option");for(var factor=(maxValue-minValue)/(currentMax-currentMin),i=0;i<input.length;i++)output[i]=(input[i]-currentMin)*factor+minValue;return output}},530:function(module){"use strict";class DisjointSet{constructor(){this.nodes=new Map}add(value){var node=this.nodes.get(value);return node||(node=new DisjointSetNode(value),this.nodes.set(value,node)),node}union(x,y){let rootX=this.find(x),rootY=this.find(y);rootX!==rootY&&(rootX.rank<rootY.rank?rootX.parent=rootY:rootX.rank>rootY.rank?rootY.parent=rootX:(rootY.parent=rootX,rootX.rank++))}find(node){for(var rootX=node;null!==rootX.parent;)rootX=rootX.parent;for(var toUpdateX=node;null!==toUpdateX.parent;){var toUpdateParent=toUpdateX;toUpdateX=toUpdateX.parent,toUpdateParent.parent=rootX}return rootX}connected(x,y){return this.find(x)===this.find(y)}}function DisjointSetNode(value){this.value=value,this.parent=null,this.rank=0}module.exports=DisjointSet},4953:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";function squaredEuclidean(p,q){let d=0;for(let i=0;i<p.length;i++)d+=(p[i]-q[i])*(p[i]-q[i]);return d}function euclidean(p,q){return Math.sqrt(squaredEuclidean(p,q))}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{euclidean:function(){return euclidean},squaredEuclidean:function(){return squaredEuclidean}})},7080:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var FFT=__webpack_require__(5571),FFTUtils={DEBUG:!1,ifft2DArray:function(ft,ftRows,ftCols){var tempTransform=Array(ftRows*ftCols),nRows=ftRows/2,nCols=(ftCols-1)*2;FFT.init(nRows);for(var tmpCols={re:Array(nRows),im:Array(nRows)},iCol=0;iCol<ftCols;iCol++){for(var iRow=nRows-1;iRow>=0;iRow--)tmpCols.re[iRow]=ft[2*iRow*ftCols+iCol],tmpCols.im[iRow]=ft[(2*iRow+1)*ftCols+iCol];FFT.bt(tmpCols.re,tmpCols.im);for(var iRow=nRows-1;iRow>=0;iRow--)tempTransform[2*iRow*ftCols+iCol]=tmpCols.re[iRow],tempTransform[(2*iRow+1)*ftCols+iCol]=tmpCols.im[iRow]}var finalTransform=Array(nRows*nCols);FFT.init(nCols);for(var tmpRows={re:Array(nCols),im:Array(nCols)},scale=nCols*nRows,iRow=0;iRow<ftRows;iRow+=2){tmpRows.re[0]=tempTransform[iRow*ftCols],tmpRows.im[0]=tempTransform[(iRow+1)*ftCols];for(var iCol=1;iCol<ftCols;iCol++)tmpRows.re[iCol]=tempTransform[iRow*ftCols+iCol],tmpRows.im[iCol]=tempTransform[(iRow+1)*ftCols+iCol],tmpRows.re[nCols-iCol]=tempTransform[iRow*ftCols+iCol],tmpRows.im[nCols-iCol]=-tempTransform[(iRow+1)*ftCols+iCol];FFT.bt(tmpRows.re,tmpRows.im);for(var indexB=iRow/2*nCols,iCol=nCols-1;iCol>=0;iCol--)finalTransform[indexB+iCol]=tmpRows.re[iCol]/scale}return finalTransform},fft2DArray:function(data,nRows,nCols,opt){Object.assign({},{inplace:!0});var index,iRow0,iRow1,iRow2,iRow3,ftCols=nCols/2+1,ftRows=2*nRows,tempTransform=Array(ftRows*ftCols);FFT.init(nCols);for(var tmpRows={re:Array(nCols),im:Array(nCols)},row1={re:Array(nCols),im:Array(nCols)},row2={re:Array(nCols),im:Array(nCols)},iRow=0;iRow<nRows/2;iRow++){index=2*iRow*nCols,tmpRows.re=data.slice(index,index+nCols),index=(2*iRow+1)*nCols,tmpRows.im=data.slice(index,index+nCols),FFT.fft1d(tmpRows.re,tmpRows.im),this.reconstructTwoRealFFT(tmpRows,row1,row2),iRow0=4*iRow*ftCols,iRow1=(4*iRow+1)*ftCols,iRow2=(4*iRow+2)*ftCols,iRow3=(4*iRow+3)*ftCols;for(var k=ftCols-1;k>=0;k--)tempTransform[iRow0+k]=row1.re[k],tempTransform[iRow1+k]=row1.im[k],tempTransform[iRow2+k]=row2.re[k],tempTransform[iRow3+k]=row2.im[k]}row1=null,row2=null;var finalTransform=Array(ftRows*ftCols);FFT.init(nRows);for(var tmpCols={re:Array(nRows),im:Array(nRows)},iCol=ftCols-1;iCol>=0;iCol--){for(var iRow=nRows-1;iRow>=0;iRow--)tmpCols.re[iRow]=tempTransform[2*iRow*ftCols+iCol],tmpCols.im[iRow]=tempTransform[(2*iRow+1)*ftCols+iCol],isNaN(tmpCols.re[iRow])&&(tmpCols.re[iRow]=0),isNaN(tmpCols.im[iRow])&&(tmpCols.im[iRow]=0);FFT.fft1d(tmpCols.re,tmpCols.im);for(var iRow=nRows-1;iRow>=0;iRow--)finalTransform[2*iRow*ftCols+iCol]=tmpCols.re[iRow],finalTransform[(2*iRow+1)*ftCols+iCol]=tmpCols.im[iRow]}return finalTransform},reconstructTwoRealFFT:function(fourierTransform,realTransform1,realTransform2){var rm,rp,im,ip,j,length=fourierTransform.re.length;realTransform1.re[0]=fourierTransform.re[0],realTransform1.im[0]=0,realTransform2.re[0]=fourierTransform.im[0],realTransform2.im[0]=0;for(var i=length/2;i>0;i--)j=length-i,rm=.5*(fourierTransform.re[i]-fourierTransform.re[j]),rp=.5*(fourierTransform.re[i]+fourierTransform.re[j]),im=.5*(fourierTransform.im[i]-fourierTransform.im[j]),ip=.5*(fourierTransform.im[i]+fourierTransform.im[j]),realTransform1.re[i]=rp,realTransform1.im[i]=im,realTransform1.re[j]=rp,realTransform1.im[j]=-im,realTransform2.re[i]=ip,realTransform2.im[i]=-rm,realTransform2.re[j]=ip,realTransform2.im[j]=rm},convolute2DI:function(ftSignal,ftFilter,ftRows,ftCols){for(var re,im,iRow=0;iRow<ftRows/2;iRow++)for(var iCol=0;iCol<ftCols;iCol++)re=ftSignal[2*iRow*ftCols+iCol]*ftFilter[2*iRow*ftCols+iCol]-ftSignal[(2*iRow+1)*ftCols+iCol]*ftFilter[(2*iRow+1)*ftCols+iCol],im=ftSignal[2*iRow*ftCols+iCol]*ftFilter[(2*iRow+1)*ftCols+iCol]+ftSignal[(2*iRow+1)*ftCols+iCol]*ftFilter[2*iRow*ftCols+iCol],ftSignal[2*iRow*ftCols+iCol]=re,ftSignal[(2*iRow+1)*ftCols+iCol]=im},convolute:function(data,kernel,nRows,nCols,opt){for(var iRow,iCol,ftSpectrum=Array(nCols*nRows),i=0;i<nRows*nCols;i++)ftSpectrum[i]=data[i];ftSpectrum=this.fft2DArray(ftSpectrum,nRows,nCols);for(var dimR=kernel.length,dimC=kernel[0].length,ftFilterData=Array(nCols*nRows),i=0;i<nCols*nRows;i++)ftFilterData[i]=0;for(var shiftR=Math.floor((dimR-1)/2),shiftC=Math.floor((dimC-1)/2),ir=0;ir<dimR;ir++){iRow=(ir-shiftR+nRows)%nRows;for(var ic=0;ic<dimC;ic++)iCol=(ic-shiftC+nCols)%nCols,ftFilterData[iRow*nCols+iCol]=kernel[ir][ic]}ftFilterData=this.fft2DArray(ftFilterData,nRows,nCols);var ftRows=2*nRows,ftCols=nCols/2+1;return this.convolute2DI(ftSpectrum,ftFilterData,ftRows,ftCols),this.ifft2DArray(ftSpectrum,ftRows,ftCols)},toRadix2:function(data,nRows,nCols){var i,j,irow,icol,cols=nCols,rows=nRows;if(!(0!==nCols&&(nCols&nCols-1)==0)){for(cols=0;nCols>>++cols!=0;);cols=1<<cols}if(!(0!==nRows&&(nRows&nRows-1)==0)){for(rows=0;nRows>>++rows!=0;);rows=1<<rows}if(rows==nRows&&cols==nCols)return{data:data,rows:nRows,cols:nCols};var output=Array(rows*cols),shiftR=Math.floor((rows-nRows)/2)-nRows,shiftC=Math.floor((cols-nCols)/2)-nCols;for(i=0;i<rows;i++)for(j=0,irow=i*cols,icol=(i-shiftR)%nRows*nCols;j<cols;j++)output[irow+j]=data[icol+(j-shiftC)%nCols];return{data:output,rows:rows,cols:cols}},crop:function(data,rows,cols,nRows,nCols,opt){if(rows==nRows&&cols==nCols)return data;Object.assign({},opt);var destinyRow,sourceRow,i,j,output=Array(nCols*nRows),shiftR=Math.floor((rows-nRows)/2),shiftC=Math.floor((cols-nCols)/2);for(i=0;i<nRows;i++)for(j=0,destinyRow=i*nCols,sourceRow=(i+shiftR)*cols;j<nCols;j++)output[destinyRow+j]=data[sourceRow+(j+shiftC)];return output}};module.exports=FFTUtils},5571:function(__unused_webpack_module,exports){(function(){var FFT,version={release:"0.3.0",date:"2013-03"};(FFT=exports).toString=function(){return"version "+version.release+", released "+version.date};for(var _n=0,_bitrev=null,_cstb=null,core={init:function(n){if(0!==n&&(n&n-1)==0)_n=n,core._initArray(),core._makeBitReversalTable(),core._makeCosSinTable();else throw Error("init: radix-2 required")},fft1d:function(re,im){core.fft(re,im,1)},ifft1d:function(re,im){var n=1/_n;core.fft(re,im,-1);for(var i=0;i<_n;i++)re[i]*=n,im[i]*=n},bt1d:function(re,im){core.fft(re,im,-1)},fft2d:function(re,im){for(var tre=[],tim=[],i=0,y=0;y<_n;y++){i=y*_n;for(var x1=0;x1<_n;x1++)tre[x1]=re[x1+i],tim[x1]=im[x1+i];core.fft1d(tre,tim);for(var x2=0;x2<_n;x2++)re[x2+i]=tre[x2],im[x2+i]=tim[x2]}for(var x=0;x<_n;x++){for(var y1=0;y1<_n;y1++)i=x+y1*_n,tre[y1]=re[i],tim[y1]=im[i];core.fft1d(tre,tim);for(var y2=0;y2<_n;y2++)re[i=x+y2*_n]=tre[y2],im[i]=tim[y2]}},ifft2d:function(re,im){for(var tre=[],tim=[],i=0,y=0;y<_n;y++){i=y*_n;for(var x1=0;x1<_n;x1++)tre[x1]=re[x1+i],tim[x1]=im[x1+i];core.ifft1d(tre,tim);for(var x2=0;x2<_n;x2++)re[x2+i]=tre[x2],im[x2+i]=tim[x2]}for(var x=0;x<_n;x++){for(var y1=0;y1<_n;y1++)i=x+y1*_n,tre[y1]=re[i],tim[y1]=im[i];core.ifft1d(tre,tim);for(var y2=0;y2<_n;y2++)re[i=x+y2*_n]=tre[y2],im[i]=tim[y2]}},fft:function(re,im,inv){for(var d,h,ik,m,tmp,wr,wi,xr,xi,n4=_n>>2,l=0;l<_n;l++)m=_bitrev[l],l<m&&(tmp=re[l],re[l]=re[m],re[m]=tmp,tmp=im[l],im[l]=im[m],im[m]=tmp);for(var k=1;k<_n;k<<=1){h=0,d=_n/(k<<1);for(var j=0;j<k;j++){wr=_cstb[h+n4],wi=inv*_cstb[h];for(var i=j;i<_n;i+=k<<1)xr=wr*re[ik=i+k]+wi*im[ik],xi=wr*im[ik]-wi*re[ik],re[ik]=re[i]-xr,re[i]+=xr,im[ik]=im[i]-xi,im[i]+=xi;h+=d}}},_initArray:function(){_bitrev="undefined"!=typeof Uint32Array?new Uint32Array(_n):[],_cstb="undefined"!=typeof Float64Array?new Float64Array(1.25*_n):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var i=0,j=0,k=0;for(_bitrev[0]=0;++i<_n;){for(k=_n>>1;k<=j;)j-=k,k>>=1;j+=k,_bitrev[i]=j}},_makeCosSinTable:function(){var n2=_n>>1,n4=_n>>2,n8=_n>>3,n2p4=n2+n4,t=Math.sin(Math.PI/_n),dc=2*t*t,ds=Math.sqrt(dc*(2-dc)),c=_cstb[n4]=1,s=_cstb[0]=0;t=2*dc;for(var i=1;i<n8;i++)c-=dc,dc+=t*c,s+=ds,ds-=t*s,_cstb[i]=s,_cstb[n4-i]=c;0!==n8&&(_cstb[n8]=Math.sqrt(.5));for(var j=0;j<n4;j++)_cstb[n2-j]=_cstb[j];for(var k=0;k<n2p4;k++)_cstb[k+n2]=-_cstb[k]}},apis=["init","fft1d","ifft1d","fft2d","ifft2d"],i=0;i<apis.length;i++)FFT[apis[i]]=core[apis[i]];return FFT.bt=core.bt1d,FFT.fft=core.fft1d,FFT.ifft=core.ifft1d,FFT}).call(this)},3910:function(__unused_webpack_module,exports,__webpack_require__){"use strict";exports.FFTUtils=__webpack_require__(7080),__webpack_require__(5571)},8881:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{squaredEuclidean}=__webpack_require__(4953),defaultOptions={sigma:1};class GaussianKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.sigma=options.sigma,this.divisor=2*options.sigma*options.sigma}compute(x,y){let distance=squaredEuclidean(x,y);return Math.exp(-distance/this.divisor)}}module.exports=GaussianKernel},4229:function(module){"use strict";let defaultOptions={degree:1,constant:1,scale:1};class PolynomialKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.degree=options.degree,this.constant=options.constant,this.scale=options.scale}compute(x,y){for(var sum=0,i=0;i<x.length;i++)sum+=x[i]*y[i];return Math.pow(this.scale*sum+this.constant,this.degree)}}module.exports=PolynomialKernel},7613:function(module){"use strict";let defaultOptions={alpha:.01,constant:-Math.E};class SigmoidKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.alpha=options.alpha,this.constant=options.constant}compute(x,y){for(var sum=0,i=0;i<x.length;i++)sum+=x[i]*y[i];return Math.tanh(this.alpha*sum+this.constant)}}module.exports=SigmoidKernel},6952:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{Matrix,MatrixTransposeView}=__webpack_require__(8406),GaussianKernel=__webpack_require__(8881),PolynomialKernel=__webpack_require__(4229),SigmoidKernel=__webpack_require__(7613),ANOVAKernel=__webpack_require__(8541),CauchyKernel=__webpack_require__(9176),ExponentialKernel=__webpack_require__(3316),HistogramKernel=__webpack_require__(1960),LaplacianKernel=__webpack_require__(8557),MultiquadraticKernel=__webpack_require__(8609),RationalKernel=__webpack_require__(3029),kernelType={gaussian:GaussianKernel,rbf:GaussianKernel,polynomial:PolynomialKernel,poly:PolynomialKernel,anova:ANOVAKernel,cauchy:CauchyKernel,exponential:ExponentialKernel,histogram:HistogramKernel,min:HistogramKernel,laplacian:LaplacianKernel,multiquadratic:MultiquadraticKernel,rational:RationalKernel,sigmoid:SigmoidKernel,mlp:SigmoidKernel};class Kernel{constructor(type,options){if(this.kernelType=type,"linear"===type)return;if("string"==typeof type){var KernelConstructor=kernelType[type=type.toLowerCase()];if(KernelConstructor)this.kernelFunction=new KernelConstructor(options);else throw Error(`unsupported kernel type: ${type}`)}else if("object"==typeof type&&"function"==typeof type.compute)this.kernelFunction=type;else throw TypeError("first argument must be a valid kernel type or instance")}compute(inputs,landmarks){if(inputs=Matrix.checkMatrix(inputs),landmarks=void 0===landmarks?inputs:Matrix.checkMatrix(landmarks),"linear"===this.kernelType)return inputs.mmul(new MatrixTransposeView(landmarks));let kernelMatrix=new Matrix(inputs.rows,landmarks.rows);if(inputs===landmarks)for(let i=0;i<inputs.rows;i++)for(let j=i;j<inputs.rows;j++){let value=this.kernelFunction.compute(inputs.getRow(i),inputs.getRow(j));kernelMatrix.set(i,j,value),kernelMatrix.set(j,i,value)}else for(let i1=0;i1<inputs.rows;i1++)for(let j1=0;j1<landmarks.rows;j1++)kernelMatrix.set(i1,j1,this.kernelFunction.compute(inputs.getRow(i1),landmarks.getRow(j1)));return kernelMatrix}}module.exports=Kernel},8541:function(module){"use strict";let defaultOptions={sigma:1,degree:1};class ANOVAKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.sigma=options.sigma,this.degree=options.degree}compute(x,y){for(var sum=0,len=Math.min(x.length,y.length),i=1;i<=len;++i)sum+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(x[i-1],i)-Math.pow(y[i-1],i),2)),this.degree);return sum}}module.exports=ANOVAKernel},9176:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{squaredEuclidean}=__webpack_require__(4953),defaultOptions={sigma:1};class CauchyKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.sigma=options.sigma}compute(x,y){return 1/(1+squaredEuclidean(x,y)/(this.sigma*this.sigma))}}module.exports=CauchyKernel},3316:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{euclidean}=__webpack_require__(4953),defaultOptions={sigma:1};class ExponentialKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.sigma=options.sigma,this.divisor=2*options.sigma*options.sigma}compute(x,y){let distance=euclidean(x,y);return Math.exp(-distance/this.divisor)}}module.exports=ExponentialKernel},1960:function(module){"use strict";class HistogramIntersectionKernel{compute(x,y){for(var min=Math.min(x.length,y.length),sum=0,i=0;i<min;++i)sum+=Math.min(x[i],y[i]);return sum}}module.exports=HistogramIntersectionKernel},8557:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{euclidean}=__webpack_require__(4953),defaultOptions={sigma:1};class LaplacianKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.sigma=options.sigma}compute(x,y){let distance=euclidean(x,y);return Math.exp(-distance/this.sigma)}}module.exports=LaplacianKernel},8609:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{squaredEuclidean}=__webpack_require__(4953),defaultOptions={constant:1};class MultiquadraticKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.constant=options.constant}compute(x,y){return Math.sqrt(squaredEuclidean(x,y)+this.constant*this.constant)}}module.exports=MultiquadraticKernel},3029:function(module,__unused_webpack_exports,__webpack_require__){"use strict";let{squaredEuclidean}=__webpack_require__(4953),defaultOptions={constant:1};class RationalQuadraticKernel{constructor(options){options=Object.assign({},defaultOptions,options),this.constant=options.constant}compute(x,y){let distance=squaredEuclidean(x,y);return 1-distance/(distance+this.constant)}}module.exports=RationalQuadraticKernel},414:function(module,__unused_webpack_exports,__webpack_require__){var FFTUtils=__webpack_require__(3910).FFTUtils;function convolutionFFT(input,kernel,opt){var nRows,nCols,i,j,tmp=matrix2Array(input),inputData=tmp.data,options=Object.assign({normalize:!1,divisor:1,rows:tmp.rows,cols:tmp.cols},opt);if(options.rows&&options.cols)nRows=options.rows,nCols=options.cols;else throw Error("Invalid number of rows or columns "+nRows+" "+nCols);var divisor=options.divisor,kHeight=kernel.length,kWidth=kernel[0].length;if(options.normalize)for(i=0,divisor=0;i<kHeight;i++)for(j=0;j<kWidth;j++)divisor+=kernel[i][j];if(0===divisor)throw RangeError("convolution: The divisor is equal to zero");var radix2Sized=FFTUtils.toRadix2(inputData,nRows,nCols),conv=FFTUtils.convolute(radix2Sized.data,kernel,radix2Sized.rows,radix2Sized.cols);if(conv=FFTUtils.crop(conv,radix2Sized.rows,radix2Sized.cols,nRows,nCols),0!=divisor&&1!=divisor)for(i=0;i<conv.length;i++)conv[i]/=divisor;return conv}function convolutionDirect(input,kernel,opt){var nRows,nCols,i,j,x,y,index,sum,kVal,row,col,tmp=matrix2Array(input),inputData=tmp.data,options=Object.assign({normalize:!1,divisor:1,rows:tmp.rows,cols:tmp.cols},opt);if(options.rows&&options.cols)nRows=options.rows,nCols=options.cols;else throw Error("Invalid number of rows or columns "+nRows+" "+nCols);var divisor=options.divisor,kHeight=kernel.length,kWidth=kernel[0].length;if(options.normalize)for(i=0,divisor=0;i<kHeight;i++)for(j=0;j<kWidth;j++)divisor+=kernel[i][j];if(0===divisor)throw RangeError("convolution: The divisor is equal to zero");var output=Array(nRows*nCols),hHeight=Math.floor(kHeight/2),hWidth=Math.floor(kWidth/2);for(y=0;y<nRows;y++)for(x=0;x<nCols;x++){for(j=0,sum=0;j<kHeight;j++)for(i=0;i<kWidth;i++)kVal=kernel[kHeight-j-1][kWidth-i-1],row=(y+j-hHeight+nRows)%nRows,col=(x+i-hWidth+nCols)%nCols,sum+=inputData[index=row*nCols+col]*kVal;output[index=y*nCols+x]=sum/divisor}return output}function LoG(sigma,nPoints,options){var i,j,tmp,y2,factor=1e3;options&&options.factor&&(factor=options.factor);var kernel=Array(nPoints);factor*=-1;var center=(nPoints-1)/2,sigma2=2*sigma*sigma;for(i=0;i<nPoints;i++)for(j=0,kernel[i]=Array(nPoints),y2=(i-center)*(i-center);j<nPoints;j++)tmp=-((j-center)*(j-center)+y2)/sigma2,kernel[i][j]=Math.round(factor*(1+tmp)*Math.exp(tmp));return kernel}function matrix2Array(input){var nRows,nCols,inputData=input;if("number"!=typeof input[0]){inputData=Array((nRows=input.length)*(nCols=input[0].length));for(var i=0;i<nRows;i++)for(var j=0;j<nCols;j++)inputData[i*nCols+j]=input[i][j]}else{var tmp=Math.sqrt(input.length);Number.isInteger(tmp)&&(nRows=tmp,nCols=tmp)}return{data:inputData,rows:nRows,cols:nCols}}module.exports={fft:convolutionFFT,direct:convolutionDirect,kernelFactory:{LoG:LoG},matrix2Array:matrix2Array}},8406:function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isAnyArray=__webpack_require__(4091),rescale=__webpack_require__(5823);let indent=" ".repeat(2),indentData=" ".repeat(4);function inspectMatrix(){return inspectMatrixWithOptions(this)}function inspectMatrixWithOptions(matrix,options={}){let{maxRows=15,maxColumns=10,maxNumSize=8,padMinus="auto"}=options;return`${matrix.constructor.name} {
${indent}[
${indentData}${inspectData(matrix,maxRows,maxColumns,maxNumSize,padMinus)}
${indent}]
${indent}rows: ${matrix.rows}
${indent}columns: ${matrix.columns}
}`}function inspectData(matrix,maxRows,maxColumns,maxNumSize,padMinus){let{rows,columns}=matrix,maxI=Math.min(rows,maxRows),maxJ=Math.min(columns,maxColumns),result=[];if("auto"===padMinus){padMinus=!1;loop:for(let i=0;i<maxI;i++)for(let j=0;j<maxJ;j++)if(0>matrix.get(i,j)){padMinus=!0;break loop}}for(let i1=0;i1<maxI;i1++){let line=[];for(let j1=0;j1<maxJ;j1++)line.push(formatNumber(matrix.get(i1,j1),maxNumSize,padMinus));result.push(`${line.join(" ")}`)}return maxJ!==columns&&(result[result.length-1]+=` ... ${columns-maxColumns} more columns`),maxI!==rows&&result.push(`... ${rows-maxRows} more rows`),result.join(`
${indentData}`)}function formatNumber(num,maxNumSize,padMinus){return(num>=0&&padMinus?` ${formatNumber2(num,maxNumSize-1)}`:formatNumber2(num,maxNumSize)).padEnd(maxNumSize)}function formatNumber2(num,len){let str=num.toString();if(str.length<=len)return str;let fix=num.toFixed(len);if(fix.length>len&&(fix=num.toFixed(Math.max(0,len-(fix.length-len)))),fix.length<=len&&!fix.startsWith("0.000")&&!fix.startsWith("-0.000"))return fix;let exp=num.toExponential(len);return exp.length>len&&(exp=num.toExponential(Math.max(0,len-(exp.length-len)))),exp.slice(0)}function installMathOperations(AbstractMatrix,Matrix){AbstractMatrix.prototype.add=function(value){return"number"==typeof value?this.addS(value):this.addM(value)},AbstractMatrix.prototype.addS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+value);return this},AbstractMatrix.prototype.addM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+matrix.get(i,j));return this},AbstractMatrix.add=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.add(value)},AbstractMatrix.prototype.sub=function(value){return"number"==typeof value?this.subS(value):this.subM(value)},AbstractMatrix.prototype.subS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-value);return this},AbstractMatrix.prototype.subM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-matrix.get(i,j));return this},AbstractMatrix.sub=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.sub(value)},AbstractMatrix.prototype.subtract=AbstractMatrix.prototype.sub,AbstractMatrix.prototype.subtractS=AbstractMatrix.prototype.subS,AbstractMatrix.prototype.subtractM=AbstractMatrix.prototype.subM,AbstractMatrix.subtract=AbstractMatrix.sub,AbstractMatrix.prototype.mul=function(value){return"number"==typeof value?this.mulS(value):this.mulM(value)},AbstractMatrix.prototype.mulS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*value);return this},AbstractMatrix.prototype.mulM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*matrix.get(i,j));return this},AbstractMatrix.mul=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.mul(value)},AbstractMatrix.prototype.multiply=AbstractMatrix.prototype.mul,AbstractMatrix.prototype.multiplyS=AbstractMatrix.prototype.mulS,AbstractMatrix.prototype.multiplyM=AbstractMatrix.prototype.mulM,AbstractMatrix.multiply=AbstractMatrix.mul,AbstractMatrix.prototype.div=function(value){return"number"==typeof value?this.divS(value):this.divM(value)},AbstractMatrix.prototype.divS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/value);return this},AbstractMatrix.prototype.divM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/matrix.get(i,j));return this},AbstractMatrix.div=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.div(value)},AbstractMatrix.prototype.divide=AbstractMatrix.prototype.div,AbstractMatrix.prototype.divideS=AbstractMatrix.prototype.divS,AbstractMatrix.prototype.divideM=AbstractMatrix.prototype.divM,AbstractMatrix.divide=AbstractMatrix.div,AbstractMatrix.prototype.mod=function(value){return"number"==typeof value?this.modS(value):this.modM(value)},AbstractMatrix.prototype.modS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)%value);return this},AbstractMatrix.prototype.modM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)%matrix.get(i,j));return this},AbstractMatrix.mod=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.mod(value)},AbstractMatrix.prototype.modulus=AbstractMatrix.prototype.mod,AbstractMatrix.prototype.modulusS=AbstractMatrix.prototype.modS,AbstractMatrix.prototype.modulusM=AbstractMatrix.prototype.modM,AbstractMatrix.modulus=AbstractMatrix.mod,AbstractMatrix.prototype.and=function(value){return"number"==typeof value?this.andS(value):this.andM(value)},AbstractMatrix.prototype.andS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)&value);return this},AbstractMatrix.prototype.andM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)&matrix.get(i,j));return this},AbstractMatrix.and=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.and(value)},AbstractMatrix.prototype.or=function(value){return"number"==typeof value?this.orS(value):this.orM(value)},AbstractMatrix.prototype.orS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)|value);return this},AbstractMatrix.prototype.orM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)|matrix.get(i,j));return this},AbstractMatrix.or=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.or(value)},AbstractMatrix.prototype.xor=function(value){return"number"==typeof value?this.xorS(value):this.xorM(value)},AbstractMatrix.prototype.xorS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)^value);return this},AbstractMatrix.prototype.xorM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)^matrix.get(i,j));return this},AbstractMatrix.xor=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.xor(value)},AbstractMatrix.prototype.leftShift=function(value){return"number"==typeof value?this.leftShiftS(value):this.leftShiftM(value)},AbstractMatrix.prototype.leftShiftS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)<<value);return this},AbstractMatrix.prototype.leftShiftM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)<<matrix.get(i,j));return this},AbstractMatrix.leftShift=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.leftShift(value)},AbstractMatrix.prototype.signPropagatingRightShift=function(value){return"number"==typeof value?this.signPropagatingRightShiftS(value):this.signPropagatingRightShiftM(value)},AbstractMatrix.prototype.signPropagatingRightShiftS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>value);return this},AbstractMatrix.prototype.signPropagatingRightShiftM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>matrix.get(i,j));return this},AbstractMatrix.signPropagatingRightShift=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.signPropagatingRightShift(value)},AbstractMatrix.prototype.rightShift=function(value){return"number"==typeof value?this.rightShiftS(value):this.rightShiftM(value)},AbstractMatrix.prototype.rightShiftS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>>value);return this},AbstractMatrix.prototype.rightShiftM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>>matrix.get(i,j));return this},AbstractMatrix.rightShift=function(matrix,value){let newMatrix=new Matrix(matrix);return newMatrix.rightShift(value)},AbstractMatrix.prototype.zeroFillRightShift=AbstractMatrix.prototype.rightShift,AbstractMatrix.prototype.zeroFillRightShiftS=AbstractMatrix.prototype.rightShiftS,AbstractMatrix.prototype.zeroFillRightShiftM=AbstractMatrix.prototype.rightShiftM,AbstractMatrix.zeroFillRightShift=AbstractMatrix.rightShift,AbstractMatrix.prototype.not=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,~this.get(i,j));return this},AbstractMatrix.not=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.not()},AbstractMatrix.prototype.abs=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.abs(this.get(i,j)));return this},AbstractMatrix.abs=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.abs()},AbstractMatrix.prototype.acos=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.acos(this.get(i,j)));return this},AbstractMatrix.acos=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.acos()},AbstractMatrix.prototype.acosh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.acosh(this.get(i,j)));return this},AbstractMatrix.acosh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.acosh()},AbstractMatrix.prototype.asin=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.asin(this.get(i,j)));return this},AbstractMatrix.asin=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.asin()},AbstractMatrix.prototype.asinh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.asinh(this.get(i,j)));return this},AbstractMatrix.asinh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.asinh()},AbstractMatrix.prototype.atan=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.atan(this.get(i,j)));return this},AbstractMatrix.atan=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.atan()},AbstractMatrix.prototype.atanh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.atanh(this.get(i,j)));return this},AbstractMatrix.atanh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.atanh()},AbstractMatrix.prototype.cbrt=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cbrt(this.get(i,j)));return this},AbstractMatrix.cbrt=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.cbrt()},AbstractMatrix.prototype.ceil=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.ceil(this.get(i,j)));return this},AbstractMatrix.ceil=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.ceil()},AbstractMatrix.prototype.clz32=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.clz32(this.get(i,j)));return this},AbstractMatrix.clz32=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.clz32()},AbstractMatrix.prototype.cos=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cos(this.get(i,j)));return this},AbstractMatrix.cos=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.cos()},AbstractMatrix.prototype.cosh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cosh(this.get(i,j)));return this},AbstractMatrix.cosh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.cosh()},AbstractMatrix.prototype.exp=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.exp(this.get(i,j)));return this},AbstractMatrix.exp=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.exp()},AbstractMatrix.prototype.expm1=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.expm1(this.get(i,j)));return this},AbstractMatrix.expm1=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.expm1()},AbstractMatrix.prototype.floor=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.floor(this.get(i,j)));return this},AbstractMatrix.floor=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.floor()},AbstractMatrix.prototype.fround=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.fround(this.get(i,j)));return this},AbstractMatrix.fround=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.fround()},AbstractMatrix.prototype.log=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log(this.get(i,j)));return this},AbstractMatrix.log=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.log()},AbstractMatrix.prototype.log1p=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log1p(this.get(i,j)));return this},AbstractMatrix.log1p=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.log1p()},AbstractMatrix.prototype.log10=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log10(this.get(i,j)));return this},AbstractMatrix.log10=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.log10()},AbstractMatrix.prototype.log2=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log2(this.get(i,j)));return this},AbstractMatrix.log2=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.log2()},AbstractMatrix.prototype.round=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.round(this.get(i,j)));return this},AbstractMatrix.round=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.round()},AbstractMatrix.prototype.sign=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sign(this.get(i,j)));return this},AbstractMatrix.sign=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.sign()},AbstractMatrix.prototype.sin=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sin(this.get(i,j)));return this},AbstractMatrix.sin=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.sin()},AbstractMatrix.prototype.sinh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sinh(this.get(i,j)));return this},AbstractMatrix.sinh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.sinh()},AbstractMatrix.prototype.sqrt=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sqrt(this.get(i,j)));return this},AbstractMatrix.sqrt=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.sqrt()},AbstractMatrix.prototype.tan=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.tan(this.get(i,j)));return this},AbstractMatrix.tan=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.tan()},AbstractMatrix.prototype.tanh=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.tanh(this.get(i,j)));return this},AbstractMatrix.tanh=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.tanh()},AbstractMatrix.prototype.trunc=function(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.trunc(this.get(i,j)));return this},AbstractMatrix.trunc=function(matrix){let newMatrix=new Matrix(matrix);return newMatrix.trunc()},AbstractMatrix.pow=function(matrix,arg0){let newMatrix=new Matrix(matrix);return newMatrix.pow(arg0)},AbstractMatrix.prototype.pow=function(value){return"number"==typeof value?this.powS(value):this.powM(value)},AbstractMatrix.prototype.powS=function(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)**value);return this},AbstractMatrix.prototype.powM=function(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)**matrix.get(i,j));return this}}function checkRowIndex(matrix,index,outer){let max=outer?matrix.rows:matrix.rows-1;if(index<0||index>max)throw RangeError("Row index out of range")}function checkColumnIndex(matrix,index,outer){let max=outer?matrix.columns:matrix.columns-1;if(index<0||index>max)throw RangeError("Column index out of range")}function checkRowVector(matrix,vector){if(vector.to1DArray&&(vector=vector.to1DArray()),vector.length!==matrix.columns)throw RangeError("vector size must be the same as the number of columns");return vector}function checkColumnVector(matrix,vector){if(vector.to1DArray&&(vector=vector.to1DArray()),vector.length!==matrix.rows)throw RangeError("vector size must be the same as the number of rows");return vector}function checkRowIndices(matrix,rowIndices){if(!isAnyArray.isAnyArray(rowIndices))throw TypeError("row indices must be an array");for(let i=0;i<rowIndices.length;i++)if(rowIndices[i]<0||rowIndices[i]>=matrix.rows)throw RangeError("row indices are out of range")}function checkColumnIndices(matrix,columnIndices){if(!isAnyArray.isAnyArray(columnIndices))throw TypeError("column indices must be an array");for(let i=0;i<columnIndices.length;i++)if(columnIndices[i]<0||columnIndices[i]>=matrix.columns)throw RangeError("column indices are out of range")}function checkRange(matrix,startRow,endRow,startColumn,endColumn){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(checkNumber("startRow",startRow),checkNumber("endRow",endRow),checkNumber("startColumn",startColumn),checkNumber("endColumn",endColumn),startRow>endRow||startColumn>endColumn||startRow<0||startRow>=matrix.rows||endRow<0||endRow>=matrix.rows||startColumn<0||startColumn>=matrix.columns||endColumn<0||endColumn>=matrix.columns)throw RangeError("Submatrix indices are out of range")}function newArray(length,value=0){let array=[];for(let i=0;i<length;i++)array.push(value);return array}function checkNumber(name,value){if("number"!=typeof value)throw TypeError(`${name} must be a number`)}function checkNonEmpty(matrix){if(matrix.isEmpty())throw Error("Empty matrix has no elements to index")}function sumByRow(matrix){let sum=newArray(matrix.rows);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[i]+=matrix.get(i,j);return sum}function sumByColumn(matrix){let sum=newArray(matrix.columns);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[j]+=matrix.get(i,j);return sum}function sumAll(matrix){let v=0;for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)v+=matrix.get(i,j);return v}function productByRow(matrix){let sum=newArray(matrix.rows,1);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[i]*=matrix.get(i,j);return sum}function productByColumn(matrix){let sum=newArray(matrix.columns,1);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[j]*=matrix.get(i,j);return sum}function productAll(matrix){let v=1;for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)v*=matrix.get(i,j);return v}function varianceByRow(matrix,unbiased,mean){let rows=matrix.rows,cols=matrix.columns,variance=[];for(let i=0;i<rows;i++){let sum1=0,sum2=0,x=0;for(let j=0;j<cols;j++)sum1+=x=matrix.get(i,j)-mean[i],sum2+=x*x;unbiased?variance.push((sum2-sum1*sum1/cols)/(cols-1)):variance.push((sum2-sum1*sum1/cols)/cols)}return variance}function varianceByColumn(matrix,unbiased,mean){let rows=matrix.rows,cols=matrix.columns,variance=[];for(let j=0;j<cols;j++){let sum1=0,sum2=0,x=0;for(let i=0;i<rows;i++)sum1+=x=matrix.get(i,j)-mean[j],sum2+=x*x;unbiased?variance.push((sum2-sum1*sum1/rows)/(rows-1)):variance.push((sum2-sum1*sum1/rows)/rows)}return variance}function varianceAll(matrix,unbiased,mean){let rows=matrix.rows,cols=matrix.columns,size=rows*cols,sum1=0,sum2=0,x=0;for(let i=0;i<rows;i++)for(let j=0;j<cols;j++)sum1+=x=matrix.get(i,j)-mean,sum2+=x*x;return unbiased?(sum2-sum1*sum1/size)/(size-1):(sum2-sum1*sum1/size)/size}function centerByRow(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean[i])}function centerByColumn(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean[j])}function centerAll(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean)}function getScaleByRow(matrix){let scale=[];for(let i=0;i<matrix.rows;i++){let sum=0;for(let j=0;j<matrix.columns;j++)sum+=matrix.get(i,j)**2/(matrix.columns-1);scale.push(Math.sqrt(sum))}return scale}function scaleByRow(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale[i])}function getScaleByColumn(matrix){let scale=[];for(let j=0;j<matrix.columns;j++){let sum=0;for(let i=0;i<matrix.rows;i++)sum+=matrix.get(i,j)**2/(matrix.rows-1);scale.push(Math.sqrt(sum))}return scale}function scaleByColumn(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale[j])}function getScaleAll(matrix){let divider=matrix.size-1,sum=0;for(let j=0;j<matrix.columns;j++)for(let i=0;i<matrix.rows;i++)sum+=matrix.get(i,j)**2/divider;return Math.sqrt(sum)}function scaleAll(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale)}class AbstractMatrix{static from1DArray(newRows,newColumns,newData){if(newRows*newColumns!==newData.length)throw RangeError("data length does not match given dimensions");let newMatrix=new Matrix(newRows,newColumns);for(let row=0;row<newRows;row++)for(let column=0;column<newColumns;column++)newMatrix.set(row,column,newData[row*newColumns+column]);return newMatrix}static rowVector(newData){let vector=new Matrix(1,newData.length);for(let i=0;i<newData.length;i++)vector.set(0,i,newData[i]);return vector}static columnVector(newData){let vector=new Matrix(newData.length,1);for(let i=0;i<newData.length;i++)vector.set(i,0,newData[i]);return vector}static zeros(rows,columns){return new Matrix(rows,columns)}static ones(rows,columns){return new Matrix(rows,columns).fill(1)}static rand(rows,columns,options={}){if("object"!=typeof options)throw TypeError("options must be an object");let{random=Math.random}=options,matrix=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)matrix.set(i,j,random());return matrix}static randInt(rows,columns,options={}){if("object"!=typeof options)throw TypeError("options must be an object");let{min=0,max=1e3,random=Math.random}=options;if(!Number.isInteger(min))throw TypeError("min must be an integer");if(!Number.isInteger(max))throw TypeError("max must be an integer");if(min>=max)throw RangeError("min must be smaller than max");let interval=max-min,matrix=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++){let value=min+Math.round(random()*interval);matrix.set(i,j,value)}return matrix}static eye(rows,columns,value){void 0===columns&&(columns=rows),void 0===value&&(value=1);let min=Math.min(rows,columns),matrix=this.zeros(rows,columns);for(let i=0;i<min;i++)matrix.set(i,i,value);return matrix}static diag(data,rows,columns){let l=data.length;void 0===rows&&(rows=l),void 0===columns&&(columns=rows);let min=Math.min(l,rows,columns),matrix=this.zeros(rows,columns);for(let i=0;i<min;i++)matrix.set(i,i,data[i]);return matrix}static min(matrix1,matrix2){matrix1=this.checkMatrix(matrix1),matrix2=this.checkMatrix(matrix2);let rows=matrix1.rows,columns=matrix1.columns,result=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)result.set(i,j,Math.min(matrix1.get(i,j),matrix2.get(i,j)));return result}static max(matrix1,matrix2){matrix1=this.checkMatrix(matrix1),matrix2=this.checkMatrix(matrix2);let rows=matrix1.rows,columns=matrix1.columns,result=new this(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)result.set(i,j,Math.max(matrix1.get(i,j),matrix2.get(i,j)));return result}static checkMatrix(value){return AbstractMatrix.isMatrix(value)?value:new Matrix(value)}static isMatrix(value){return null!=value&&"Matrix"===value.klass}get size(){return this.rows*this.columns}apply(callback){if("function"!=typeof callback)throw TypeError("callback must be a function");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)callback.call(this,i,j);return this}to1DArray(){let array=[];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)array.push(this.get(i,j));return array}to2DArray(){let copy=[];for(let i=0;i<this.rows;i++){copy.push([]);for(let j=0;j<this.columns;j++)copy[i].push(this.get(i,j))}return copy}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let i=0;i<this.rows;i++)for(let j=0;j<=i;j++)if(this.get(i,j)!==this.get(j,i))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let i=0;i<this.rows;i++)if(0!==this.get(i,i))return!1;return!0}isEchelonForm(){let i=0,j=0,previousColumn=-1,isEchelonForm=!0,checked=!1;for(;i<this.rows&&isEchelonForm;){for(j=0,checked=!1;j<this.columns&&!1===checked;)0===this.get(i,j)?j++:1===this.get(i,j)&&j>previousColumn?(checked=!0,previousColumn=j):(isEchelonForm=!1,checked=!0);i++}return isEchelonForm}isReducedEchelonForm(){let i=0,j=0,previousColumn=-1,isReducedEchelonForm=!0,checked=!1;for(;i<this.rows&&isReducedEchelonForm;){for(j=0,checked=!1;j<this.columns&&!1===checked;)0===this.get(i,j)?j++:1===this.get(i,j)&&j>previousColumn?(checked=!0,previousColumn=j):(isReducedEchelonForm=!1,checked=!0);for(let k=j+1;k<this.rows;k++)0!==this.get(i,k)&&(isReducedEchelonForm=!1);i++}return isReducedEchelonForm}echelonForm(){let result=this.clone(),h=0,k=0;for(;h<result.rows&&k<result.columns;){let iMax=h;for(let i=h;i<result.rows;i++)result.get(i,k)>result.get(iMax,k)&&(iMax=i);if(0===result.get(iMax,k))k++;else{result.swapRows(h,iMax);let tmp=result.get(h,k);for(let j=k;j<result.columns;j++)result.set(h,j,result.get(h,j)/tmp);for(let i1=h+1;i1<result.rows;i1++){let factor=result.get(i1,k)/result.get(h,k);result.set(i1,k,0);for(let j1=k+1;j1<result.columns;j1++)result.set(i1,j1,result.get(i1,j1)-result.get(h,j1)*factor)}h++,k++}}return result}reducedEchelonForm(){let result=this.echelonForm(),m=result.columns,n=result.rows,h=n-1;for(;h>=0;)if(0===result.maxRow(h))h--;else{let p=0,pivot=!1;for(;p<n&&!1===pivot;)1===result.get(h,p)?pivot=!0:p++;for(let i=0;i<h;i++){let factor=result.get(i,p);for(let j=p;j<m;j++){let tmp=result.get(i,j)-factor*result.get(h,j);result.set(i,j,tmp)}}h--}return result}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(options={}){if("object"!=typeof options)throw TypeError("options must be an object");let{rows=1,columns=1}=options;if(!Number.isInteger(rows)||rows<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(columns)||columns<=0)throw TypeError("columns must be a positive integer");let matrix=new Matrix(this.rows*rows,this.columns*columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)matrix.setSubMatrix(this,this.rows*i,this.columns*j);return matrix}fill(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,value);return this}neg(){return this.mulS(-1)}getRow(index){checkRowIndex(this,index);let row=[];for(let i=0;i<this.columns;i++)row.push(this.get(index,i));return row}getRowVector(index){return Matrix.rowVector(this.getRow(index))}setRow(index,array){checkRowIndex(this,index),array=checkRowVector(this,array);for(let i=0;i<this.columns;i++)this.set(index,i,array[i]);return this}swapRows(row1,row2){checkRowIndex(this,row1),checkRowIndex(this,row2);for(let i=0;i<this.columns;i++){let temp=this.get(row1,i);this.set(row1,i,this.get(row2,i)),this.set(row2,i,temp)}return this}getColumn(index){checkColumnIndex(this,index);let column=[];for(let i=0;i<this.rows;i++)column.push(this.get(i,index));return column}getColumnVector(index){return Matrix.columnVector(this.getColumn(index))}setColumn(index,array){checkColumnIndex(this,index),array=checkColumnVector(this,array);for(let i=0;i<this.rows;i++)this.set(i,index,array[i]);return this}swapColumns(column1,column2){checkColumnIndex(this,column1),checkColumnIndex(this,column2);for(let i=0;i<this.rows;i++){let temp=this.get(i,column1);this.set(i,column1,this.get(i,column2)),this.set(i,column2,temp)}return this}addRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+vector[j]);return this}subRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-vector[j]);return this}mulRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*vector[j]);return this}divRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/vector[j]);return this}addColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+vector[i]);return this}subColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-vector[i]);return this}mulColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*vector[i]);return this}divColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/vector[i]);return this}mulRow(index,value){checkRowIndex(this,index);for(let i=0;i<this.columns;i++)this.set(index,i,this.get(index,i)*value);return this}mulColumn(index,value){checkColumnIndex(this,index);for(let i=0;i<this.rows;i++)this.set(i,index,this.get(i,index)*value);return this}max(by){if(this.isEmpty())return NaN;switch(by){case"row":{let max=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)>max[row]&&(max[row]=this.get(row,column));return max}case"column":{let max1=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let row1=0;row1<this.rows;row1++)for(let column1=0;column1<this.columns;column1++)this.get(row1,column1)>max1[column1]&&(max1[column1]=this.get(row1,column1));return max1}case void 0:{let max2=this.get(0,0);for(let row2=0;row2<this.rows;row2++)for(let column2=0;column2<this.columns;column2++)this.get(row2,column2)>max2&&(max2=this.get(row2,column2));return max2}default:throw Error(`invalid option: ${by}`)}}maxIndex(){checkNonEmpty(this);let v=this.get(0,0),idx=[0,0];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.get(i,j)>v&&(v=this.get(i,j),idx[0]=i,idx[1]=j);return idx}min(by){if(this.isEmpty())return NaN;switch(by){case"row":{let min=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)<min[row]&&(min[row]=this.get(row,column));return min}case"column":{let min1=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let row1=0;row1<this.rows;row1++)for(let column1=0;column1<this.columns;column1++)this.get(row1,column1)<min1[column1]&&(min1[column1]=this.get(row1,column1));return min1}case void 0:{let min2=this.get(0,0);for(let row2=0;row2<this.rows;row2++)for(let column2=0;column2<this.columns;column2++)this.get(row2,column2)<min2&&(min2=this.get(row2,column2));return min2}default:throw Error(`invalid option: ${by}`)}}minIndex(){checkNonEmpty(this);let v=this.get(0,0),idx=[0,0];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.get(i,j)<v&&(v=this.get(i,j),idx[0]=i,idx[1]=j);return idx}maxRow(row){if(checkRowIndex(this,row),this.isEmpty())return NaN;let v=this.get(row,0);for(let i=1;i<this.columns;i++)this.get(row,i)>v&&(v=this.get(row,i));return v}maxRowIndex(row){checkRowIndex(this,row),checkNonEmpty(this);let v=this.get(row,0),idx=[row,0];for(let i=1;i<this.columns;i++)this.get(row,i)>v&&(v=this.get(row,i),idx[1]=i);return idx}minRow(row){if(checkRowIndex(this,row),this.isEmpty())return NaN;let v=this.get(row,0);for(let i=1;i<this.columns;i++)this.get(row,i)<v&&(v=this.get(row,i));return v}minRowIndex(row){checkRowIndex(this,row),checkNonEmpty(this);let v=this.get(row,0),idx=[row,0];for(let i=1;i<this.columns;i++)this.get(row,i)<v&&(v=this.get(row,i),idx[1]=i);return idx}maxColumn(column){if(checkColumnIndex(this,column),this.isEmpty())return NaN;let v=this.get(0,column);for(let i=1;i<this.rows;i++)this.get(i,column)>v&&(v=this.get(i,column));return v}maxColumnIndex(column){checkColumnIndex(this,column),checkNonEmpty(this);let v=this.get(0,column),idx=[0,column];for(let i=1;i<this.rows;i++)this.get(i,column)>v&&(v=this.get(i,column),idx[0]=i);return idx}minColumn(column){if(checkColumnIndex(this,column),this.isEmpty())return NaN;let v=this.get(0,column);for(let i=1;i<this.rows;i++)this.get(i,column)<v&&(v=this.get(i,column));return v}minColumnIndex(column){checkColumnIndex(this,column),checkNonEmpty(this);let v=this.get(0,column),idx=[0,column];for(let i=1;i<this.rows;i++)this.get(i,column)<v&&(v=this.get(i,column),idx[0]=i);return idx}diag(){let min=Math.min(this.rows,this.columns),diag=[];for(let i=0;i<min;i++)diag.push(this.get(i,i));return diag}norm(type="frobenius"){switch(type){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${type}`)}}cumulativeSum(){let sum=0;for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)sum+=this.get(i,j),this.set(i,j,sum);return this}dot(vector2){AbstractMatrix.isMatrix(vector2)&&(vector2=vector2.to1DArray());let vector1=this.to1DArray();if(vector1.length!==vector2.length)throw RangeError("vectors do not have the same size");let dot=0;for(let i=0;i<vector1.length;i++)dot+=vector1[i]*vector2[i];return dot}mmul(other){other=Matrix.checkMatrix(other);let m=this.rows,n=this.columns,p=other.columns,result=new Matrix(m,p),Bcolj=new Float64Array(n);for(let j=0;j<p;j++){for(let k=0;k<n;k++)Bcolj[k]=other.get(k,j);for(let i=0;i<m;i++){let s=0;for(let k1=0;k1<n;k1++)s+=this.get(i,k1)*Bcolj[k1];result.set(i,j,s)}}return result}mpow(scalar){if(!this.isSquare())throw RangeError("Matrix must be square");if(!Number.isInteger(scalar)||scalar<0)throw RangeError("Exponent must be a non-negative integer");let result=Matrix.eye(this.rows),bb=this;for(let e=scalar;e>=1;e/=2)(1&e)!=0&&(result=result.mmul(bb)),bb=bb.mmul(bb);return result}strassen2x2(other){other=Matrix.checkMatrix(other);let result=new Matrix(2,2),a11=this.get(0,0),b11=other.get(0,0),a12=this.get(0,1),b12=other.get(0,1),a21=this.get(1,0),b21=other.get(1,0),a22=this.get(1,1),b22=other.get(1,1),m1=(a11+a22)*(b11+b22),m2=(a21+a22)*b11,m3=a11*(b12-b22),m4=a22*(b21-b11),m5=(a11+a12)*b22,m6=(a21-a11)*(b11+b12),m7=(a12-a22)*(b21+b22),c00=m1+m4-m5+m7,c01=m3+m5,c10=m2+m4,c11=m1-m2+m3+m6;return result.set(0,0,c00),result.set(0,1,c01),result.set(1,0,c10),result.set(1,1,c11),result}strassen3x3(other){other=Matrix.checkMatrix(other);let result=new Matrix(3,3),a00=this.get(0,0),a01=this.get(0,1),a02=this.get(0,2),a10=this.get(1,0),a11=this.get(1,1),a12=this.get(1,2),a20=this.get(2,0),a21=this.get(2,1),a22=this.get(2,2),b00=other.get(0,0),b01=other.get(0,1),b02=other.get(0,2),b10=other.get(1,0),b11=other.get(1,1),b12=other.get(1,2),b20=other.get(2,0),b21=other.get(2,1),b22=other.get(2,2),m1=(a00+a01+a02-a10-a11-a21-a22)*b11,m2=(a00-a10)*(-b01+b11),m3=a11*(-b00+b01+b10-b11-b12-b20+b22),m4=(-a00+a10+a11)*(b00-b01+b11),m5=(a10+a11)*(-b00+b01),m6=a00*b00,m7=(-a00+a20+a21)*(b00-b02+b12),m8=(-a00+a20)*(b02-b12),m9=(a20+a21)*(-b00+b02),m10=(a00+a01+a02-a11-a12-a20-a21)*b12,m11=a21*(-b00+b02+b10-b11-b12-b20+b21),m12=(-a02+a21+a22)*(b11+b20-b21),m13=(a02-a22)*(b11-b21),m14=a02*b20,m15=(a21+a22)*(-b20+b21),m16=(-a02+a11+a12)*(b12+b20-b22),m17=(a02-a12)*(b12-b22),m18=(a11+a12)*(-b20+b22),m19=a01*b10,m20=a12*b21,m21=a10*b02,m22=a20*b01,m23=a22*b22,c00=m6+m14+m19,c01=m1+m4+m5+m6+m12+m14+m15,c02=m6+m7+m9+m10+m14+m16+m18,c10=m2+m3+m4+m6+m14+m16+m17,c11=m2+m4+m5+m6+m20,c12=m14+m16+m17+m18+m21,c20=m6+m7+m8+m11+m12+m13+m14,c21=m12+m13+m14+m15+m22,c22=m6+m7+m8+m9+m23;return result.set(0,0,c00),result.set(0,1,c01),result.set(0,2,c02),result.set(1,0,c10),result.set(1,1,c11),result.set(1,2,c12),result.set(2,0,c20),result.set(2,1,c21),result.set(2,2,c22),result}mmulStrassen(y){y=Matrix.checkMatrix(y);let x=this.clone(),r1=x.rows,c1=x.columns,r2=y.rows,c2=y.columns;function embed(mat,rows,cols){let r=mat.rows,c=mat.columns;return r===rows&&c===cols?mat:AbstractMatrix.zeros(rows,cols).setSubMatrix(mat,0,0)}c1!==r2&&console.warn(`Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`);let r=Math.max(r1,r2),c=Math.max(c1,c2);function blockMult(a,b,rows,cols){if(rows<=512||cols<=512)return a.mmul(b);rows%2==1&&cols%2==1?(a=embed(a,rows+1,cols+1),b=embed(b,rows+1,cols+1)):rows%2==1?(a=embed(a,rows+1,cols),b=embed(b,rows+1,cols)):cols%2==1&&(a=embed(a,rows,cols+1),b=embed(b,rows,cols+1));let halfRows=parseInt(a.rows/2,10),halfCols=parseInt(a.columns/2,10),a11=a.subMatrix(0,halfRows-1,0,halfCols-1),b11=b.subMatrix(0,halfRows-1,0,halfCols-1),a12=a.subMatrix(0,halfRows-1,halfCols,a.columns-1),b12=b.subMatrix(0,halfRows-1,halfCols,b.columns-1),a21=a.subMatrix(halfRows,a.rows-1,0,halfCols-1),b21=b.subMatrix(halfRows,b.rows-1,0,halfCols-1),a22=a.subMatrix(halfRows,a.rows-1,halfCols,a.columns-1),b22=b.subMatrix(halfRows,b.rows-1,halfCols,b.columns-1),m1=blockMult(AbstractMatrix.add(a11,a22),AbstractMatrix.add(b11,b22),halfRows,halfCols),m2=blockMult(AbstractMatrix.add(a21,a22),b11,halfRows,halfCols),m3=blockMult(a11,AbstractMatrix.sub(b12,b22),halfRows,halfCols),m4=blockMult(a22,AbstractMatrix.sub(b21,b11),halfRows,halfCols),m5=blockMult(AbstractMatrix.add(a11,a12),b22,halfRows,halfCols),m6=blockMult(AbstractMatrix.sub(a21,a11),AbstractMatrix.add(b11,b12),halfRows,halfCols),m7=blockMult(AbstractMatrix.sub(a12,a22),AbstractMatrix.add(b21,b22),halfRows,halfCols),c11=AbstractMatrix.add(m1,m4);c11.sub(m5),c11.add(m7);let c12=AbstractMatrix.add(m3,m5),c21=AbstractMatrix.add(m2,m4),c22=AbstractMatrix.sub(m1,m2);c22.add(m3),c22.add(m6);let result=AbstractMatrix.zeros(2*c11.rows,2*c11.columns);return(result=(result=(result=(result=result.setSubMatrix(c11,0,0)).setSubMatrix(c12,c11.rows,0)).setSubMatrix(c21,0,c11.columns)).setSubMatrix(c22,c11.rows,c11.columns)).subMatrix(0,rows-1,0,cols-1)}return blockMult(x=embed(x,r,c),y=embed(y,r,c),r,c)}scaleRows(options={}){if("object"!=typeof options)throw TypeError("options must be an object");let{min=0,max=1}=options;if(!Number.isFinite(min))throw TypeError("min must be a number");if(!Number.isFinite(max))throw TypeError("max must be a number");if(min>=max)throw RangeError("min must be smaller than max");let newMatrix=new Matrix(this.rows,this.columns);for(let i=0;i<this.rows;i++){let row=this.getRow(i);row.length>0&&rescale(row,{min,max,output:row}),newMatrix.setRow(i,row)}return newMatrix}scaleColumns(options={}){if("object"!=typeof options)throw TypeError("options must be an object");let{min=0,max=1}=options;if(!Number.isFinite(min))throw TypeError("min must be a number");if(!Number.isFinite(max))throw TypeError("max must be a number");if(min>=max)throw RangeError("min must be smaller than max");let newMatrix=new Matrix(this.rows,this.columns);for(let i=0;i<this.columns;i++){let column=this.getColumn(i);column.length&&rescale(column,{min,max,output:column}),newMatrix.setColumn(i,column)}return newMatrix}flipRows(){let middle=Math.ceil(this.columns/2);for(let i=0;i<this.rows;i++)for(let j=0;j<middle;j++){let first=this.get(i,j),last=this.get(i,this.columns-1-j);this.set(i,j,last),this.set(i,this.columns-1-j,first)}return this}flipColumns(){let middle=Math.ceil(this.rows/2);for(let j=0;j<this.columns;j++)for(let i=0;i<middle;i++){let first=this.get(i,j),last=this.get(this.rows-1-i,j);this.set(i,j,last),this.set(this.rows-1-i,j,first)}return this}kroneckerProduct(other){other=Matrix.checkMatrix(other);let m=this.rows,n=this.columns,p=other.rows,q=other.columns,result=new Matrix(m*p,n*q);for(let i=0;i<m;i++)for(let j=0;j<n;j++)for(let k=0;k<p;k++)for(let l=0;l<q;l++)result.set(p*i+k,q*j+l,this.get(i,j)*other.get(k,l));return result}kroneckerSum(other){if(other=Matrix.checkMatrix(other),!this.isSquare()||!other.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let m=this.rows,n=other.rows,AxI=this.kroneckerProduct(Matrix.eye(n,n)),IxB=Matrix.eye(m,m).kroneckerProduct(other);return AxI.add(IxB)}transpose(){let result=new Matrix(this.columns,this.rows);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)result.set(j,i,this.get(i,j));return result}sortRows(compareFunction=compareNumbers){for(let i=0;i<this.rows;i++)this.setRow(i,this.getRow(i).sort(compareFunction));return this}sortColumns(compareFunction=compareNumbers){for(let i=0;i<this.columns;i++)this.setColumn(i,this.getColumn(i).sort(compareFunction));return this}subMatrix(startRow,endRow,startColumn,endColumn){checkRange(this,startRow,endRow,startColumn,endColumn);let newMatrix=new Matrix(endRow-startRow+1,endColumn-startColumn+1);for(let i=startRow;i<=endRow;i++)for(let j=startColumn;j<=endColumn;j++)newMatrix.set(i-startRow,j-startColumn,this.get(i,j));return newMatrix}subMatrixRow(indices,startColumn,endColumn){if(void 0===startColumn&&(startColumn=0),void 0===endColumn&&(endColumn=this.columns-1),startColumn>endColumn||startColumn<0||startColumn>=this.columns||endColumn<0||endColumn>=this.columns)throw RangeError("Argument out of range");let newMatrix=new Matrix(indices.length,endColumn-startColumn+1);for(let i=0;i<indices.length;i++)for(let j=startColumn;j<=endColumn;j++){if(indices[i]<0||indices[i]>=this.rows)throw RangeError(`Row index out of range: ${indices[i]}`);newMatrix.set(i,j-startColumn,this.get(indices[i],j))}return newMatrix}subMatrixColumn(indices,startRow,endRow){if(void 0===startRow&&(startRow=0),void 0===endRow&&(endRow=this.rows-1),startRow>endRow||startRow<0||startRow>=this.rows||endRow<0||endRow>=this.rows)throw RangeError("Argument out of range");let newMatrix=new Matrix(endRow-startRow+1,indices.length);for(let i=0;i<indices.length;i++)for(let j=startRow;j<=endRow;j++){if(indices[i]<0||indices[i]>=this.columns)throw RangeError(`Column index out of range: ${indices[i]}`);newMatrix.set(j-startRow,i,this.get(j,indices[i]))}return newMatrix}setSubMatrix(matrix,startRow,startColumn){if((matrix=Matrix.checkMatrix(matrix)).isEmpty())return this;let endRow=startRow+matrix.rows-1,endColumn=startColumn+matrix.columns-1;checkRange(this,startRow,endRow,startColumn,endColumn);for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)this.set(startRow+i,startColumn+j,matrix.get(i,j));return this}selection(rowIndices,columnIndices){checkRowIndices(this,rowIndices),checkColumnIndices(this,columnIndices);let newMatrix=new Matrix(rowIndices.length,columnIndices.length);for(let i=0;i<rowIndices.length;i++){let rowIndex=rowIndices[i];for(let j=0;j<columnIndices.length;j++){let columnIndex=columnIndices[j];newMatrix.set(i,j,this.get(rowIndex,columnIndex))}}return newMatrix}trace(){let min=Math.min(this.rows,this.columns),trace=0;for(let i=0;i<min;i++)trace+=this.get(i,i);return trace}clone(){return this.constructor.copy(this,new Matrix(this.rows,this.columns))}static copy(from,to){for(let[row,column,value]of from.entries())to.set(row,column,value);return to}sum(by){switch(by){case"row":return sumByRow(this);case"column":return sumByColumn(this);case void 0:return sumAll(this);default:throw Error(`invalid option: ${by}`)}}product(by){switch(by){case"row":return productByRow(this);case"column":return productByColumn(this);case void 0:return productAll(this);default:throw Error(`invalid option: ${by}`)}}mean(by){let sum=this.sum(by);switch(by){case"row":for(let i=0;i<this.rows;i++)sum[i]/=this.columns;return sum;case"column":for(let i1=0;i1<this.columns;i1++)sum[i1]/=this.rows;return sum;case void 0:return sum/this.size;default:throw Error(`invalid option: ${by}`)}}variance(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw TypeError("options must be an object");let{unbiased=!0,mean=this.mean(by)}=options;if("boolean"!=typeof unbiased)throw TypeError("unbiased must be a boolean");switch(by){case"row":if(!isAnyArray.isAnyArray(mean))throw TypeError("mean must be an array");return varianceByRow(this,unbiased,mean);case"column":if(!isAnyArray.isAnyArray(mean))throw TypeError("mean must be an array");return varianceByColumn(this,unbiased,mean);case void 0:if("number"!=typeof mean)throw TypeError("mean must be a number");return varianceAll(this,unbiased,mean);default:throw Error(`invalid option: ${by}`)}}standardDeviation(by,options){"object"==typeof by&&(options=by,by=void 0);let variance=this.variance(by,options);if(void 0===by)return Math.sqrt(variance);for(let i=0;i<variance.length;i++)variance[i]=Math.sqrt(variance[i]);return variance}center(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw TypeError("options must be an object");let{center=this.mean(by)}=options;switch(by){case"row":if(!isAnyArray.isAnyArray(center))throw TypeError("center must be an array");return centerByRow(this,center),this;case"column":if(!isAnyArray.isAnyArray(center))throw TypeError("center must be an array");return centerByColumn(this,center),this;case void 0:if("number"!=typeof center)throw TypeError("center must be a number");return centerAll(this,center),this;default:throw Error(`invalid option: ${by}`)}}scale(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw TypeError("options must be an object");let scale=options.scale;switch(by){case"row":if(void 0===scale)scale=getScaleByRow(this);else if(!isAnyArray.isAnyArray(scale))throw TypeError("scale must be an array");return scaleByRow(this,scale),this;case"column":if(void 0===scale)scale=getScaleByColumn(this);else if(!isAnyArray.isAnyArray(scale))throw TypeError("scale must be an array");return scaleByColumn(this,scale),this;case void 0:if(void 0===scale)scale=getScaleAll(this);else if("number"!=typeof scale)throw TypeError("scale must be a number");return scaleAll(this,scale),this;default:throw Error(`invalid option: ${by}`)}}toString(options){return inspectMatrixWithOptions(this,options)}[Symbol.iterator](){return this.entries()}*entries(){for(let row=0;row<this.rows;row++)for(let col=0;col<this.columns;col++)yield[row,col,this.get(row,col)]}*values(){for(let row=0;row<this.rows;row++)for(let col=0;col<this.columns;col++)yield this.get(row,col)}}function compareNumbers(a,b){return a-b}function isArrayOfNumbers(array){return array.every(element=>"number"==typeof element)}AbstractMatrix.prototype.klass="Matrix","undefined"!=typeof Symbol&&(AbstractMatrix.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspectMatrix),AbstractMatrix.random=AbstractMatrix.rand,AbstractMatrix.randomInt=AbstractMatrix.randInt,AbstractMatrix.diagonal=AbstractMatrix.diag,AbstractMatrix.prototype.diagonal=AbstractMatrix.prototype.diag,AbstractMatrix.identity=AbstractMatrix.eye,AbstractMatrix.prototype.negate=AbstractMatrix.prototype.neg,AbstractMatrix.prototype.tensorProduct=AbstractMatrix.prototype.kroneckerProduct;class Matrix extends AbstractMatrix{data;#initData(nRows,nColumns){if(this.data=[],Number.isInteger(nColumns)&&nColumns>=0)for(let i=0;i<nRows;i++)this.data.push(new Float64Array(nColumns));else throw TypeError("nColumns must be a positive integer");this.rows=nRows,this.columns=nColumns}constructor(nRows,nColumns){if(super(),Matrix.isMatrix(nRows))this.#initData(nRows.rows,nRows.columns),Matrix.copy(nRows,this);else if(Number.isInteger(nRows)&&nRows>=0)this.#initData(nRows,nColumns);else if(isAnyArray.isAnyArray(nRows)){let arrayData=nRows;if("number"!=typeof(nColumns=(nRows=arrayData.length)?arrayData[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<nRows;i++){if(arrayData[i].length!==nColumns)throw RangeError("Inconsistent array dimensions");if(!isArrayOfNumbers(arrayData[i]))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(arrayData[i]))}this.rows=nRows,this.columns=nColumns}else throw TypeError("First argument must be a positive number or an array")}set(rowIndex,columnIndex,value){return this.data[rowIndex][columnIndex]=value,this}get(rowIndex,columnIndex){return this.data[rowIndex][columnIndex]}removeRow(index){return checkRowIndex(this,index),this.data.splice(index,1),this.rows-=1,this}addRow(index,array){return void 0===array&&(array=index,index=this.rows),checkRowIndex(this,index,!0),array=Float64Array.from(checkRowVector(this,array)),this.data.splice(index,0,array),this.rows+=1,this}removeColumn(index){checkColumnIndex(this,index);for(let i=0;i<this.rows;i++){let newRow=new Float64Array(this.columns-1);for(let j=0;j<index;j++)newRow[j]=this.data[i][j];for(let j1=index+1;j1<this.columns;j1++)newRow[j1-1]=this.data[i][j1];this.data[i]=newRow}return this.columns-=1,this}addColumn(index,array){void 0===array&&(array=index,index=this.columns),checkColumnIndex(this,index,!0),array=checkColumnVector(this,array);for(let i=0;i<this.rows;i++){let newRow=new Float64Array(this.columns+1),j=0;for(;j<index;j++)newRow[j]=this.data[i][j];for(newRow[j++]=array[i];j<this.columns+1;j++)newRow[j]=this.data[i][j-1];this.data[i]=newRow}return this.columns+=1,this}}installMathOperations(AbstractMatrix,Matrix);class SymmetricMatrix extends AbstractMatrix{#matrix;get size(){return this.#matrix.size}get rows(){return this.#matrix.rows}get columns(){return this.#matrix.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(value){return Matrix.isMatrix(value)&&"SymmetricMatrix"===value.klassType}static zeros(diagonalSize){return new this(diagonalSize)}static ones(diagonalSize){return new this(diagonalSize).fill(1)}constructor(diagonalSize){if(super(),Matrix.isMatrix(diagonalSize)){if(!diagonalSize.isSymmetric())throw TypeError("not symmetric data");this.#matrix=Matrix.copy(diagonalSize,new Matrix(diagonalSize.rows,diagonalSize.rows))}else if(Number.isInteger(diagonalSize)&&diagonalSize>=0)this.#matrix=new Matrix(diagonalSize,diagonalSize);else if(this.#matrix=new Matrix(diagonalSize),!this.isSymmetric())throw TypeError("not symmetric data")}clone(){let matrix=new SymmetricMatrix(this.diagonalSize);for(let[row,col,value]of this.upperRightEntries())matrix.set(row,col,value);return matrix}toMatrix(){return new Matrix(this)}get(rowIndex,columnIndex){return this.#matrix.get(rowIndex,columnIndex)}set(rowIndex,columnIndex,value){return this.#matrix.set(rowIndex,columnIndex,value),this.#matrix.set(columnIndex,rowIndex,value),this}removeCross(index){return this.#matrix.removeRow(index),this.#matrix.removeColumn(index),this}addCross(index,array){void 0===array&&(array=index,index=this.diagonalSize);let row=array.slice();return row.splice(index,1),this.#matrix.addRow(index,row),this.#matrix.addColumn(index,array),this}applyMask(mask){if(mask.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let sidesToRemove=[];for(let[index,passthroughs]of mask.entries())passthroughs||sidesToRemove.push(index);for(let sideIndex of(sidesToRemove.reverse(),sidesToRemove))this.removeCross(sideIndex);return this}toCompact(){let{diagonalSize}=this,compact=Array(diagonalSize*(diagonalSize+1)/2);for(let col=0,row=0,index=0;index<compact.length;index++)compact[index]=this.get(row,col),++col>=diagonalSize&&(col=++row);return compact}static fromCompact(compact){let compactSize=compact.length,diagonalSize=(Math.sqrt(8*compactSize+1)-1)/2;if(!Number.isInteger(diagonalSize))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(compact)}`);let matrix=new SymmetricMatrix(diagonalSize);for(let col=0,row=0,index=0;index<compactSize;index++)matrix.set(col,row,compact[index]),++col>=diagonalSize&&(col=++row);return matrix}*upperRightEntries(){for(let row=0,col=0;row<this.diagonalSize;){let value=this.get(row,col);yield[row,col,value],++col>=this.diagonalSize&&(col=++row)}}*upperRightValues(){for(let row=0,col=0;row<this.diagonalSize;){let value=this.get(row,col);yield value,++col>=this.diagonalSize&&(col=++row)}}}SymmetricMatrix.prototype.klassType="SymmetricMatrix";class DistanceMatrix extends SymmetricMatrix{static isDistanceMatrix(value){return SymmetricMatrix.isSymmetricMatrix(value)&&"DistanceMatrix"===value.klassSubType}constructor(sideSize){if(super(sideSize),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix")}set(rowIndex,columnIndex,value){return rowIndex===columnIndex&&(value=0),super.set(rowIndex,columnIndex,value)}addCross(index,array){return void 0===array&&(array=index,index=this.diagonalSize),(array=array.slice())[index]=0,super.addCross(index,array)}toSymmetricMatrix(){return new SymmetricMatrix(this)}clone(){let matrix=new DistanceMatrix(this.diagonalSize);for(let[row,col,value]of this.upperRightEntries())row!==col&&matrix.set(row,col,value);return matrix}toCompact(){let{diagonalSize}=this,compactLength=(diagonalSize-1)*diagonalSize/2,compact=Array(compactLength);for(let col=1,row=0,index=0;index<compact.length;index++)compact[index]=this.get(row,col),++col>=diagonalSize&&(col=++row+1);return compact}static fromCompact(compact){let compactSize=compact.length;if(0===compactSize)return new this(0);let diagonalSize=(Math.sqrt(8*compactSize+1)+1)/2;if(!Number.isInteger(diagonalSize))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(compact)}`);let matrix=new this(diagonalSize);for(let col=1,row=0,index=0;index<compactSize;index++)matrix.set(col,row,compact[index]),++col>=diagonalSize&&(col=++row+1);return matrix}}DistanceMatrix.prototype.klassSubType="DistanceMatrix";class BaseView extends AbstractMatrix{constructor(matrix,rows,columns){super(),this.matrix=matrix,this.rows=rows,this.columns=columns}}class MatrixColumnView extends BaseView{constructor(matrix,column){checkColumnIndex(matrix,column),super(matrix,matrix.rows,1),this.column=column}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.column,value),this}get(rowIndex){return this.matrix.get(rowIndex,this.column)}}class MatrixColumnSelectionView extends BaseView{constructor(matrix,columnIndices){checkColumnIndices(matrix,columnIndices),super(matrix,matrix.rows,columnIndices.length),this.columnIndices=columnIndices}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.columnIndices[columnIndex],value),this}get(rowIndex,columnIndex){return this.matrix.get(rowIndex,this.columnIndices[columnIndex])}}class MatrixFlipColumnView extends BaseView{constructor(matrix){super(matrix,matrix.rows,matrix.columns)}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.columns-columnIndex-1,value),this}get(rowIndex,columnIndex){return this.matrix.get(rowIndex,this.columns-columnIndex-1)}}class MatrixFlipRowView extends BaseView{constructor(matrix){super(matrix,matrix.rows,matrix.columns)}set(rowIndex,columnIndex,value){return this.matrix.set(this.rows-rowIndex-1,columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rows-rowIndex-1,columnIndex)}}class MatrixRowView extends BaseView{constructor(matrix,row){checkRowIndex(matrix,row),super(matrix,1,matrix.columns),this.row=row}set(rowIndex,columnIndex,value){return this.matrix.set(this.row,columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.row,columnIndex)}}class MatrixRowSelectionView extends BaseView{constructor(matrix,rowIndices){checkRowIndices(matrix,rowIndices),super(matrix,rowIndices.length,matrix.columns),this.rowIndices=rowIndices}set(rowIndex,columnIndex,value){return this.matrix.set(this.rowIndices[rowIndex],columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rowIndices[rowIndex],columnIndex)}}class MatrixSelectionView extends BaseView{constructor(matrix,rowIndices,columnIndices){checkRowIndices(matrix,rowIndices),checkColumnIndices(matrix,columnIndices),super(matrix,rowIndices.length,columnIndices.length),this.rowIndices=rowIndices,this.columnIndices=columnIndices}set(rowIndex,columnIndex,value){return this.matrix.set(this.rowIndices[rowIndex],this.columnIndices[columnIndex],value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rowIndices[rowIndex],this.columnIndices[columnIndex])}}class MatrixSubView extends BaseView{constructor(matrix,startRow,endRow,startColumn,endColumn){checkRange(matrix,startRow,endRow,startColumn,endColumn),super(matrix,endRow-startRow+1,endColumn-startColumn+1),this.startRow=startRow,this.startColumn=startColumn}set(rowIndex,columnIndex,value){return this.matrix.set(this.startRow+rowIndex,this.startColumn+columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.startRow+rowIndex,this.startColumn+columnIndex)}}class MatrixTransposeView extends BaseView{constructor(matrix){super(matrix,matrix.columns,matrix.rows)}set(rowIndex,columnIndex,value){return this.matrix.set(columnIndex,rowIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(columnIndex,rowIndex)}}class WrapperMatrix1D extends AbstractMatrix{constructor(data,options={}){let{rows=1}=options;if(data.length%rows!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=rows,this.columns=data.length/rows,this.data=data}set(rowIndex,columnIndex,value){let index=this._calculateIndex(rowIndex,columnIndex);return this.data[index]=value,this}get(rowIndex,columnIndex){let index=this._calculateIndex(rowIndex,columnIndex);return this.data[index]}_calculateIndex(row,column){return row*this.columns+column}}class WrapperMatrix2D extends AbstractMatrix{constructor(data){super(),this.data=data,this.rows=data.length,this.columns=data[0].length}set(rowIndex,columnIndex,value){return this.data[rowIndex][columnIndex]=value,this}get(rowIndex,columnIndex){return this.data[rowIndex][columnIndex]}}function wrap(array,options){if(isAnyArray.isAnyArray(array))return array[0]&&isAnyArray.isAnyArray(array[0])?new WrapperMatrix2D(array):new WrapperMatrix1D(array,options);throw Error("the argument is not an array")}class LuDecomposition{constructor(matrix){let i,j,k,p,s,t,v,LUcolj,kmax;let lu=(matrix=WrapperMatrix2D.checkMatrix(matrix)).clone(),rows=lu.rows,columns=lu.columns,pivotVector=new Float64Array(rows),pivotSign=1;for(i=0;i<rows;i++)pivotVector[i]=i;for(j=0,LUcolj=new Float64Array(rows);j<columns;j++){for(i=0;i<rows;i++)LUcolj[i]=lu.get(i,j);for(i=0;i<rows;i++){for(k=0,kmax=Math.min(i,j),s=0;k<kmax;k++)s+=lu.get(i,k)*LUcolj[k];LUcolj[i]-=s,lu.set(i,j,LUcolj[i])}for(p=j,i=j+1;i<rows;i++)Math.abs(LUcolj[i])>Math.abs(LUcolj[p])&&(p=i);if(p!==j){for(k=0;k<columns;k++)t=lu.get(p,k),lu.set(p,k,lu.get(j,k)),lu.set(j,k,t);v=pivotVector[p],pivotVector[p]=pivotVector[j],pivotVector[j]=v,pivotSign=-pivotSign}if(j<rows&&0!==lu.get(j,j))for(i=j+1;i<rows;i++)lu.set(i,j,lu.get(i,j)/lu.get(j,j))}this.LU=lu,this.pivotVector=pivotVector,this.pivotSign=pivotSign}isSingular(){let data=this.LU,col=data.columns;for(let j=0;j<col;j++)if(0===data.get(j,j))return!0;return!1}solve(value){let i,j,k;value=Matrix.checkMatrix(value);let lu=this.LU;if(lu.rows!==value.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let count=value.columns,X=value.subMatrixRow(this.pivotVector,0,count-1),columns=lu.columns;for(k=0;k<columns;k++)for(i=k+1;i<columns;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*lu.get(i,k));for(k=columns-1;k>=0;k--){for(j=0;j<count;j++)X.set(k,j,X.get(k,j)/lu.get(k,k));for(i=0;i<k;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*lu.get(i,k))}return X}get determinant(){let data=this.LU;if(!data.isSquare())throw Error("Matrix must be square");let determinant=this.pivotSign,col=data.columns;for(let j=0;j<col;j++)determinant*=data.get(j,j);return determinant}get lowerTriangularMatrix(){let data=this.LU,rows=data.rows,columns=data.columns,X=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)i>j?X.set(i,j,data.get(i,j)):i===j?X.set(i,j,1):X.set(i,j,0);return X}get upperTriangularMatrix(){let data=this.LU,rows=data.rows,columns=data.columns,X=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)i<=j?X.set(i,j,data.get(i,j)):X.set(i,j,0);return X}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function hypotenuse(a,b){let r=0;return Math.abs(a)>Math.abs(b)?(r=b/a,Math.abs(a)*Math.sqrt(1+r*r)):0!==b?(r=a/b,Math.abs(b)*Math.sqrt(1+r*r)):0}class QrDecomposition{constructor(value){let i,j,k,s;let qr=(value=WrapperMatrix2D.checkMatrix(value)).clone(),m=value.rows,n=value.columns,rdiag=new Float64Array(n);for(k=0;k<n;k++){let nrm=0;for(i=k;i<m;i++)nrm=hypotenuse(nrm,qr.get(i,k));if(0!==nrm){for(0>qr.get(k,k)&&(nrm=-nrm),i=k;i<m;i++)qr.set(i,k,qr.get(i,k)/nrm);for(qr.set(k,k,qr.get(k,k)+1),j=k+1;j<n;j++){for(s=0,i=k;i<m;i++)s+=qr.get(i,k)*qr.get(i,j);for(s=-s/qr.get(k,k),i=k;i<m;i++)qr.set(i,j,qr.get(i,j)+s*qr.get(i,k))}}rdiag[k]=-nrm}this.QR=qr,this.Rdiag=rdiag}solve(value){let i,j,k,s;value=Matrix.checkMatrix(value);let qr=this.QR,m=qr.rows;if(value.rows!==m)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let count=value.columns,X=value.clone(),n=qr.columns;for(k=0;k<n;k++)for(j=0;j<count;j++){for(s=0,i=k;i<m;i++)s+=qr.get(i,k)*X.get(i,j);for(s=-s/qr.get(k,k),i=k;i<m;i++)X.set(i,j,X.get(i,j)+s*qr.get(i,k))}for(k=n-1;k>=0;k--){for(j=0;j<count;j++)X.set(k,j,X.get(k,j)/this.Rdiag[k]);for(i=0;i<k;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*qr.get(i,k))}return X.subMatrix(0,n-1,0,count-1)}isFullRank(){let columns=this.QR.columns;for(let i=0;i<columns;i++)if(0===this.Rdiag[i])return!1;return!0}get upperTriangularMatrix(){let i,j,qr=this.QR,n=qr.columns,X=new Matrix(n,n);for(i=0;i<n;i++)for(j=0;j<n;j++)i<j?X.set(i,j,qr.get(i,j)):i===j?X.set(i,j,this.Rdiag[i]):X.set(i,j,0);return X}get orthogonalMatrix(){let i,j,k,s,qr=this.QR,rows=qr.rows,columns=qr.columns,X=new Matrix(rows,columns);for(k=columns-1;k>=0;k--){for(i=0;i<rows;i++)X.set(i,k,0);for(X.set(k,k,1),j=k;j<columns;j++)if(0!==qr.get(k,k)){for(s=0,i=k;i<rows;i++)s+=qr.get(i,k)*X.get(i,j);for(s=-s/qr.get(k,k),i=k;i<rows;i++)X.set(i,j,X.get(i,j)+s*qr.get(i,k))}}return X}}class SingularValueDecomposition{constructor(value,options={}){let a;if((value=WrapperMatrix2D.checkMatrix(value)).isEmpty())throw Error("Matrix must be non-empty");let m=value.rows,n=value.columns,{computeLeftSingularVectors=!0,computeRightSingularVectors=!0,autoTranspose=!1}=options,wantu=Boolean(computeLeftSingularVectors),wantv=Boolean(computeRightSingularVectors),swapped=!1;if(m<n){if(autoTranspose){m=(a=value.transpose()).rows,n=a.columns,swapped=!0;let aux=wantu;wantu=wantv,wantv=aux}else a=value.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else a=value.clone();let nu=Math.min(m,n),ni=Math.min(m+1,n),s=new Float64Array(ni),U=new Matrix(m,nu),V=new Matrix(n,n),e=new Float64Array(n),work=new Float64Array(m),si=new Float64Array(ni);for(let i=0;i<ni;i++)si[i]=i;let nct=Math.min(m-1,n),nrt=Math.max(0,Math.min(n-2,m)),mrc=Math.max(nct,nrt);for(let k=0;k<mrc;k++){if(k<nct){s[k]=0;for(let i1=k;i1<m;i1++)s[k]=hypotenuse(s[k],a.get(i1,k));if(0!==s[k]){0>a.get(k,k)&&(s[k]=-s[k]);for(let i2=k;i2<m;i2++)a.set(i2,k,a.get(i2,k)/s[k]);a.set(k,k,a.get(k,k)+1)}s[k]=-s[k]}for(let j=k+1;j<n;j++){if(k<nct&&0!==s[k]){let t=0;for(let i3=k;i3<m;i3++)t+=a.get(i3,k)*a.get(i3,j);t=-t/a.get(k,k);for(let i4=k;i4<m;i4++)a.set(i4,j,a.get(i4,j)+t*a.get(i4,k))}e[j]=a.get(k,j)}if(wantu&&k<nct)for(let i5=k;i5<m;i5++)U.set(i5,k,a.get(i5,k));if(k<nrt){e[k]=0;for(let i6=k+1;i6<n;i6++)e[k]=hypotenuse(e[k],e[i6]);if(0!==e[k]){e[k+1]<0&&(e[k]=0-e[k]);for(let i7=k+1;i7<n;i7++)e[i7]/=e[k];e[k+1]+=1}if(e[k]=-e[k],k+1<m&&0!==e[k]){for(let i8=k+1;i8<m;i8++)work[i8]=0;for(let i9=k+1;i9<m;i9++)for(let j1=k+1;j1<n;j1++)work[i9]+=e[j1]*a.get(i9,j1);for(let j2=k+1;j2<n;j2++){let t1=-e[j2]/e[k+1];for(let i10=k+1;i10<m;i10++)a.set(i10,j2,a.get(i10,j2)+t1*work[i10])}}if(wantv)for(let i11=k+1;i11<n;i11++)V.set(i11,k,e[i11])}}let p=Math.min(n,m+1);if(nct<n&&(s[nct]=a.get(nct,nct)),m<p&&(s[p-1]=0),nrt+1<p&&(e[nrt]=a.get(nrt,p-1)),e[p-1]=0,wantu){for(let j3=nct;j3<nu;j3++){for(let i12=0;i12<m;i12++)U.set(i12,j3,0);U.set(j3,j3,1)}for(let k1=nct-1;k1>=0;k1--)if(0!==s[k1]){for(let j4=k1+1;j4<nu;j4++){let t2=0;for(let i13=k1;i13<m;i13++)t2+=U.get(i13,k1)*U.get(i13,j4);t2=-t2/U.get(k1,k1);for(let i14=k1;i14<m;i14++)U.set(i14,j4,U.get(i14,j4)+t2*U.get(i14,k1))}for(let i15=k1;i15<m;i15++)U.set(i15,k1,-U.get(i15,k1));U.set(k1,k1,1+U.get(k1,k1));for(let i16=0;i16<k1-1;i16++)U.set(i16,k1,0)}else{for(let i17=0;i17<m;i17++)U.set(i17,k1,0);U.set(k1,k1,1)}}if(wantv)for(let k2=n-1;k2>=0;k2--){if(k2<nrt&&0!==e[k2])for(let j5=k2+1;j5<n;j5++){let t3=0;for(let i18=k2+1;i18<n;i18++)t3+=V.get(i18,k2)*V.get(i18,j5);t3=-t3/V.get(k2+1,k2);for(let i19=k2+1;i19<n;i19++)V.set(i19,j5,V.get(i19,j5)+t3*V.get(i19,k2))}for(let i20=0;i20<n;i20++)V.set(i20,k2,0);V.set(k2,k2,1)}let pp=p-1,eps=Number.EPSILON;for(;p>0;){let k3,kase;for(k3=p-2;k3>=-1&&-1!==k3;k3--){let alpha=Number.MIN_VALUE+eps*Math.abs(s[k3]+Math.abs(s[k3+1]));if(Math.abs(e[k3])<=alpha||Number.isNaN(e[k3])){e[k3]=0;break}}if(k3===p-2)kase=4;else{let ks;for(ks=p-1;ks>=k3&&ks!==k3;ks--){let t4=(ks!==p?Math.abs(e[ks]):0)+(ks!==k3+1?Math.abs(e[ks-1]):0);if(Math.abs(s[ks])<=eps*t4){s[ks]=0;break}}ks===k3?kase=3:ks===p-1?kase=1:(kase=2,k3=ks)}switch(k3++,kase){case 1:{let f=e[p-2];e[p-2]=0;for(let j6=p-2;j6>=k3;j6--){let t5=hypotenuse(s[j6],f),cs=s[j6]/t5,sn=f/t5;if(s[j6]=t5,j6!==k3&&(f=-sn*e[j6-1],e[j6-1]=cs*e[j6-1]),wantv)for(let i21=0;i21<n;i21++)t5=cs*V.get(i21,j6)+sn*V.get(i21,p-1),V.set(i21,p-1,-sn*V.get(i21,j6)+cs*V.get(i21,p-1)),V.set(i21,j6,t5)}break}case 2:{let f1=e[k3-1];e[k3-1]=0;for(let j7=k3;j7<p;j7++){let t6=hypotenuse(s[j7],f1),cs1=s[j7]/t6,sn1=f1/t6;if(s[j7]=t6,f1=-sn1*e[j7],e[j7]=cs1*e[j7],wantu)for(let i22=0;i22<m;i22++)t6=cs1*U.get(i22,j7)+sn1*U.get(i22,k3-1),U.set(i22,k3-1,-sn1*U.get(i22,j7)+cs1*U.get(i22,k3-1)),U.set(i22,j7,t6)}break}case 3:{let scale=Math.max(Math.abs(s[p-1]),Math.abs(s[p-2]),Math.abs(e[p-2]),Math.abs(s[k3]),Math.abs(e[k3])),sp=s[p-1]/scale,spm1=s[p-2]/scale,epm1=e[p-2]/scale,sk=s[k3]/scale,ek=e[k3]/scale,b=((spm1+sp)*(spm1-sp)+epm1*epm1)/2,c=sp*epm1*(sp*epm1),shift=0;(0!==b||0!==c)&&(shift=b<0?0-Math.sqrt(b*b+c):Math.sqrt(b*b+c),shift=c/(b+shift));let f2=(sk+sp)*(sk-sp)+shift,g=sk*ek;for(let j8=k3;j8<p-1;j8++){let t7=hypotenuse(f2,g);0===t7&&(t7=Number.MIN_VALUE);let cs2=f2/t7,sn2=g/t7;if(j8!==k3&&(e[j8-1]=t7),f2=cs2*s[j8]+sn2*e[j8],e[j8]=cs2*e[j8]-sn2*s[j8],g=sn2*s[j8+1],s[j8+1]=cs2*s[j8+1],wantv)for(let i23=0;i23<n;i23++)t7=cs2*V.get(i23,j8)+sn2*V.get(i23,j8+1),V.set(i23,j8+1,-sn2*V.get(i23,j8)+cs2*V.get(i23,j8+1)),V.set(i23,j8,t7);if(0===(t7=hypotenuse(f2,g))&&(t7=Number.MIN_VALUE),cs2=f2/t7,sn2=g/t7,s[j8]=t7,f2=cs2*e[j8]+sn2*s[j8+1],s[j8+1]=-sn2*e[j8]+cs2*s[j8+1],g=sn2*e[j8+1],e[j8+1]=cs2*e[j8+1],wantu&&j8<m-1)for(let i24=0;i24<m;i24++)t7=cs2*U.get(i24,j8)+sn2*U.get(i24,j8+1),U.set(i24,j8+1,-sn2*U.get(i24,j8)+cs2*U.get(i24,j8+1)),U.set(i24,j8,t7)}e[p-2]=f2;break}case 4:if(s[k3]<=0&&(s[k3]=s[k3]<0?-s[k3]:0,wantv))for(let i25=0;i25<=pp;i25++)V.set(i25,k3,-V.get(i25,k3));for(;k3<pp&&!(s[k3]>=s[k3+1]);){let t8=s[k3];if(s[k3]=s[k3+1],s[k3+1]=t8,wantv&&k3<n-1)for(let i26=0;i26<n;i26++)t8=V.get(i26,k3+1),V.set(i26,k3+1,V.get(i26,k3)),V.set(i26,k3,t8);if(wantu&&k3<m-1)for(let i27=0;i27<m;i27++)t8=U.get(i27,k3+1),U.set(i27,k3+1,U.get(i27,k3)),U.set(i27,k3,t8);k3++}p--}}if(swapped){let tmp=V;V=U,U=tmp}this.m=m,this.n=n,this.s=s,this.U=U,this.V=V}solve(value){let Y=value,e=this.threshold,scols=this.s.length,Ls=Matrix.zeros(scols,scols);for(let i=0;i<scols;i++)Math.abs(this.s[i])<=e?Ls.set(i,i,0):Ls.set(i,i,1/this.s[i]);let U=this.U,V=this.rightSingularVectors,VL=V.mmul(Ls),vrows=V.rows,urows=U.rows,VLU=Matrix.zeros(vrows,urows);for(let i1=0;i1<vrows;i1++)for(let j=0;j<urows;j++){let sum=0;for(let k=0;k<scols;k++)sum+=VL.get(i1,k)*U.get(j,k);VLU.set(i1,j,sum)}return VLU.mmul(Y)}solveForDiagonal(value){return this.solve(Matrix.diag(value))}inverse(){let V=this.V,e=this.threshold,vrows=V.rows,vcols=V.columns,X=new Matrix(vrows,this.s.length);for(let i=0;i<vrows;i++)for(let j=0;j<vcols;j++)Math.abs(this.s[j])>e&&X.set(i,j,V.get(i,j)/this.s[j]);let U=this.U,urows=U.rows,ucols=U.columns,Y=new Matrix(vrows,urows);for(let i1=0;i1<vrows;i1++)for(let j1=0;j1<urows;j1++){let sum=0;for(let k=0;k<ucols;k++)sum+=X.get(i1,k)*U.get(j1,k);Y.set(i1,j1,sum)}return Y}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let tol=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,s=this.s;for(let i=0,ii=s.length;i<ii;i++)s[i]>tol&&r++;return r}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Matrix.diag(this.s)}}function inverse(matrix,useSVD=!1){return(matrix=WrapperMatrix2D.checkMatrix(matrix),useSVD)?new SingularValueDecomposition(matrix).inverse():solve(matrix,Matrix.eye(matrix.rows))}function solve(leftHandSide,rightHandSide,useSVD=!1){return(leftHandSide=WrapperMatrix2D.checkMatrix(leftHandSide),rightHandSide=WrapperMatrix2D.checkMatrix(rightHandSide),useSVD)?new SingularValueDecomposition(leftHandSide).solve(rightHandSide):leftHandSide.isSquare()?new LuDecomposition(leftHandSide).solve(rightHandSide):new QrDecomposition(leftHandSide).solve(rightHandSide)}function determinant(matrix){if((matrix=Matrix.checkMatrix(matrix)).isSquare()){let a,b,c;if(0===matrix.columns)return 1;if(2===matrix.columns)return a=matrix.get(0,0),b=matrix.get(0,1),c=matrix.get(1,0),a*matrix.get(1,1)-b*c;if(3!==matrix.columns)return new LuDecomposition(matrix).determinant;{let subMatrix0,subMatrix1,subMatrix2;return subMatrix0=new MatrixSelectionView(matrix,[1,2],[1,2]),subMatrix1=new MatrixSelectionView(matrix,[1,2],[0,2]),subMatrix2=new MatrixSelectionView(matrix,[1,2],[0,1]),a=matrix.get(0,0),b=matrix.get(0,1),c=matrix.get(0,2),a*determinant(subMatrix0)-b*determinant(subMatrix1)+c*determinant(subMatrix2)}}throw Error("determinant can only be calculated for a square matrix")}function xrange(n,exception){let range=[];for(let i=0;i<n;i++)i!==exception&&range.push(i);return range}function dependenciesOneRow(error,matrix,index,thresholdValue=1e-9,thresholdError=1e-9){if(error>thresholdError)return Array(matrix.rows+1).fill(0);{let returnArray=matrix.addRow(index,[0]);for(let i=0;i<returnArray.rows;i++)Math.abs(returnArray.get(i,0))<thresholdValue&&returnArray.set(i,0,0);return returnArray.to1DArray()}}function linearDependencies(matrix,options={}){let{thresholdValue=1e-9,thresholdError=1e-9}=options,n=(matrix=Matrix.checkMatrix(matrix)).rows,results=new Matrix(n,n);for(let i=0;i<n;i++){let b=Matrix.columnVector(matrix.getRow(i)),Abis=matrix.subMatrixRow(xrange(n,i)).transpose(),x=new SingularValueDecomposition(Abis).solve(b),error=Matrix.sub(b,Abis.mmul(x)).abs().max();results.setRow(i,dependenciesOneRow(error,x,i,thresholdValue,thresholdError))}return results}function pseudoInverse(matrix,threshold=Number.EPSILON){if((matrix=Matrix.checkMatrix(matrix)).isEmpty())return matrix.transpose();let svdSolution=new SingularValueDecomposition(matrix,{autoTranspose:!0}),U=svdSolution.leftSingularVectors,V=svdSolution.rightSingularVectors,s=svdSolution.diagonal;for(let i=0;i<s.length;i++)Math.abs(s[i])>threshold?s[i]=1/s[i]:s[i]=0;return V.mmul(Matrix.diag(s).mmul(U.transpose()))}function covariance(xMatrix,yMatrix=xMatrix,options={}){xMatrix=new Matrix(xMatrix);let yIsSame=!1;if("object"!=typeof yMatrix||Matrix.isMatrix(yMatrix)||isAnyArray.isAnyArray(yMatrix)?yMatrix=new Matrix(yMatrix):(options=yMatrix,yMatrix=xMatrix,yIsSame=!0),xMatrix.rows!==yMatrix.rows)throw TypeError("Both matrices must have the same number of rows");let{center=!0}=options;center&&(xMatrix=xMatrix.center("column"),yIsSame||(yMatrix=yMatrix.center("column")));let cov=xMatrix.transpose().mmul(yMatrix);for(let i=0;i<cov.rows;i++)for(let j=0;j<cov.columns;j++)cov.set(i,j,cov.get(i,j)*(1/(xMatrix.rows-1)));return cov}function correlation(xMatrix,yMatrix=xMatrix,options={}){xMatrix=new Matrix(xMatrix);let yIsSame=!1;if("object"!=typeof yMatrix||Matrix.isMatrix(yMatrix)||isAnyArray.isAnyArray(yMatrix)?yMatrix=new Matrix(yMatrix):(options=yMatrix,yMatrix=xMatrix,yIsSame=!0),xMatrix.rows!==yMatrix.rows)throw TypeError("Both matrices must have the same number of rows");let{center=!0,scale=!0}=options;center&&(xMatrix.center("column"),yIsSame||yMatrix.center("column")),scale&&(xMatrix.scale("column"),yIsSame||yMatrix.scale("column"));let sdx=xMatrix.standardDeviation("column",{unbiased:!0}),sdy=yIsSame?sdx:yMatrix.standardDeviation("column",{unbiased:!0}),corr=xMatrix.transpose().mmul(yMatrix);for(let i=0;i<corr.rows;i++)for(let j=0;j<corr.columns;j++)corr.set(i,j,corr.get(i,j)*(1/(sdx[i]*sdy[j]))*(1/(xMatrix.rows-1)));return corr}class EigenvalueDecomposition{constructor(matrix,options={}){let i,j;let{assumeSymmetric=!1}=options;if(!(matrix=WrapperMatrix2D.checkMatrix(matrix)).isSquare())throw Error("Matrix is not a square matrix");if(matrix.isEmpty())throw Error("Matrix must be non-empty");let n=matrix.columns,V=new Matrix(n,n),d=new Float64Array(n),e=new Float64Array(n),value=matrix,isSymmetric=!1;if(isSymmetric=!!assumeSymmetric||matrix.isSymmetric()){for(i=0;i<n;i++)for(j=0;j<n;j++)V.set(i,j,value.get(i,j));tred2(n,e,d,V),tql2(n,e,d,V)}else{let H=new Matrix(n,n),ort=new Float64Array(n);for(j=0;j<n;j++)for(i=0;i<n;i++)H.set(i,j,value.get(i,j));orthes(n,H,ort,V),hqr2(n,e,d,V,H)}this.n=n,this.e=e,this.d=d,this.V=V}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let i,j,n=this.n,e=this.e,d=this.d,X=new Matrix(n,n);for(i=0;i<n;i++){for(j=0;j<n;j++)X.set(i,j,0);X.set(i,i,d[i]),e[i]>0?X.set(i,i+1,e[i]):e[i]<0&&X.set(i,i-1,e[i])}return X}}function tred2(n,e,d,V){let f,g,h,i,j,k,hh,scale;for(j=0;j<n;j++)d[j]=V.get(n-1,j);for(i=n-1;i>0;i--){for(k=0,scale=0,h=0;k<i;k++)scale+=Math.abs(d[k]);if(0===scale)for(j=0,e[i]=d[i-1];j<i;j++)d[j]=V.get(i-1,j),V.set(i,j,0),V.set(j,i,0);else{for(k=0;k<i;k++)d[k]/=scale,h+=d[k]*d[k];for(f=d[i-1],g=Math.sqrt(h),f>0&&(g=-g),e[i]=scale*g,h-=f*g,d[i-1]=f-g,j=0;j<i;j++)e[j]=0;for(j=0;j<i;j++){for(f=d[j],V.set(j,i,f),g=e[j]+V.get(j,j)*f,k=j+1;k<=i-1;k++)g+=V.get(k,j)*d[k],e[k]+=V.get(k,j)*f;e[j]=g}for(j=0,f=0;j<i;j++)e[j]/=h,f+=e[j]*d[j];for(j=0,hh=f/(h+h);j<i;j++)e[j]-=hh*d[j];for(j=0;j<i;j++){for(f=d[j],g=e[j],k=j;k<=i-1;k++)V.set(k,j,V.get(k,j)-(f*e[k]+g*d[k]));d[j]=V.get(i-1,j),V.set(i,j,0)}}d[i]=h}for(i=0;i<n-1;i++){if(V.set(n-1,i,V.get(i,i)),V.set(i,i,1),0!==(h=d[i+1])){for(k=0;k<=i;k++)d[k]=V.get(k,i+1)/h;for(j=0;j<=i;j++){for(k=0,g=0;k<=i;k++)g+=V.get(k,i+1)*V.get(k,j);for(k=0;k<=i;k++)V.set(k,j,V.get(k,j)-g*d[k])}}for(k=0;k<=i;k++)V.set(k,i+1,0)}for(j=0;j<n;j++)d[j]=V.get(n-1,j),V.set(n-1,j,0);V.set(n-1,n-1,1),e[0]=0}function tql2(n,e,d,V){let g,h,i,j,k,l,m,p,r,dl1,c,c2,c3,el1,s,s2;for(i=1;i<n;i++)e[i-1]=e[i];e[n-1]=0;let f=0,tst1=0,eps=Number.EPSILON;for(l=0;l<n;l++){for(tst1=Math.max(tst1,Math.abs(d[l])+Math.abs(e[l])),m=l;m<n&&!(Math.abs(e[m])<=eps*tst1);)m++;if(m>l)do{for(g=d[l],r=hypotenuse(p=(d[l+1]-g)/(2*e[l]),1),p<0&&(r=-r),d[l]=e[l]/(p+r),d[l+1]=e[l]*(p+r),dl1=d[l+1],h=g-d[l],i=l+2;i<n;i++)d[i]-=h;for(f+=h,p=d[m],c2=c=1,c3=c,el1=e[l+1],s=0,s2=0,i=m-1;i>=l;i--)for(k=0,c3=c2,c2=c,s2=s,g=c*e[i],h=c*p,r=hypotenuse(p,e[i]),e[i+1]=s*r,s=e[i]/r,p=(c=p/r)*d[i]-s*g,d[i+1]=h+s*(c*g+s*d[i]);k<n;k++)h=V.get(k,i+1),V.set(k,i+1,s*V.get(k,i)+c*h),V.set(k,i,c*V.get(k,i)-s*h);p=-s*s2*c3*el1*e[l]/dl1,e[l]=s*p,d[l]=c*p}while(Math.abs(e[l])>eps*tst1);d[l]=d[l]+f,e[l]=0}for(i=0;i<n-1;i++){for(k=i,p=d[i],j=i+1;j<n;j++)d[j]<p&&(k=j,p=d[j]);if(k!==i)for(j=0,d[k]=d[i],d[i]=p;j<n;j++)p=V.get(j,i),V.set(j,i,V.get(j,k)),V.set(j,k,p)}}function orthes(n,H,ort,V){let f,g,h,i,j,m,scale,low=0,high=n-1;for(m=1;m<=high-1;m++){for(scale=0,i=m;i<=high;i++)scale+=Math.abs(H.get(i,m-1));if(0!==scale){for(h=0,i=high;i>=m;i--)ort[i]=H.get(i,m-1)/scale,h+=ort[i]*ort[i];for(g=Math.sqrt(h),ort[m]>0&&(g=-g),h-=ort[m]*g,ort[m]=ort[m]-g,j=m;j<n;j++){for(f=0,i=high;i>=m;i--)f+=ort[i]*H.get(i,j);for(f/=h,i=m;i<=high;i++)H.set(i,j,H.get(i,j)-f*ort[i])}for(i=0;i<=high;i++){for(f=0,j=high;j>=m;j--)f+=ort[j]*H.get(i,j);for(f/=h,j=m;j<=high;j++)H.set(i,j,H.get(i,j)-f*ort[j])}ort[m]=scale*ort[m],H.set(m,m-1,scale*g)}}for(i=0;i<n;i++)for(j=0;j<n;j++)V.set(i,j,i===j?1:0);for(m=high-1;m>=low+1;m--)if(0!==H.get(m,m-1)){for(i=m+1;i<=high;i++)ort[i]=H.get(i,m-1);for(j=m;j<=high;j++){for(g=0,i=m;i<=high;i++)g+=ort[i]*V.get(i,j);for(g=g/ort[m]/H.get(m,m-1),i=m;i<=high;i++)V.set(i,j,V.get(i,j)+g*ort[i])}}}function hqr2(nn,e,d,V,H){let i,j,k,l,m,t,w,x,y,ra,sa,vr,vi,notlast,cdivres,n=nn-1,low=0,high=nn-1,eps=Number.EPSILON,exshift=0,norm=0,p=0,q=0,r=0,s=0,z=0,iter=0;for(i=0;i<nn;i++)for((i<low||i>high)&&(d[i]=H.get(i,i),e[i]=0),j=Math.max(i-1,0);j<nn;j++)norm+=Math.abs(H.get(i,j));for(;n>=low;){for(l=n;l>low&&(0===(s=Math.abs(H.get(l-1,l-1))+Math.abs(H.get(l,l)))&&(s=norm),!(Math.abs(H.get(l,l-1))<eps*s));)l--;if(l===n)H.set(n,n,H.get(n,n)+exshift),d[n]=H.get(n,n),e[n]=0,n--,iter=0;else if(l===n-1){if(w=H.get(n,n-1)*H.get(n-1,n),z=Math.sqrt(Math.abs(q=(p=(H.get(n-1,n-1)-H.get(n,n))/2)*p+w)),H.set(n,n,H.get(n,n)+exshift),H.set(n-1,n-1,H.get(n-1,n-1)+exshift),x=H.get(n,n),q>=0){for(z=p>=0?p+z:p-z,d[n-1]=x+z,d[n]=d[n-1],0!==z&&(d[n]=x-w/z),e[n-1]=0,e[n]=0,s=Math.abs(x=H.get(n,n-1))+Math.abs(z),r=Math.sqrt((p=x/s)*p+(q=z/s)*q),p/=r,q/=r,j=n-1;j<nn;j++)z=H.get(n-1,j),H.set(n-1,j,q*z+p*H.get(n,j)),H.set(n,j,q*H.get(n,j)-p*z);for(i=0;i<=n;i++)z=H.get(i,n-1),H.set(i,n-1,q*z+p*H.get(i,n)),H.set(i,n,q*H.get(i,n)-p*z);for(i=low;i<=high;i++)z=V.get(i,n-1),V.set(i,n-1,q*z+p*V.get(i,n)),V.set(i,n,q*V.get(i,n)-p*z)}else d[n-1]=x+p,d[n]=x+p,e[n-1]=z,e[n]=-z;n-=2,iter=0}else{if(x=H.get(n,n),y=0,w=0,l<n&&(y=H.get(n-1,n-1),w=H.get(n,n-1)*H.get(n-1,n)),10===iter){for(exshift+=x,i=low;i<=n;i++)H.set(i,i,H.get(i,i)-x);x=y=.75*(s=Math.abs(H.get(n,n-1))+Math.abs(H.get(n-1,n-2))),w=-.4375*s*s}if(30===iter&&(s=(s=(y-x)/2)*s+w)>0){for(s=Math.sqrt(s),y<x&&(s=-s),s=x-w/((y-x)/2+s),i=low;i<=n;i++)H.set(i,i,H.get(i,i)-s);exshift+=s,x=y=w=.964}for(iter+=1,m=n-2;m>=l&&(s=Math.abs(p=((r=x-(z=H.get(m,m)))*(s=y-z)-w)/H.get(m+1,m)+H.get(m,m+1))+Math.abs(q=H.get(m+1,m+1)-z-r-s)+Math.abs(r=H.get(m+2,m+1)),p/=s,q/=s,r/=s,!(m===l||Math.abs(H.get(m,m-1))*(Math.abs(q)+Math.abs(r))<eps*(Math.abs(p)*(Math.abs(H.get(m-1,m-1))+Math.abs(z)+Math.abs(H.get(m+1,m+1))))));)m--;for(i=m+2;i<=n;i++)H.set(i,i-2,0),i>m+2&&H.set(i,i-3,0);for(k=m;k<=n-1&&(notlast=k!==n-1,k!==m&&0!==(x=Math.abs(p=H.get(k,k-1))+Math.abs(q=H.get(k+1,k-1))+Math.abs(r=notlast?H.get(k+2,k-1):0))&&(p/=x,q/=x,r/=x),0!==x);k++)if(s=Math.sqrt(p*p+q*q+r*r),p<0&&(s=-s),0!==s){for(k!==m?H.set(k,k-1,-s*x):l!==m&&H.set(k,k-1,-H.get(k,k-1)),p+=s,x=p/s,y=q/s,z=r/s,q/=p,r/=p,j=k;j<nn;j++)p=H.get(k,j)+q*H.get(k+1,j),notlast&&(p+=r*H.get(k+2,j),H.set(k+2,j,H.get(k+2,j)-p*z)),H.set(k,j,H.get(k,j)-p*x),H.set(k+1,j,H.get(k+1,j)-p*y);for(i=0;i<=Math.min(n,k+3);i++)p=x*H.get(i,k)+y*H.get(i,k+1),notlast&&(p+=z*H.get(i,k+2),H.set(i,k+2,H.get(i,k+2)-p*r)),H.set(i,k,H.get(i,k)-p),H.set(i,k+1,H.get(i,k+1)-p*q);for(i=low;i<=high;i++)p=x*V.get(i,k)+y*V.get(i,k+1),notlast&&(p+=z*V.get(i,k+2),V.set(i,k+2,V.get(i,k+2)-p*r)),V.set(i,k,V.get(i,k)-p),V.set(i,k+1,V.get(i,k+1)-p*q)}}}if(0!==norm){for(n=nn-1;n>=0;n--)if(p=d[n],0===(q=e[n]))for(l=n,H.set(n,n,1),i=n-1;i>=0;i--){for(w=H.get(i,i)-p,r=0,j=l;j<=n;j++)r+=H.get(i,j)*H.get(j,n);if(e[i]<0)z=w,s=r;else if(l=i,0===e[i]?H.set(i,n,0!==w?-r/w:-r/(eps*norm)):(x=H.get(i,i+1),y=H.get(i+1,i),q=(d[i]-p)*(d[i]-p)+e[i]*e[i],t=(x*s-z*r)/q,H.set(i,n,t),H.set(i+1,n,Math.abs(x)>Math.abs(z)?(-r-w*t)/x:(-s-y*t)/z)),eps*(t=Math.abs(H.get(i,n)))*t>1)for(j=i;j<=n;j++)H.set(j,n,H.get(j,n)/t)}else if(q<0)for(l=n-1,Math.abs(H.get(n,n-1))>Math.abs(H.get(n-1,n))?(H.set(n-1,n-1,q/H.get(n,n-1)),H.set(n-1,n,-(H.get(n,n)-p)/H.get(n,n-1))):(cdivres=cdiv(0,-H.get(n-1,n),H.get(n-1,n-1)-p,q),H.set(n-1,n-1,cdivres[0]),H.set(n-1,n,cdivres[1])),H.set(n,n-1,0),H.set(n,n,1),i=n-2;i>=0;i--){for(ra=0,sa=0,j=l;j<=n;j++)ra+=H.get(i,j)*H.get(j,n-1),sa+=H.get(i,j)*H.get(j,n);if(w=H.get(i,i)-p,e[i]<0)z=w,r=ra,s=sa;else if(l=i,0===e[i]?(cdivres=cdiv(-ra,-sa,w,q),H.set(i,n-1,cdivres[0]),H.set(i,n,cdivres[1])):(x=H.get(i,i+1),y=H.get(i+1,i),vr=(d[i]-p)*(d[i]-p)+e[i]*e[i]-q*q,vi=(d[i]-p)*2*q,0===vr&&0===vi&&(vr=eps*norm*(Math.abs(w)+Math.abs(q)+Math.abs(x)+Math.abs(y)+Math.abs(z))),cdivres=cdiv(x*r-z*ra+q*sa,x*s-z*sa-q*ra,vr,vi),H.set(i,n-1,cdivres[0]),H.set(i,n,cdivres[1]),Math.abs(x)>Math.abs(z)+Math.abs(q)?(H.set(i+1,n-1,(-ra-w*H.get(i,n-1)+q*H.get(i,n))/x),H.set(i+1,n,(-sa-w*H.get(i,n)-q*H.get(i,n-1))/x)):(cdivres=cdiv(-r-y*H.get(i,n-1),-s-y*H.get(i,n),z,q),H.set(i+1,n-1,cdivres[0]),H.set(i+1,n,cdivres[1]))),eps*(t=Math.max(Math.abs(H.get(i,n-1)),Math.abs(H.get(i,n))))*t>1)for(j=i;j<=n;j++)H.set(j,n-1,H.get(j,n-1)/t),H.set(j,n,H.get(j,n)/t)}for(i=0;i<nn;i++)if(i<low||i>high)for(j=i;j<nn;j++)V.set(i,j,H.get(i,j));for(j=nn-1;j>=low;j--)for(i=low;i<=high;i++){for(z=0,k=low;k<=Math.min(j,high);k++)z+=V.get(i,k)*H.get(k,j);V.set(i,j,z)}}}function cdiv(xr,xi,yr,yi){let r,d;return Math.abs(yr)>Math.abs(yi)?(r=yi/yr,d=yr+r*yi,[(xr+r*xi)/d,(xi-r*xr)/d]):(r=yr/yi,d=yi+r*yr,[(r*xr+xi)/d,(r*xi-xr)/d])}class CholeskyDecomposition{constructor(value){let i,j,k;if(!(value=WrapperMatrix2D.checkMatrix(value)).isSymmetric())throw Error("Matrix is not symmetric");let a=value,dimension=a.rows,l=new Matrix(dimension,dimension),positiveDefinite=!0;for(j=0;j<dimension;j++){let d=0;for(k=0;k<j;k++){let s=0;for(i=0;i<k;i++)s+=l.get(k,i)*l.get(j,i);s=(a.get(j,k)-s)/l.get(k,k),l.set(j,k,s),d+=s*s}for(positiveDefinite&&=(d=a.get(j,j)-d)>0,l.set(j,j,Math.sqrt(Math.max(d,0))),k=j+1;k<dimension;k++)l.set(j,k,0)}this.L=l,this.positiveDefinite=positiveDefinite}isPositiveDefinite(){return this.positiveDefinite}solve(value){let i,j,k;value=WrapperMatrix2D.checkMatrix(value);let l=this.L,dimension=l.rows;if(value.rows!==dimension)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let count=value.columns,B=value.clone();for(k=0;k<dimension;k++)for(j=0;j<count;j++){for(i=0;i<k;i++)B.set(k,j,B.get(k,j)-B.get(i,j)*l.get(k,i));B.set(k,j,B.get(k,j)/l.get(k,k))}for(k=dimension-1;k>=0;k--)for(j=0;j<count;j++){for(i=k+1;i<dimension;i++)B.set(k,j,B.get(k,j)-B.get(i,j)*l.get(i,k));B.set(k,j,B.get(k,j)/l.get(k,k))}return B}get lowerTriangularMatrix(){return this.L}}class nipals{constructor(X,options={}){let u,t,q,w,tOld;X=WrapperMatrix2D.checkMatrix(X);let{Y}=options,{scaleScores=!1,maxIterations=1e3,terminationCriteria=1e-10}=options;if(Y){if((Y=isAnyArray.isAnyArray(Y)&&"number"==typeof Y[0]?Matrix.columnVector(Y):WrapperMatrix2D.checkMatrix(Y)).rows!==X.rows)throw Error("Y should have the same number of rows as X");u=Y.getColumnVector(0)}else u=X.getColumnVector(0);let diff=1;for(let counter=0;counter<maxIterations&&diff>terminationCriteria;counter++)w=(w=X.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0))).div(w.norm()),t=X.mmul(w).div(w.transpose().mmul(w).get(0,0)),counter>0&&(diff=t.clone().sub(tOld).pow(2).sum()),tOld=t.clone(),Y?(q=(q=Y.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0))).div(q.norm()),u=Y.mmul(q).div(q.transpose().mmul(q).get(0,0))):u=t;if(Y){let p=X.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0));p=p.div(p.norm());let xResidual=X.clone().sub(t.clone().mmul(p.transpose())),residual=u.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0)),yResidual=Y.clone().sub(t.clone().mulS(residual.get(0,0)).mmul(q.transpose()));this.t=t,this.p=p.transpose(),this.w=w.transpose(),this.q=q,this.u=u,this.s=t.transpose().mmul(t),this.xResidual=xResidual,this.yResidual=yResidual,this.betas=residual}else this.w=w.transpose(),this.s=t.transpose().mmul(t).sqrt(),scaleScores?this.t=t.clone().div(this.s.get(0,0)):this.t=t,this.xResidual=X.sub(t.mmul(w.transpose()))}}exports.AbstractMatrix=AbstractMatrix,exports.CHO=CholeskyDecomposition,exports.CholeskyDecomposition=CholeskyDecomposition,exports.DistanceMatrix=DistanceMatrix,exports.EVD=EigenvalueDecomposition,exports.EigenvalueDecomposition=EigenvalueDecomposition,exports.LU=LuDecomposition,exports.LuDecomposition=LuDecomposition,exports.Matrix=Matrix,exports.MatrixColumnSelectionView=MatrixColumnSelectionView,exports.MatrixColumnView=MatrixColumnView,exports.MatrixFlipColumnView=MatrixFlipColumnView,exports.MatrixFlipRowView=MatrixFlipRowView,exports.MatrixRowSelectionView=MatrixRowSelectionView,exports.MatrixRowView=MatrixRowView,exports.MatrixSelectionView=MatrixSelectionView,exports.MatrixSubView=MatrixSubView,exports.MatrixTransposeView=MatrixTransposeView,exports.NIPALS=nipals,exports.Nipals=nipals,exports.QR=QrDecomposition,exports.QrDecomposition=QrDecomposition,exports.SVD=SingularValueDecomposition,exports.SingularValueDecomposition=SingularValueDecomposition,exports.SymmetricMatrix=SymmetricMatrix,exports.WrapperMatrix1D=WrapperMatrix1D,exports.WrapperMatrix2D=WrapperMatrix2D,exports.correlation=correlation,exports.covariance=covariance,exports.default=Matrix,exports.determinant=determinant,exports.inverse=inverse,exports.linearDependencies=linearDependencies,exports.pseudoInverse=pseudoInverse,exports.solve=solve,exports.wrap=wrap},2664:function(module){module.exports=newArray;function newArray(n,value){for(var array=Array(n=n||0),i=0;i<n;i++)array[i]=value;return array}},995:function(module){module.exports=nextPowerOfTwo;function nextPowerOfTwo(n){return 0===n?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,(n|=n>>16)+1)}},2703:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(5268);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction,module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret!==ReactPropTypesSecret){var err=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw err.name="Invariant Violation",err}}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bigint:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}},5697:function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__(2703)()},5268:function(module){"use strict";var ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";module.exports=ReactPropTypesSecret},146:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var twoProduct=__webpack_require__(8005),robustSum=__webpack_require__(6740),robustScale=__webpack_require__(5442),robustSubtract=__webpack_require__(7972),NUM_EXPAND=5,ERRBOUND3=33306690738754716e-32,ERRBOUND4=7771561172376103e-31;function orientation_3(sum,prod,scale,sub){return function(m0,m1,m2){var d=sub(sum(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0]))),sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])));return d[d.length-1]}}function orientation_4(sum,prod,scale,sub){return function(m0,m1,m2,m3){var d=sub(sum(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2])))),sum(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2])))));return d[d.length-1]}}function orientation_5(sum,prod,scale,sub){return function(m0,m1,m2,m3,m4){var d=sub(sum(sum(sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m2[2]),sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),-m3[2]),scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m4[2]))),m1[3]),sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m3[2]),scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m4[2]))),-m2[3]),scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m4[2]))),m3[3]))),sum(scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),-m4[3]),sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m3[2]),scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m3[2]),scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),m4[2]))),-m1[3])))),sum(sum(scale(sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m4[2]))),m3[3]),sum(scale(sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2]))),-m4[3]),scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),m0[3]))),sum(scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),-m1[3]),sum(scale(sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2]))),m2[3]),scale(sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2]))),-m3[3]))))),sum(sum(sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m2[2]),sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),-m3[2]),scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m3[2]),scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),m4[2]))),-m2[3])),sum(scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m4[2]))),m3[3]),scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),-m4[3]))),sum(sum(scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m4[2]))),-m1[3])),sum(scale(sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m4[2]))),m2[3]),scale(sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2]))),-m4[3])))));return d[d.length-1]}}function orientation(n){return(3===n?orientation_3:4===n?orientation_4:orientation_5)(robustSum,twoProduct,robustScale,robustSubtract)}var orientation3Exact=orientation(3),orientation4Exact=orientation(4),CACHED=[function(){return 0},function(){return 0},function(a,b){return b[0]-a[0]},function(a,b,c){var s,l=(a[1]-c[1])*(b[0]-c[0]),r=(a[0]-c[0])*(b[1]-c[1]),det=l-r;if(l>0){if(r<=0)return det;s=l+r}else{if(!(l<0)||r>=0)return det;s=-(l+r)}var tol=ERRBOUND3*s;return det>=tol||det<=-tol?det:orientation3Exact(a,b,c)},function(a,b,c,d){var adx=a[0]-d[0],bdx=b[0]-d[0],cdx=c[0]-d[0],ady=a[1]-d[1],bdy=b[1]-d[1],cdy=c[1]-d[1],adz=a[2]-d[2],bdz=b[2]-d[2],cdz=c[2]-d[2],bdxcdy=bdx*cdy,cdxbdy=cdx*bdy,cdxady=cdx*ady,adxcdy=adx*cdy,adxbdy=adx*bdy,bdxady=bdx*ady,det=adz*(bdxcdy-cdxbdy)+bdz*(cdxady-adxcdy)+cdz*(adxbdy-bdxady),tol=ERRBOUND4*((Math.abs(bdxcdy)+Math.abs(cdxbdy))*Math.abs(adz)+(Math.abs(cdxady)+Math.abs(adxcdy))*Math.abs(bdz)+(Math.abs(adxbdy)+Math.abs(bdxady))*Math.abs(cdz));return det>tol||-det>tol?det:orientation4Exact(a,b,c,d)}];function slowOrient(args){var proc=CACHED[args.length];return proc||(proc=CACHED[args.length]=orientation(args.length)),proc.apply(void 0,args)}function proc(slow,o0,o1,o2,o3,o4,o5){return function(a0,a1,a2,a3,a4){switch(arguments.length){case 0:case 1:return 0;case 2:return o2(a0,a1);case 3:return o3(a0,a1,a2);case 4:return o4(a0,a1,a2,a3);case 5:return o5(a0,a1,a2,a3,a4)}for(var s=Array(arguments.length),i=0;i<arguments.length;++i)s[i]=arguments[i];return slow(s)}}!function(){for(;CACHED.length<=NUM_EXPAND;)CACHED.push(orientation(CACHED.length));module.exports=proc.apply(void 0,[slowOrient].concat(CACHED));for(var i=0;i<=NUM_EXPAND;++i)module.exports[i]=CACHED[i]}()},4707:function(module,__unused_webpack_exports,__webpack_require__){module.exports=robustPointInPolygon;var orient=__webpack_require__(146);function robustPointInPolygon(vs,point){for(var x=point[0],y=point[1],n=vs.length,inside=1,lim=n,i=0,j=n-1;i<lim;j=i++){var a=vs[i],b=vs[j],yi=a[1],yj=b[1];if(yj<yi){if(yj<y&&y<yi){var s=orient(a,b,point);if(0===s)return 0;inside^=0<s|0}else if(y===yi){var c=vs[(i+1)%n],yk=c[1];if(yi<yk){var s=orient(a,b,point);if(0===s)return 0;inside^=0<s|0}}}else if(yi<yj){if(yi<y&&y<yj){var s=orient(a,b,point);if(0===s)return 0;inside^=s<0|0}else if(y===yi){var c=vs[(i+1)%n],yk=c[1];if(yk<yi){var s=orient(a,b,point);if(0===s)return 0;inside^=s<0|0}}}else if(y===yi){var x0=Math.min(a[0],b[0]),x1=Math.max(a[0],b[0]);if(0===i){for(;j>0;){var k=(j+n-1)%n,p=vs[k];if(p[1]!==y)break;var px=p[0];x0=Math.min(x0,px),x1=Math.max(x1,px),j=k}if(0===j){if(x0<=x&&x<=x1)return 0;return 1}lim=j+1}for(var y0=vs[(j+n-1)%n][1];i+1<lim;){var p=vs[i+1];if(p[1]!==y)break;var px=p[0];x0=Math.min(x0,px),x1=Math.max(x1,px),i+=1}if(x0<=x&&x<=x1)return 0;var y1=vs[(i+1)%n][1];x<x0&&y0<y!=y1<y&&(inside^=1)}}return 2*inside-1}},5442:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var twoProduct=__webpack_require__(8005),twoSum=__webpack_require__(6359);function scaleLinearExpansion(e,scale){var n=e.length;if(1===n){var ts=twoProduct(e[0],scale);return ts[0]?ts:[ts[1]]}var g=Array(2*n),q=[.1,.1],t=[.1,.1],count=0;twoProduct(e[0],scale,q),q[0]&&(g[count++]=q[0]);for(var i=1;i<n;++i){twoProduct(e[i],scale,t),twoSum(q[1],t[0],q),q[0]&&(g[count++]=q[0]);var a=t[1],b=q[1],x=a+b,y=b-(x-a);q[1]=x,y&&(g[count++]=y)}return q[1]&&(g[count++]=q[1]),0===count&&(g[count++]=0),g.length=count,g}module.exports=scaleLinearExpansion},7972:function(module){"use strict";function scalarScalar(a,b){var x=a+b,bv=x-a,y=a-(x-bv)+(b-bv);return y?[y,x]:[x]}function robustSubtract(e,f){var a,b,_x,_bv,_av,_br,_ar,ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return scalarScalar(e[0],-f[0]);var g=Array(ne+nf),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[0],ea=abs(ei),fi=-f[fptr],fa=abs(fi);ea<fa?(b=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(b=fi,(fptr+=1)<nf&&(fa=abs(fi=-f[fptr]))),eptr<ne&&ea<fa||fptr>=nf?(a=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(a=fi,(fptr+=1)<nf&&(fa=abs(fi=-f[fptr])));for(var x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;eptr<ne&&fptr<nf;)ea<fa?(a=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(a=fi,(fptr+=1)<nf&&(fa=abs(fi=-f[fptr]))),bv=(x=a+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x;for(;eptr<ne;)bv=(x=(a=ei)+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x,(eptr+=1)<ne&&(ei=e[eptr]);for(;fptr<nf;)bv=(x=(a=fi)+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x,(fptr+=1)<nf&&(fi=-f[fptr]);return q0&&(g[count++]=q0),q1&&(g[count++]=q1),count||(g[count++]=0),g.length=count,g}module.exports=robustSubtract},6740:function(module){"use strict";function scalarScalar(a,b){var x=a+b,bv=x-a,y=a-(x-bv)+(b-bv);return y?[y,x]:[x]}function linearExpansionSum(e,f){var a,b,_x,_bv,_av,_br,_ar,ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return scalarScalar(e[0],f[0]);var g=Array(ne+nf),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[0],ea=abs(ei),fi=f[fptr],fa=abs(fi);ea<fa?(b=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(b=fi,(fptr+=1)<nf&&(fa=abs(fi=f[fptr]))),eptr<ne&&ea<fa||fptr>=nf?(a=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(a=fi,(fptr+=1)<nf&&(fa=abs(fi=f[fptr])));for(var x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;eptr<ne&&fptr<nf;)ea<fa?(a=ei,(eptr+=1)<ne&&(ea=abs(ei=e[eptr]))):(a=fi,(fptr+=1)<nf&&(fa=abs(fi=f[fptr]))),bv=(x=a+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x;for(;eptr<ne;)bv=(x=(a=ei)+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x,(eptr+=1)<ne&&(ei=e[eptr]);for(;fptr<nf;)bv=(x=(a=fi)+(b=q0))-a,(y=b-bv)&&(g[count++]=y),_bv=(_x=q1+x)-q1,_av=_x-_bv,_br=x-_bv,q0=(_ar=q1-_av)+_br,q1=_x,(fptr+=1)<nf&&(fi=f[fptr]);return q0&&(g[count++]=q0),q1&&(g[count++]=q1),count||(g[count++]=0),g.length=count,g}module.exports=linearExpansionSum},9375:function(module){var runtime=function(exports){"use strict";var undefined,Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self1,tryLocsList){var generator=Object.create((outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator).prototype);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self1,new Context(tryLocsList||[]))}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var GenStateSuspendedStart="suspendedStart",GenStateSuspendedYield="suspendedYield",GenStateExecuting="executing",GenStateCompleted="completed",ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg)})})}function AsyncIterator(generator,PromiseImpl){var previousPromise;function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"===record.type)reject(record.arg);else{var result=record.arg,value=result.value;return value&&"object"==typeof value&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}}defineProperty(this,"_invoke",{value:function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self1,context){var state=GenStateSuspendedStart;return function(method,arg){if(state===GenStateExecuting)throw Error("Generator is already running");if(state===GenStateCompleted){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if(state===GenStateSuspendedStart)throw state=GenStateCompleted,context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state=GenStateExecuting;var record=tryCatch(innerFn,self1,context);if("normal"===record.type){if(state=context.done?GenStateCompleted:GenStateSuspendedYield,record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state=GenStateCompleted,context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(undefined===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:undefined,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self1,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self1,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this}),define(Gp,"toString",function(){return"[object Generator]"}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined)},stop:function(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else if(hasFinally){if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return(record.type=type,record.arg=arg,finallyEntry)?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel}},exports}(module.exports);try{regeneratorRuntime=runtime}catch(accidentalStrictMode){"object"==typeof globalThis?globalThis.regeneratorRuntime=runtime:Function("r","regeneratorRuntime = r")(runtime)}},181:function(module,__unused_webpack_exports,__webpack_require__){let createWorker=__webpack_require__(1158),recognize=async(image,langs,options)=>{let worker1=await createWorker(langs,1,options);return worker1.recognize(image).finally(async()=>{await worker1.terminate()})},detect=async(image,options)=>{let worker1=await createWorker("osd",0,options);return worker1.detect(image).finally(async()=>{await worker1.terminate()})};module.exports={recognize,detect}},6308:function(module){module.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},7895:function(module){module.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},8720:function(module){module.exports={workerBlobURL:!0,logger(){}}},9520:function(module){module.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},1949:function(module,__unused_webpack_exports,__webpack_require__){let getId=__webpack_require__(5504),jobCounter=0;module.exports=({id:_id,action,payload={}})=>{let id=_id;return void 0===id&&(id=getId("Job",jobCounter),jobCounter+=1),{id,action,payload}}},7877:function(module,__unused_webpack_exports,__webpack_require__){let createJob=__webpack_require__(1949),{log}=__webpack_require__(3486),getId=__webpack_require__(5504),schedulerCounter=0;module.exports=()=>{let id=getId("Scheduler",schedulerCounter),workers={},runningWorkers={},jobQueue=[];schedulerCounter+=1;let getQueueLen=()=>jobQueue.length,getNumWorkers=()=>Object.keys(workers).length,dequeue=()=>{if(0!==jobQueue.length){let wIds=Object.keys(workers);for(let i=0;i<wIds.length;i+=1)if(void 0===runningWorkers[wIds[i]]){jobQueue[0](workers[wIds[i]]);break}}},queue=(action,payload)=>new Promise((resolve,reject)=>{let job=createJob({action,payload});jobQueue.push(async w=>{jobQueue.shift(),runningWorkers[w.id]=job;try{resolve(await w[action].apply(this,[...payload,job.id]))}catch(err){reject(err)}finally{delete runningWorkers[w.id],dequeue()}}),log(`[${id}]: Add ${job.id} to JobQueue`),log(`[${id}]: JobQueue length=${jobQueue.length}`),dequeue()}),addWorker=w=>(workers[w.id]=w,log(`[${id}]: Add ${w.id}`),log(`[${id}]: Number of workers=${getNumWorkers()}`),dequeue(),w.id),addJob=async(action,...payload)=>{if(0===getNumWorkers())throw Error(`[${id}]: You need to have at least one worker before adding jobs`);return queue(action,payload)},terminate=async()=>{Object.keys(workers).forEach(async wid=>{await workers[wid].terminate()}),jobQueue=[]};return{addWorker,addJob,terminate,getQueueLen,getNumWorkers}}},1158:function(module,__unused_webpack_exports,__webpack_require__){let resolvePaths=__webpack_require__(1937),createJob=__webpack_require__(1949),{log}=__webpack_require__(3486),getId=__webpack_require__(5504),OEM=__webpack_require__(6308),{defaultOptions,spawnWorker,terminateWorker,onMessage,loadImage,send}=__webpack_require__(3791),workerCounter=0;module.exports=async(langs="eng",oem=OEM.LSTM_ONLY,_options={},config={})=>{let workerResReject,workerResResolve;let id=getId("Worker",workerCounter),{logger,errorHandler,...options}=resolvePaths({...defaultOptions,..._options}),promises={},currentLangs="string"==typeof langs?langs.split("+"):langs,currentOem=oem,currentConfig=config,lstmOnlyCore=[OEM.DEFAULT,OEM.LSTM_ONLY].includes(oem)&&!options.legacyCore,workerRes=new Promise((resolve,reject)=>{workerResResolve=resolve,workerResReject=reject}),workerError=event=>{workerResReject(event.message)},worker1=spawnWorker(options);worker1.onerror=workerError,workerCounter+=1;let startJob=({id:jobId,action,payload})=>new Promise((resolve,reject)=>{log(`[${id}]: Start ${jobId}, action=${action}`);let promiseId=`${action}-${jobId}`;promises[promiseId]={resolve,reject},send(worker1,{workerId:id,jobId,action,payload})}),load=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),loadInternal=jobId=>startJob(createJob({id:jobId,action:"load",payload:{options:{lstmOnly:lstmOnlyCore,corePath:options.corePath,logging:options.logging}}})),writeText=(path,text,jobId)=>startJob(createJob({id:jobId,action:"FS",payload:{method:"writeFile",args:[path,text]}})),readText=(path,jobId)=>startJob(createJob({id:jobId,action:"FS",payload:{method:"readFile",args:[path,{encoding:"utf8"}]}})),removeFile=(path,jobId)=>startJob(createJob({id:jobId,action:"FS",payload:{method:"unlink",args:[path]}})),FS=(method,args,jobId)=>startJob(createJob({id:jobId,action:"FS",payload:{method,args}})),loadLanguageInternal=(_langs,jobId)=>startJob(createJob({id:jobId,action:"loadLanguage",payload:{langs:_langs,options:{langPath:options.langPath,dataPath:options.dataPath,cachePath:options.cachePath,cacheMethod:options.cacheMethod,gzip:options.gzip,lstmOnly:[OEM.DEFAULT,OEM.LSTM_ONLY].includes(currentOem)&&!options.legacyLang}}})),initializeInternal=(_langs,_oem,_config,jobId)=>startJob(createJob({id:jobId,action:"initialize",payload:{langs:_langs,oem:_oem,config:_config}})),reinitialize=(langs="eng",oem,config,jobId)=>{if(lstmOnlyCore&&[OEM.TESSERACT_ONLY,OEM.TESSERACT_LSTM_COMBINED].includes(oem))throw Error("Legacy model requested but code missing.");let _oem=oem||currentOem;currentOem=_oem;let _config=config||currentConfig;currentConfig=_config;let langsArr="string"==typeof langs?langs.split("+"):langs,_langs=langsArr.filter(x=>!currentLangs.includes(x));return(currentLangs.push(..._langs),_langs.length>0)?loadLanguageInternal(_langs,jobId).then(()=>initializeInternal(langs,_oem,_config,jobId)):initializeInternal(langs,_oem,_config,jobId)},setParameters=(params={},jobId)=>startJob(createJob({id:jobId,action:"setParameters",payload:{params}})),recognize=async(image,opts={},output={text:!0},jobId)=>startJob(createJob({id:jobId,action:"recognize",payload:{image:await loadImage(image),options:opts,output}})),detect=async(image,jobId)=>{if(lstmOnlyCore)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return startJob(createJob({id:jobId,action:"detect",payload:{image:await loadImage(image)}}))},terminate=async()=>(null!==worker1&&(terminateWorker(worker1),worker1=null),Promise.resolve());onMessage(worker1,({workerId,jobId,status,action,data})=>{let promiseId=`${action}-${jobId}`;if("resolve"===status)log(`[${workerId}]: Complete ${jobId}`),promises[promiseId].resolve({jobId,data}),delete promises[promiseId];else if("reject"===status){if(promises[promiseId].reject(data),delete promises[promiseId],"load"===action&&workerResReject(data),errorHandler)errorHandler(data);else throw Error(data)}else"progress"===status&&logger({...data,userJobId:jobId})});let resolveObj={id,worker:worker1,load,writeText,readText,removeFile,FS,reinitialize,setParameters,recognize,detect,terminate};return loadInternal().then(()=>loadLanguageInternal(langs)).then(()=>initializeInternal(langs,oem,config)).then(()=>workerResResolve(resolveObj)).catch(()=>{}),workerRes}},7320:function(module,__unused_webpack_exports,__webpack_require__){__webpack_require__(9375);let createScheduler=__webpack_require__(7877),createWorker=__webpack_require__(1158),Tesseract=__webpack_require__(181),languages=__webpack_require__(9520),OEM=__webpack_require__(6308),PSM=__webpack_require__(7895),{setLogging}=__webpack_require__(3486);module.exports={languages,OEM,PSM,createScheduler,createWorker,setLogging,...Tesseract}},6376:function(module,__unused_webpack_exports,__webpack_require__){var process=__webpack_require__(3454);module.exports=key=>{let env={};return("undefined"!=typeof WorkerGlobalScope?env.type="webworker":"object"==typeof document?env.type="browser":"object"==typeof process&&(env.type="node"),void 0===key)?env:env[key]}},5504:function(module){module.exports=(prefix,cnt)=>`${prefix}-${cnt}-${Math.random().toString(16).slice(3,8)}`},3486:function(__unused_webpack_module,exports){let logging=!1;exports.logging=logging,exports.setLogging=_logging=>{logging=_logging},exports.log=(...args)=>logging?console.log.apply(this,args):null},1937:function(module,__unused_webpack_exports,__webpack_require__){let isBrowser="browser"===__webpack_require__(6376)("type"),resolveURL=isBrowser?s=>new URL(s,window.location.href).href:s=>s;module.exports=options=>{let opts={...options};return["corePath","workerPath","langPath"].forEach(key=>{options[key]&&(opts[key]=resolveURL(opts[key]))}),opts}},4040:function(module,__unused_webpack_exports,__webpack_require__){let version=__webpack_require__(4547).i8,defaultOptions=__webpack_require__(8720);module.exports={...defaultOptions,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${version}/dist/worker.min.js`}},3791:function(module,__unused_webpack_exports,__webpack_require__){let defaultOptions=__webpack_require__(4040),spawnWorker=__webpack_require__(1005),terminateWorker=__webpack_require__(25),onMessage=__webpack_require__(9804),send=__webpack_require__(7247),loadImage=__webpack_require__(1196);module.exports={defaultOptions,spawnWorker,terminateWorker,onMessage,send,loadImage}},1196:function(module){let readFromBlobOrFile=blob=>new Promise((resolve,reject)=>{let fileReader=new FileReader;fileReader.onload=()=>{resolve(fileReader.result)},fileReader.onerror=({target:{error:{code}}})=>{reject(Error(`File could not be read! Code=${code}`))},fileReader.readAsArrayBuffer(blob)}),loadImage=async image=>{let data=image;if(void 0===image)return"undefined";if("string"==typeof image){if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(image))data=atob(image.split(",")[1]).split("").map(c=>c.charCodeAt(0));else{let resp=await fetch(image);data=await resp.arrayBuffer()}}else if("undefined"!=typeof HTMLElement&&image instanceof HTMLElement)"IMG"===image.tagName&&(data=await loadImage(image.src)),"VIDEO"===image.tagName&&(data=await loadImage(image.poster)),"CANVAS"===image.tagName&&await new Promise(resolve=>{image.toBlob(async blob=>{data=await readFromBlobOrFile(blob),resolve()})});else if("undefined"!=typeof OffscreenCanvas&&image instanceof OffscreenCanvas){let blob=await image.convertToBlob();data=await readFromBlobOrFile(blob)}else(image instanceof File||image instanceof Blob)&&(data=await readFromBlobOrFile(image));return new Uint8Array(data)};module.exports=loadImage},9804:function(module){module.exports=(worker1,handler)=>{worker1.onmessage=({data})=>{handler(data)}}},7247:function(module){module.exports=async(worker1,packet)=>{worker1.postMessage(packet)}},1005:function(module){module.exports=({workerPath,workerBlobURL})=>{let worker1;if(Blob&&URL&&workerBlobURL){let blob=new Blob([`importScripts("${workerPath}");`],{type:"application/javascript"});worker1=new Worker(URL.createObjectURL(blob))}else worker1=new Worker(workerPath);return worker1}},25:function(module){module.exports=worker1=>{worker1.terminate()}},8005:function(module){"use strict";module.exports=twoProduct;var SPLITTER=134217729;function twoProduct(a,b,result){var x=a*b,c=SPLITTER*a,abig=c-a,ahi=c-abig,alo=a-ahi,d=SPLITTER*b,bbig=d-b,bhi=d-bbig,blo=b-bhi,err3=x-ahi*bhi-alo*bhi-ahi*blo,y=alo*blo-err3;return result?(result[0]=y,result[1]=x,result):[y,x]}},6359:function(module){"use strict";function fastTwoSum(a,b,result){var x=a+b,bv=x-a,av=x-bv,br=b-bv,ar=a-av;return result?(result[0]=ar+br,result[1]=x,result):[ar+br,x]}module.exports=fastTwoSum},6732:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var workerTemplate=__webpack_require__(7963),CORES=navigator.hardwareConcurrency||1;function WorkerManager(func,options){if("string"!=typeof func&&"function"!=typeof func)throw TypeError("func argument must be a function");if(void 0===options&&(options={}),"object"!=typeof options||null===options)throw TypeError("options argument must be an object");this._workerCode=func.toString(),void 0===options.maxWorkers||"auto"===options.maxWorkers?this._numWorkers=Math.min(CORES-1,1):options.maxWorkers>0?this._numWorkers=Math.min(options.maxWorkers,CORES):this._numWorkers=CORES,this._workers=new Map,this._timeout=options.timeout||0,this._terminateOnError=!!options.terminateOnError;var deps=options.deps;"string"==typeof deps&&(deps=[deps]),Array.isArray(deps)||(deps=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(deps)}WorkerManager.prototype._init=function(deps){for(var workerURL=workerTemplate.newWorkerURL(this._workerCode,deps),i=0;i<this._numWorkers;i++){var worker1=new Worker(workerURL);worker1.onmessage=this._onmessage.bind(this,worker1),worker1.onerror=this._onerror.bind(this,worker1),worker1.running=!1,worker1.id=i,this._workers.set(worker1,null)}URL.revokeObjectURL(workerURL)},WorkerManager.prototype._onerror=function(worker1,error){if(!this._terminated){this._working--,worker1.running=!1;var callback=this._workers.get(worker1);callback&&callback[1](error.message),this._workers.set(worker1,null),this._terminateOnError?this.terminate():this._exec()}},WorkerManager.prototype._onmessage=function(worker1,event){if(!this._terminated){this._working--,worker1.running=!1;var callback=this._workers.get(worker1);callback&&callback[0](event.data.data),this._workers.set(worker1,null),this._exec()}},WorkerManager.prototype._exec=function(){for(var worker1 of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!worker1.running)for(var i=0;i<this._waiting.length;i++){var execInfo=this._waiting[i];if("number"!=typeof execInfo[4]||execInfo[4]===worker1.id){this._waiting.splice(i,1),worker1.postMessage({action:"exec",event:execInfo[0],args:execInfo[1]},execInfo[2]),worker1.running=!0,worker1.time=Date.now(),this._workers.set(worker1,execInfo[3]),this._working++;break}}}},WorkerManager.prototype.terminate=function(){if(!this._terminated){for(var entry of this._workers)entry[0].terminate(),entry[1]&&entry[1][1](Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},WorkerManager.prototype.postAll=function(event,args){if(this._terminated)throw Error("Cannot post (terminated)");var promises=[];for(var worker1 of this._workers.keys())promises.push(this.post(event,args,[],worker1.id));return Promise.all(promises)},WorkerManager.prototype.post=function(event,args,transferable,id){void 0===args&&(args=[]),void 0===transferable&&(transferable=[]),Array.isArray(args)||(args=[args]),Array.isArray(transferable)||(transferable=[transferable]);var self1=this;return new Promise(function(resolve,reject){if(self1._terminated)throw Error("Cannot post (terminated)");self1._waiting.push([event,args,transferable,[resolve,reject],id]),self1._exec()})},module.exports=WorkerManager},7963:function(__unused_webpack_module,exports){"use strict";var workerStr=(function(){function ManagedWorker(){this._listeners={}}self.window=self,ManagedWorker.prototype.on=function(event,callback){if(this._listeners[event])throw RangeError("there is already a listener for "+event);if("function"!=typeof callback)throw TypeError("callback argument must be a function");this._listeners[event]=callback},ManagedWorker.prototype._send=function(id,data,transferable){void 0===transferable?transferable=[]:Array.isArray(transferable)||(transferable=[transferable]),self.postMessage({id:id,data:data},transferable)},ManagedWorker.prototype._trigger=function(event,args){if(!this._listeners[event])throw Error("event "+event+" is not defined");this._listeners[event].apply(null,args)};var worker1=new ManagedWorker;self.onmessage=function(event){switch(event.data.action){case"exec":event.data.args.unshift(function(data,transferable){worker1._send(event.data.id,data,transferable)}),worker1._trigger(event.data.event,event.data.args);break;case"ping":worker1._send(event.data.id,"pong");break;default:throw Error("unexpected action: "+event.data.action)}}}).toString().split('"CODE";');exports.newWorkerURL=function(code,deps){var blob=new Blob(["(",workerStr[0],"importScripts.apply(self, "+JSON.stringify(deps)+");\n","(",code,")();",workerStr[1],")();"],{type:"application/javascript"});return URL.createObjectURL(blob)}},2002:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{uI:function(){return useDropzone}});var react=__webpack_require__(7294),prop_types=__webpack_require__(5697),extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}var ownKeys=function(o){return(ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)Object.prototype.hasOwnProperty.call(o,k)&&(ar[ar.length]=k);return ar})(o)};"function"==typeof SuppressedError&&SuppressedError;let COMMON_MIME_TYPES=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function toFileWithPath(file,path,h){let f=withMimeType(file),{webkitRelativePath}=file,p="string"==typeof path?path:"string"==typeof webkitRelativePath&&webkitRelativePath.length>0?webkitRelativePath:`./${file.name}`;return"string"!=typeof f.path&&setObjProp(f,"path",p),void 0!==h&&Object.defineProperty(f,"handle",{value:h,writable:!1,configurable:!1,enumerable:!0}),setObjProp(f,"relativePath",p),f}function withMimeType(file){let{name}=file,hasExtension=name&&-1!==name.lastIndexOf(".");if(hasExtension&&!file.type){let ext=name.split(".").pop().toLowerCase(),type=COMMON_MIME_TYPES.get(ext);type&&Object.defineProperty(file,"type",{value:type,writable:!1,configurable:!1,enumerable:!0})}return file}function setObjProp(f,key,value){Object.defineProperty(f,key,{value,writable:!1,configurable:!1,enumerable:!0})}let FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(evt){return __awaiter(this,void 0,void 0,function*(){return isObject(evt)&&isDataTransfer(evt.dataTransfer)?getDataTransferFiles(evt.dataTransfer,evt.type):isChangeEvt(evt)?getInputFiles(evt):Array.isArray(evt)&&evt.every(item=>"getFile"in item&&"function"==typeof item.getFile)?getFsHandleFiles(evt):[]})}function isDataTransfer(value){return isObject(value)}function isChangeEvt(value){return isObject(value)&&isObject(value.target)}function isObject(v){return"object"==typeof v&&null!==v}function getInputFiles(evt){return fromList(evt.target.files).map(file=>toFileWithPath(file))}function getFsHandleFiles(handles){return __awaiter(this,void 0,void 0,function*(){let files=yield Promise.all(handles.map(h=>h.getFile()));return files.map(file=>toFileWithPath(file))})}function getDataTransferFiles(dt,type){return __awaiter(this,void 0,void 0,function*(){if(dt.items){let items=fromList(dt.items).filter(item=>"file"===item.kind);if("drop"!==type)return items;let files=yield Promise.all(items.map(toFilePromises));return noIgnoredFiles(flatten(files))}return noIgnoredFiles(fromList(dt.files).map(file=>toFileWithPath(file)))})}function noIgnoredFiles(files){return files.filter(file=>-1===FILES_TO_IGNORE.indexOf(file.name))}function fromList(items){if(null===items)return[];let files=[];for(let i=0;i<items.length;i++){let file=items[i];files.push(file)}return files}function toFilePromises(item){if("function"!=typeof item.webkitGetAsEntry)return fromDataTransferItem(item);let entry=item.webkitGetAsEntry();return entry&&entry.isDirectory?fromDirEntry(entry):fromDataTransferItem(item,entry)}function flatten(items){return items.reduce((acc,files)=>[...acc,...Array.isArray(files)?flatten(files):[files]],[])}function fromDataTransferItem(item,entry){return __awaiter(this,void 0,void 0,function*(){var _a;if(globalThis.isSecureContext&&"function"==typeof item.getAsFileSystemHandle){let h=yield item.getAsFileSystemHandle();if(null===h)throw Error(`${item} is not a File`);if(void 0!==h){let file=yield h.getFile();return file.handle=h,toFileWithPath(file)}}let file1=item.getAsFile();if(!file1)throw Error(`${item} is not a File`);let fwp=toFileWithPath(file1,null!==(_a=null==entry?void 0:entry.fullPath)&&void 0!==_a?_a:void 0);return fwp})}function fromEntry(entry){return __awaiter(this,void 0,void 0,function*(){return entry.isDirectory?fromDirEntry(entry):fromFileEntry(entry)})}function fromDirEntry(entry){let reader=entry.createReader();return new Promise((resolve,reject)=>{let entries=[];function readEntries(){reader.readEntries(batch=>__awaiter(this,void 0,void 0,function*(){if(batch.length){let items=Promise.all(batch.map(fromEntry));entries.push(items),readEntries()}else try{let files=yield Promise.all(entries);resolve(files)}catch(err){reject(err)}}),err=>{reject(err)})}readEntries()})}function fromFileEntry(entry){return __awaiter(this,void 0,void 0,function*(){return new Promise((resolve,reject)=>{entry.file(file=>{let fwp=toFileWithPath(file,entry.fullPath);resolve(fwp)},err=>{reject(err)})})})}var es=__webpack_require__(8363);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?utils_ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):utils_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){var _s,_e,_i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var accepts="function"==typeof es?es:es.default,FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",getInvalidTypeRejectionErr=function(){var accept=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",acceptArr=accept.split(","),msg=acceptArr.length>1?"one of ".concat(acceptArr.join(", ")):acceptArr[0];return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(msg)}},getTooLargeRejectionErr=function(maxSize){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(maxSize," ").concat(1===maxSize?"byte":"bytes")}},getTooSmallRejectionErr=function(minSize){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(minSize," ").concat(1===minSize?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:"too-many-files",message:"Too many files"};function fileAccepted(file,accept){var isAcceptable="application/x-moz-file"===file.type||accepts(file,accept);return[isAcceptable,isAcceptable?null:getInvalidTypeRejectionErr(accept)]}function fileMatchSize(file,minSize,maxSize){if(isDefined(file.size)){if(isDefined(minSize)&&isDefined(maxSize)){if(file.size>maxSize)return[!1,getTooLargeRejectionErr(maxSize)];if(file.size<minSize)return[!1,getTooSmallRejectionErr(minSize)]}else if(isDefined(minSize)&&file.size<minSize)return[!1,getTooSmallRejectionErr(minSize)];else if(isDefined(maxSize)&&file.size>maxSize)return[!1,getTooLargeRejectionErr(maxSize)]}return[!0,null]}function isDefined(value){return null!=value}function allFilesAccepted(_ref){var files=_ref.files,accept=_ref.accept,minSize=_ref.minSize,maxSize=_ref.maxSize,multiple=_ref.multiple,maxFiles=_ref.maxFiles,validator=_ref.validator;return(!!multiple||!(files.length>1))&&(!multiple||!(maxFiles>=1)||!(files.length>maxFiles))&&files.every(function(file){var accepted=_slicedToArray(fileAccepted(file,accept),1)[0],sizeMatch=_slicedToArray(fileMatchSize(file,minSize,maxSize),1)[0],customErrors=validator?validator(file):null;return accepted&&sizeMatch&&!customErrors})}function isPropagationStopped(event){return"function"==typeof event.isPropagationStopped?event.isPropagationStopped():void 0!==event.cancelBubble&&event.cancelBubble}function isEvtWithFiles(event){return event.dataTransfer?Array.prototype.some.call(event.dataTransfer.types,function(type){return"Files"===type||"application/x-moz-file"===type}):!!event.target&&!!event.target.files}function onDocumentDragOver(event){event.preventDefault()}function isIe(userAgent){return -1!==userAgent.indexOf("MSIE")||-1!==userAgent.indexOf("Trident/")}function isEdge(userAgent){return -1!==userAgent.indexOf("Edge/")}function isIeOrEdge(){var userAgent=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return isIe(userAgent)||isEdge(userAgent)}function composeEventHandlers(){for(var _len=arguments.length,fns=Array(_len),_key=0;_key<_len;_key++)fns[_key]=arguments[_key];return function(event){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];return fns.some(function(fn){return!isPropagationStopped(event)&&fn&&fn.apply(void 0,[event].concat(args)),isPropagationStopped(event)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function pickerOptionsFromAccept(accept){return isDefined(accept)?[{description:"Files",accept:Object.entries(accept).filter(function(_ref2){var _ref3=_slicedToArray(_ref2,2),mimeType=_ref3[0],ext=_ref3[1],ok=!0;return isMIMEType(mimeType)||(console.warn('Skipped "'.concat(mimeType,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),ok=!1),Array.isArray(ext)&&ext.every(isExt)||(console.warn('Skipped "'.concat(mimeType,'" because an invalid file extension was provided.')),ok=!1),ok}).reduce(function(agg,_ref4){var _ref5=_slicedToArray(_ref4,2),mimeType=_ref5[0],ext=_ref5[1];return _objectSpread(_objectSpread({},agg),{},_defineProperty({},mimeType,ext))},{})}]:accept}function acceptPropAsAcceptAttr(accept){if(isDefined(accept))return Object.entries(accept).reduce(function(a,_ref6){var _ref7=_slicedToArray(_ref6,2),mimeType=_ref7[0],ext=_ref7[1];return[].concat(_toConsumableArray(a),[mimeType],_toConsumableArray(ext))},[]).filter(function(v){return isMIMEType(v)||isExt(v)}).join(",")}function isAbort(v){return v instanceof DOMException&&("AbortError"===v.name||v.code===v.ABORT_ERR)}function isSecurityError(v){return v instanceof DOMException&&("SecurityError"===v.name||v.code===v.SECURITY_ERR)}function isMIMEType(v){return"audio/*"===v||"video/*"===v||"image/*"===v||"text/*"===v||"application/*"===v||/\w+\/[-+.\w]+/g.test(v)}function isExt(v){return/^.*\.[\w]+$/.test(v)}var _excluded=["children"],_excluded2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function es_toConsumableArray(arr){return es_arrayWithoutHoles(arr)||es_iterableToArray(arr)||es_unsupportedIterableToArray(arr)||es_nonIterableSpread()}function es_nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function es_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function es_arrayWithoutHoles(arr){if(Array.isArray(arr))return es_arrayLikeToArray(arr)}function es_slicedToArray(arr,i){return es_arrayWithHoles(arr)||es_iterableToArrayLimit(arr,i)||es_unsupportedIterableToArray(arr,i)||es_nonIterableRest()}function es_nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function es_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return es_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return es_arrayLikeToArray(o,minLen)}}function es_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function es_iterableToArrayLimit(arr,i){var _s,_e,_i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function es_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function es_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function es_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?es_ownKeys(Object(source),!0).forEach(function(key){es_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):es_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function es_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=_objectWithoutPropertiesLoose(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],!(excluded.indexOf(key)>=0)&&Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}var Dropzone=(0,react.forwardRef)(function(_ref,ref){var children=_ref.children,_useDropzone=useDropzone(_objectWithoutProperties(_ref,_excluded)),open=_useDropzone.open,props=_objectWithoutProperties(_useDropzone,_excluded2);return(0,react.useImperativeHandle)(ref,function(){return{open:open}},[open]),react.createElement(react.Fragment,null,children(es_objectSpread(es_objectSpread({},props),{},{open:open})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Dropzone.defaultProps=defaultProps,Dropzone.propTypes={children:prop_types.func,accept:prop_types.objectOf(prop_types.arrayOf(prop_types.string)),multiple:prop_types.bool,preventDropOnDocument:prop_types.bool,noClick:prop_types.bool,noKeyboard:prop_types.bool,noDrag:prop_types.bool,noDragEventsBubbling:prop_types.bool,minSize:prop_types.number,maxSize:prop_types.number,maxFiles:prop_types.number,disabled:prop_types.bool,getFilesFromEvent:prop_types.func,onFileDialogCancel:prop_types.func,onFileDialogOpen:prop_types.func,useFsAccessApi:prop_types.bool,autoFocus:prop_types.bool,onDragEnter:prop_types.func,onDragLeave:prop_types.func,onDragOver:prop_types.func,onDrop:prop_types.func,onDropAccepted:prop_types.func,onDropRejected:prop_types.func,onError:prop_types.func,validator:prop_types.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function useDropzone(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_defaultProps$props=es_objectSpread(es_objectSpread({},defaultProps),props),accept=_defaultProps$props.accept,disabled=_defaultProps$props.disabled,getFilesFromEvent=_defaultProps$props.getFilesFromEvent,maxSize=_defaultProps$props.maxSize,minSize=_defaultProps$props.minSize,multiple=_defaultProps$props.multiple,maxFiles=_defaultProps$props.maxFiles,onDragEnter=_defaultProps$props.onDragEnter,onDragLeave=_defaultProps$props.onDragLeave,onDragOver=_defaultProps$props.onDragOver,onDrop=_defaultProps$props.onDrop,onDropAccepted=_defaultProps$props.onDropAccepted,onDropRejected=_defaultProps$props.onDropRejected,onFileDialogCancel=_defaultProps$props.onFileDialogCancel,onFileDialogOpen=_defaultProps$props.onFileDialogOpen,useFsAccessApi=_defaultProps$props.useFsAccessApi,autoFocus=_defaultProps$props.autoFocus,preventDropOnDocument=_defaultProps$props.preventDropOnDocument,noClick=_defaultProps$props.noClick,noKeyboard=_defaultProps$props.noKeyboard,noDrag=_defaultProps$props.noDrag,noDragEventsBubbling=_defaultProps$props.noDragEventsBubbling,onError=_defaultProps$props.onError,validator=_defaultProps$props.validator,acceptAttr=(0,react.useMemo)(function(){return acceptPropAsAcceptAttr(accept)},[accept]),pickerTypes=(0,react.useMemo)(function(){return pickerOptionsFromAccept(accept)},[accept]),onFileDialogOpenCb=(0,react.useMemo)(function(){return"function"==typeof onFileDialogOpen?onFileDialogOpen:noop},[onFileDialogOpen]),onFileDialogCancelCb=(0,react.useMemo)(function(){return"function"==typeof onFileDialogCancel?onFileDialogCancel:noop},[onFileDialogCancel]),rootRef=(0,react.useRef)(null),inputRef=(0,react.useRef)(null),_useReducer2=es_slicedToArray((0,react.useReducer)(reducer,initialState),2),state=_useReducer2[0],dispatch=_useReducer2[1],isFocused=state.isFocused,isFileDialogActive=state.isFileDialogActive,fsAccessApiWorksRef=(0,react.useRef)("undefined"!=typeof window&&window.isSecureContext&&useFsAccessApi&&canUseFileSystemAccessAPI()),onWindowFocus=function(){!fsAccessApiWorksRef.current&&isFileDialogActive&&setTimeout(function(){inputRef.current&&!inputRef.current.files.length&&(dispatch({type:"closeDialog"}),onFileDialogCancelCb())},300)};(0,react.useEffect)(function(){return window.addEventListener("focus",onWindowFocus,!1),function(){window.removeEventListener("focus",onWindowFocus,!1)}},[inputRef,isFileDialogActive,onFileDialogCancelCb,fsAccessApiWorksRef]);var dragTargetsRef=(0,react.useRef)([]),onDocumentDrop=function(event){rootRef.current&&rootRef.current.contains(event.target)||(event.preventDefault(),dragTargetsRef.current=[])};(0,react.useEffect)(function(){return preventDropOnDocument&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",onDocumentDrop,!1)),function(){preventDropOnDocument&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",onDocumentDrop))}},[rootRef,preventDropOnDocument]),(0,react.useEffect)(function(){return!disabled&&autoFocus&&rootRef.current&&rootRef.current.focus(),function(){}},[rootRef,autoFocus,disabled]);var onErrCb=(0,react.useCallback)(function(e){onError?onError(e):console.error(e)},[onError]),onDragEnterCb=(0,react.useCallback)(function(event){event.preventDefault(),event.persist(),stopPropagation(event),dragTargetsRef.current=[].concat(es_toConsumableArray(dragTargetsRef.current),[event.target]),isEvtWithFiles(event)&&Promise.resolve(getFilesFromEvent(event)).then(function(files){if(!isPropagationStopped(event)||noDragEventsBubbling){var fileCount=files.length,isDragAccept=fileCount>0&&allFilesAccepted({files:files,accept:acceptAttr,minSize:minSize,maxSize:maxSize,multiple:multiple,maxFiles:maxFiles,validator:validator}),isDragReject=fileCount>0&&!isDragAccept;dispatch({isDragAccept:isDragAccept,isDragReject:isDragReject,isDragActive:!0,type:"setDraggedFiles"}),onDragEnter&&onDragEnter(event)}}).catch(function(e){return onErrCb(e)})},[getFilesFromEvent,onDragEnter,onErrCb,noDragEventsBubbling,acceptAttr,minSize,maxSize,multiple,maxFiles,validator]),onDragOverCb=(0,react.useCallback)(function(event){event.preventDefault(),event.persist(),stopPropagation(event);var hasFiles=isEvtWithFiles(event);if(hasFiles&&event.dataTransfer)try{event.dataTransfer.dropEffect="copy"}catch(_unused){}return hasFiles&&onDragOver&&onDragOver(event),!1},[onDragOver,noDragEventsBubbling]),onDragLeaveCb=(0,react.useCallback)(function(event){event.preventDefault(),event.persist(),stopPropagation(event);var targets=dragTargetsRef.current.filter(function(target){return rootRef.current&&rootRef.current.contains(target)}),targetIdx=targets.indexOf(event.target);-1!==targetIdx&&targets.splice(targetIdx,1),dragTargetsRef.current=targets,!(targets.length>0)&&(dispatch({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),isEvtWithFiles(event)&&onDragLeave&&onDragLeave(event))},[rootRef,onDragLeave,noDragEventsBubbling]),setFiles=(0,react.useCallback)(function(files,event){var acceptedFiles=[],fileRejections=[];files.forEach(function(file){var _fileAccepted2=es_slicedToArray(fileAccepted(file,acceptAttr),2),accepted=_fileAccepted2[0],acceptError=_fileAccepted2[1],_fileMatchSize2=es_slicedToArray(fileMatchSize(file,minSize,maxSize),2),sizeMatch=_fileMatchSize2[0],sizeError=_fileMatchSize2[1],customErrors=validator?validator(file):null;if(accepted&&sizeMatch&&!customErrors)acceptedFiles.push(file);else{var errors=[acceptError,sizeError];customErrors&&(errors=errors.concat(customErrors)),fileRejections.push({file:file,errors:errors.filter(function(e){return e})})}}),(!multiple&&acceptedFiles.length>1||multiple&&maxFiles>=1&&acceptedFiles.length>maxFiles)&&(acceptedFiles.forEach(function(file){fileRejections.push({file:file,errors:[TOO_MANY_FILES_REJECTION]})}),acceptedFiles.splice(0)),dispatch({acceptedFiles:acceptedFiles,fileRejections:fileRejections,isDragReject:fileRejections.length>0,type:"setFiles"}),onDrop&&onDrop(acceptedFiles,fileRejections,event),fileRejections.length>0&&onDropRejected&&onDropRejected(fileRejections,event),acceptedFiles.length>0&&onDropAccepted&&onDropAccepted(acceptedFiles,event)},[dispatch,multiple,acceptAttr,minSize,maxSize,maxFiles,onDrop,onDropAccepted,onDropRejected,validator]),onDropCb=(0,react.useCallback)(function(event){event.preventDefault(),event.persist(),stopPropagation(event),dragTargetsRef.current=[],isEvtWithFiles(event)&&Promise.resolve(getFilesFromEvent(event)).then(function(files){(!isPropagationStopped(event)||noDragEventsBubbling)&&setFiles(files,event)}).catch(function(e){return onErrCb(e)}),dispatch({type:"reset"})},[getFilesFromEvent,setFiles,onErrCb,noDragEventsBubbling]),openFileDialog=(0,react.useCallback)(function(){if(fsAccessApiWorksRef.current){dispatch({type:"openDialog"}),onFileDialogOpenCb();var opts={multiple:multiple,types:pickerTypes};window.showOpenFilePicker(opts).then(function(handles){return getFilesFromEvent(handles)}).then(function(files){setFiles(files,null),dispatch({type:"closeDialog"})}).catch(function(e){isAbort(e)?(onFileDialogCancelCb(e),dispatch({type:"closeDialog"})):isSecurityError(e)?(fsAccessApiWorksRef.current=!1,inputRef.current?(inputRef.current.value=null,inputRef.current.click()):onErrCb(Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):onErrCb(e)});return}inputRef.current&&(dispatch({type:"openDialog"}),onFileDialogOpenCb(),inputRef.current.value=null,inputRef.current.click())},[dispatch,onFileDialogOpenCb,onFileDialogCancelCb,useFsAccessApi,setFiles,onErrCb,pickerTypes,multiple]),onKeyDownCb=(0,react.useCallback)(function(event){rootRef.current&&rootRef.current.isEqualNode(event.target)&&(" "===event.key||"Enter"===event.key||32===event.keyCode||13===event.keyCode)&&(event.preventDefault(),openFileDialog())},[rootRef,openFileDialog]),onFocusCb=(0,react.useCallback)(function(){dispatch({type:"focus"})},[]),onBlurCb=(0,react.useCallback)(function(){dispatch({type:"blur"})},[]),onClickCb=(0,react.useCallback)(function(){noClick||(isIeOrEdge()?setTimeout(openFileDialog,0):openFileDialog())},[noClick,openFileDialog]),composeHandler=function(fn){return disabled?null:fn},composeKeyboardHandler=function(fn){return noKeyboard?null:composeHandler(fn)},composeDragHandler=function(fn){return noDrag?null:composeHandler(fn)},stopPropagation=function(event){noDragEventsBubbling&&event.stopPropagation()},getRootProps=(0,react.useMemo)(function(){return function(){var _ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref2$refKey=_ref2.refKey,refKey=void 0===_ref2$refKey?"ref":_ref2$refKey,role=_ref2.role,onKeyDown=_ref2.onKeyDown,onFocus=_ref2.onFocus,onBlur=_ref2.onBlur,onClick=_ref2.onClick,onDragEnter=_ref2.onDragEnter,onDragOver=_ref2.onDragOver,onDragLeave=_ref2.onDragLeave,onDrop=_ref2.onDrop,rest=_objectWithoutProperties(_ref2,_excluded3);return es_objectSpread(es_objectSpread(es_defineProperty({onKeyDown:composeKeyboardHandler(composeEventHandlers(onKeyDown,onKeyDownCb)),onFocus:composeKeyboardHandler(composeEventHandlers(onFocus,onFocusCb)),onBlur:composeKeyboardHandler(composeEventHandlers(onBlur,onBlurCb)),onClick:composeHandler(composeEventHandlers(onClick,onClickCb)),onDragEnter:composeDragHandler(composeEventHandlers(onDragEnter,onDragEnterCb)),onDragOver:composeDragHandler(composeEventHandlers(onDragOver,onDragOverCb)),onDragLeave:composeDragHandler(composeEventHandlers(onDragLeave,onDragLeaveCb)),onDrop:composeDragHandler(composeEventHandlers(onDrop,onDropCb)),role:"string"==typeof role&&""!==role?role:"presentation"},refKey,rootRef),disabled||noKeyboard?{}:{tabIndex:0}),rest)}},[rootRef,onKeyDownCb,onFocusCb,onBlurCb,onClickCb,onDragEnterCb,onDragOverCb,onDragLeaveCb,onDropCb,noKeyboard,noDrag,disabled]),onInputElementClick=(0,react.useCallback)(function(event){event.stopPropagation()},[]),getInputProps=(0,react.useMemo)(function(){return function(){var _ref3=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref3$refKey=_ref3.refKey,refKey=void 0===_ref3$refKey?"ref":_ref3$refKey,onChange=_ref3.onChange,onClick=_ref3.onClick,rest=_objectWithoutProperties(_ref3,_excluded4);return es_objectSpread(es_objectSpread({},es_defineProperty({accept:acceptAttr,multiple:multiple,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:composeHandler(composeEventHandlers(onChange,onDropCb)),onClick:composeHandler(composeEventHandlers(onClick,onInputElementClick)),tabIndex:-1},refKey,inputRef)),rest)}},[inputRef,accept,multiple,onDropCb,disabled]);return es_objectSpread(es_objectSpread({},state),{},{isFocused:isFocused&&!disabled,getRootProps:getRootProps,getInputProps:getInputProps,rootRef:rootRef,inputRef:inputRef,open:composeHandler(openFileDialog)})}function reducer(state,action){switch(action.type){case"focus":return es_objectSpread(es_objectSpread({},state),{},{isFocused:!0});case"blur":return es_objectSpread(es_objectSpread({},state),{},{isFocused:!1});case"openDialog":return es_objectSpread(es_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return es_objectSpread(es_objectSpread({},state),{},{isFileDialogActive:!1});case"setDraggedFiles":return es_objectSpread(es_objectSpread({},state),{},{isDragActive:action.isDragActive,isDragAccept:action.isDragAccept,isDragReject:action.isDragReject});case"setFiles":return es_objectSpread(es_objectSpread({},state),{},{acceptedFiles:action.acceptedFiles,fileRejections:action.fileRejections,isDragReject:action.isDragReject});case"reset":return es_objectSpread({},initialState);default:return state}}function noop(){}},2898:function(module){"use strict";module.exports={version:"1.0.1"}},4547:function(module){"use strict";module.exports={i8:"6.0.0"}}}]);